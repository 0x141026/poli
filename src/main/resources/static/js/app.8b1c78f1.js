(function(t){function e(e){for(var i,r,o=e[0],l=e[1],c=e[2],u=0,h=[];u<o.length;u++)r=o[u],n[r]&&h.push(n[r][0]),n[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);d&&d(e);while(h.length)h.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],i=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(i=!1)}i&&(s.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},n={app:0},s=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var i=a("c21b"),n=a.n(i);n.a},"0743":function(t,e,a){"use strict";var i=a("4e32"),n=a.n(i);n.a},"16cb":function(t,e,a){"use strict";var i=a("8c45"),n=a.n(i);n.a},"1f68":function(t,e,a){},"21d7":function(t,e,a){"use strict";var i=a("c639"),n=a.n(i);n.a},2855:function(t,e,a){},"3ed5":function(t,e,a){"use strict";var i=a("94e1"),n=a.n(i);n.a},"44d4":function(t,e,a){"use strict";var i=a("ea60"),n=a.n(i);n.a},"4dd8":function(t,e,a){"use strict";var i=a("b313"),n=a.n(i);n.a},"4e32":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("097d");var i=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"root-page",attrs:{id:"app"}},[a("div",{staticClass:"root-menu-bar"},[a("div",{staticClass:"site-name"},[t._v("Poli")]),a("ul",{staticClass:"root-menu"},[a("li",[a("router-link",{attrs:{to:"/dashboard"}},[a("i",{staticClass:"fas fa-desktop"}),a("span",{staticClass:"root-menu-text"},[t._v("Dashboard")])])],1),a("li",[a("router-link",{attrs:{to:"/index"}},[a("i",{staticClass:"fas fa-database"}),a("span",{staticClass:"root-menu-text"},[t._v("Index")])])],1),a("li",[a("router-link",{attrs:{to:"/system"}},[a("i",{staticClass:"fas fa-server"}),a("span",{staticClass:"root-menu-text"},[t._v("System")])])],1)])]),a("div",{staticClass:"root-content"},[a("router-view")],1)])},s=[],r={name:"App",data:function(){return{title:"Poli",username:""}},created:function(){},methods:{menuToggle:function(){}}},o=r,l=(a("034f"),a("2877")),c=Object(l["a"])(o,n,s,!1,null,null,null);c.options.__file="App.vue";var d=c.exports,u=a("8c4f"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"view-page"},[a("div",{staticClass:"view-content-full"},[a("div",{staticClass:"{ tab-name: tab === 'indices' }",on:{click:function(e){t.switchTab("indices")}}},[t._v("Indices")]),a("div",{staticClass:"{ tab-name: tab === 'cluster' }",on:{click:function(e){t.switchTab("cluster")}}},[t._v("Cluster")]),a("div",{staticClass:"{ tab-name: tab === 'node' }",on:{click:function(e){t.switchTab("node")}}},[t._v("Node")]),a("div",{staticStyle:{"border-top":"2px solid black"}},["cluster"===t.tab?a("div",[a("table",t._l(t.cluster,function(e,i){return a("tr",{key:i},[a("td",[t._v(t._s(i))]),a("td",[t._v(t._s(e))])])}))]):t._e(),"node"===t.tab?a("div",[a("table",[t._m(0),a("tbody",t._l(t.node,function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.ip))]),a("td",[t._v(t._s(e["heap.percent"]))]),a("td",[t._v(t._s(e["ram.percent"]))]),a("td",[t._v(t._s(e.cpu))]),a("td",[t._v(t._s(e.load_1m))]),a("td",[t._v(t._s(e.load_5m))]),a("td",[t._v(t._s(e.load_15m))]),a("td",[t._v(t._s(e["node.role"]))]),a("td",[t._v(t._s(e.master))])])}))])]):t._e(),"indices"===t.tab?a("div",[a("table",[t._m(1),a("tbody",t._l(t.indices,function(e){return a("tr",{key:e},[a("td",{staticClass:"bold"},[t._v(t._s(e.index))]),a("td",{style:t.healthStyle(e.health)}),a("td",[t._v(t._s(e.pri))]),a("td",[t._v(t._s(e.rep))]),a("td",[t._v(t._s(e.size))]),a("td",[t._v(t._s(e.status))]),a("td",[t._v(t._s(e.count))]),a("td",[t._v(t._s(e.deleted))])])}))])]):t._e()])])])},p=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("Name")]),a("th",[t._v("IP")]),a("th",[t._v("Heap %")]),a("th",[t._v("Ram %")]),a("th",[t._v("CPU %")]),a("th",[t._v("Load 1m")]),a("th",[t._v("Load 5m")]),a("th",[t._v("Load 15m")]),a("th",[t._v("Role")]),a("th",[t._v("Master")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("Index")]),a("th",[t._v("Health")]),a("th",[t._v("Pri")]),a("th",[t._v("Rep")]),a("th",[t._v("Size")]),a("th",[t._v("Status")]),a("th",[t._v("Count")]),a("th",[t._v("Deleted")])])])}],v=a("bc3a"),f=a.n(v),g={name:"System",data:function(){return{tab:"",cluster:{},node:{},indices:[]}},created:function(){this.switchTab("indices")},methods:{loadCluster:function(){var t=this;f.a.post("ws/es/query",{method:"get",url:"/_cluster/health"}).then(function(e){console.log(e.data),t.cluster=e.data})},loadNode:function(){var t=this;f.a.post("ws/es/query",{method:"get",url:"/_cat/nodes?format=json"}).then(function(e){console.log(e.data),t.node=e.data})},loadIndices:function(){var t=this,e={method:"get",url:"/_cat/indices?format=json"};f.a.post("ws/es/query",e).then(function(e){t.indices=[];for(var a=0;a<e.data.length;a++){var i=e.data[a],n={index:i.index,health:i.health,pri:i.pri,rep:i.rep,size:i["store.size"],status:i.status,count:i["docs.count"],deleted:i["docs.deleted"]};t.indices.push(n)}})},switchTab:function(t){"cluster"===t?this.loadCluster():"node"===t?this.loadNode():"indices"===t&&this.loadIndices(),this.tab=t},healthStyle:function(t){var e="#ffa500";return"green"===t?e="#28a748":"yellow"===t?e="#ffc108":"red"===t&&(e="#dc3547"),"background-color: ".concat(e,";")}}},m=g,b=(a("0743"),Object(l["a"])(m,h,p,!1,null,null,null));b.options.__file="System.vue";var y=b.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"view-page"},[a("div",{staticClass:"breadcrumb"},[t._v("\n    My Index\n  ")]),a("div",{staticClass:"view-content-full"},[a("div",{staticClass:"row"},t._l(t.myIndices,function(e){return a("div",{key:e.name,staticClass:"float-left",staticStyle:{"margin-top":"10px","margin-left":"10px",border:"2px solid #2196F3",padding:"10px"}},[a("div",[t._v(t._s(e.name))]),a("div",[t._v(t._s(e.pattern))]),a("div",[a("button",{staticClass:"button button1",on:{click:function(a){t.explore(e.id)}}},[a("i",{staticClass:"fas fa-glasses"})]),a("button",{staticClass:"button button1",on:{click:function(a){t.edit(e.id)}}},[a("i",{staticClass:"fas fa-edit"})]),a("button",{staticClass:"button button1",on:{click:function(a){t.remove(e.id)}}},[a("i",{staticClass:"fas fa-trash-alt"})])])])})),a("button",{staticClass:"button button1",on:{click:t.showAddDialog}},[a("i",{staticClass:"fas fa-plus"}),t._v(" Add\n    ")]),a("transition",{attrs:{name:"slide"}},[t.show?a("div",{attrs:{id:"add-index-panel"}},[a("div",[a("h2",[t._v("Add Index")]),a("button",{staticClass:"button button1",on:{click:function(e){t.addIndex()}}},[t._v("Add")]),a("h3",[t._v("Index Name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-input",attrs:{type:"text"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),a("h3",[t._v("Index Pattern")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pattern,expression:"pattern"}],ref:"pattern",staticClass:"form-input",attrs:{type:"text"},domProps:{value:t.pattern},on:{keyup:t.typePattern,keydown:t.typePattern,input:function(e){e.target.composing||(t.pattern=e.target.value)}}}),a("ul",t._l(t.indices,function(e){return a("li",{key:e},[t._v(t._s(e))])}))])]):t._e()])],1)])},x=[],C=(a("7f7f"),a("96cf"),a("3040")),w=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.a.get("ws/index");case 3:return e=t.sent,t.abrupt("return",e.data);case 7:return t.prev=7,t.t0=t["catch"](0),t.abrupt("return",null);case 10:case"end":return t.stop()}},t,this,[[0,7]])}));return function(){return t.apply(this,arguments)}}(),k=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a="ws/index/pattern/".concat(e),t.prev=1,t.next=4,f.a.get(a);case 4:return i=t.sent,t.abrupt("return",i.data);case 8:return t.prev=8,t.t0=t["catch"](1),t.abrupt("return",null);case 11:case"end":return t.stop()}},t,this,[[1,8]])}));return function(e){return t.apply(this,arguments)}}(),O=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a="ws/index/".concat(e),t.prev=1,t.next=4,f.a.get(a);case 4:return i=t.sent,t.abrupt("return",i.data);case 8:return t.prev=8,t.t0=t["catch"](1),t.abrupt("return",null);case 11:case"end":return t.stop()}},t,this,[[1,8]])}));return function(e){return t.apply(this,arguments)}}(),S=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,f.a.delete("ws/index/"+e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),z={name:"Index",data:function(){return{pattern:"*",name:"",indices:[],myIndices:[],show:!1}},created:function(){this.typePattern(),this.loadMyIndices()},methods:{typePattern:function(){var t=this,e=this.pattern,a="/_cat/indices/".concat(e,"?format=json"),i={method:"get",url:a};this.indices=[],f.a.post("ws/es/query",i).then(function(e){for(var a=0;a<e.data.length;a++)t.indices.push(e.data[a].index)})},loadMyIndices:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w();case 2:this.myIndices=t.sent;case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),explore:function(t){this.$router.push({path:"/index/explore/".concat(t)})},edit:function(t){this.$router.push({path:"/index/edit/".concat(t)})},remove:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,S(e);case 2:return t.next=4,this.loadMyIndices();case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),showAddDialog:function(){var t=this;this.show=!this.show,this.$nextTick(function(){t.$refs.pattern.setSelectionRange(0,0),t.$refs.pattern.focus()})},addIndex:function(){var t=this;if(this.pattern){var e={};e.name=this.name,e.pattern=this.pattern,f.a.post("ws/index/",e).then(function(e){var a=e.data;t.$router.push({path:"/index/edit/".concat(a)})})}}}},$=z,j=(a("d523"),Object(l["a"])($,_,x,!1,null,"6bfd3b48",null));j.options.__file="Index.vue";var D=j.exports,I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"view-page"},[a("div",{staticClass:"breadcrumb"},[t._v("Edit pattern")]),a("div",{staticClass:"view-content-full"},[a("h3",[t._v("Pattern: "+t._s(t.pattern))]),a("h3",[t._v("Name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-input",attrs:{type:"text",placeholder:"Name"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),a("h3",[t._v("Search")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],attrs:{type:"text",placeholder:"search"},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}}),a("h3",[t._v("Fields")]),a("table",[t._m(0),a("tbody",t._l(t.fields,function(e){return a("tr",{key:e.esName},[a("td",[t._v(t._s(e.esName))]),a("td",[t._v(t._s(e.esType))]),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"f.name"}],staticClass:"side-panel input",attrs:{type:"text"},domProps:{value:e.name},on:{input:function(a){a.target.composing||t.$set(e,"name",a.target.value)}}})]),a("td",[t._v(t._s(e.type))])])}))]),a("button",{staticClass:"button button1",on:{click:t.updateIndex}},[t._v("Save")])])])},N=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("ES NAME")]),a("th",[t._v("ES TYPE")]),a("th",[t._v("NAME")]),a("th",[t._v("TYPE")])])])}],P=(a("28a5"),a("a322")),B=(a("c5f6"),a("ac6a"),"ws/es/query"),F={headers:{"Content-Type":"application/json"}},R=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a="ws/es/mapping/".concat(e),t.prev=1,t.next=4,f.a.get(a);case 4:return i=t.sent,t.abrupt("return",i.data);case 8:return t.prev=8,t.t0=t["catch"](1),t.abrupt("return",[]);case 11:case"end":return t.stop()}},t,this,[[1,8]])}));return function(e){return t.apply(this,arguments)}}(),T=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e,a){var i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i="/".concat(e,"/_search"),n={method:"post",url:i,body:JSON.stringify(a)},t.prev=2,t.next=5,f.a.post("ws/es/query/table",n,F);case 5:return s=t.sent,t.abrupt("return",s.data);case 9:return t.prev=9,t.t0=t["catch"](2),t.abrupt("return",{});case 12:case"end":return t.stop()}},t,this,[[2,9]])}));return function(e,a){return t.apply(this,arguments)}}(),A=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e,a){var i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i=[],n=0;case 2:if(!(n<a.length)){t.next=15;break}t.t0=a[n].type,t.next="Number"===t.t0?6:"Date"===t.t0?6:"Text"===t.t0?8:"Bool"===t.t0?10:12;break;case 6:return i.push(E(e,a[n])),t.abrupt("break",12);case 8:return i.push(G(e,a[n])),t.abrupt("break",12);case 10:return i.push(M(e,a[n].esName)),t.abrupt("break",12);case 12:n++,t.next=2;break;case 15:return t.next=17,Promise.all(i);case 17:return s=t.sent,t.abrupt("return",s);case 19:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}(),E=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e,a){var i,n,s,r,o,l,c,d;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=a.esName,n='\n  {\n    "aggs" : {\n      "max" : { "max" : { "field" : "'.concat(i,'" } },\n      "min" : { "min" : { "field" : "').concat(i,'" } }\n    }\n  }'),s="/".concat(e,"/_search?pretty&size=0"),r={method:"post",url:s,body:n},o=[],t.prev=5,t.next=8,f.a.post(B,r,F);case 8:return l=t.sent,c=l.data.aggregations,d={field:i,type:"Number",data:{min:c.min.value,max:c.max.value}},"Date"===a.type&&(d={field:i,type:"Date",data:{min:new Date(Number(c.min.value)),max:new Date(Number(c.max.value))}}),t.abrupt("return",d);case 15:return t.prev=15,t.t0=t["catch"](5),t.abrupt("return",o);case 18:case"end":return t.stop()}},t,this,[[5,15]])}));return function(e,a){return t.apply(this,arguments)}}(),G=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e,a){var i,n,s,r,o,l,c,d;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=a.esName,"text"===a.esType&&(i+=".keyword"),n='\n  {\n    "aggs" : {\n      "groups" : {\n        "terms" : { \n          "field" : "'.concat(i,'",\n          "size": 100\n        }\n      }\n    }\n  }'),s="/".concat(e,"/_search?pretty&size=0"),r={method:"post",url:s,body:n},o=[],t.prev=6,t.next=9,f.a.post(B,r,F);case 9:for(l=t.sent,c=l.data.aggregations.groups.buckets,d=0;d<c.length;d++)o.push({key:c[d].key,count:c[d].doc_count});return t.abrupt("return",{field:a,type:"Text",data:o});case 15:return t.prev=15,t.t0=t["catch"](6),t.abrupt("return",o);case 18:case"end":return t.stop()}},t,this,[[6,15]])}));return function(e,a){return t.apply(this,arguments)}}(),M=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e,a){var i,n,s,r,o,l,c;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i='\n  {\n    "aggs" : {\n      "groups" : {\n        "terms" : { "field" : "'.concat(a,'" }\n      }\n    }\n  }'),n="/".concat(e,"/_search?pretty&size=0"),s={method:"post",url:n,body:i},r=[],t.prev=4,t.next=7,f.a.post(B,s,F);case 7:for(o=t.sent,l=o.data.aggregations.groups.buckets,c=0;c<l.length;c++)r.push({key:l[c].key_as_string,count:l[c].doc_count});return t.abrupt("return",{field:a,type:"Bool",data:r});case 13:return t.prev=13,t.t0=t["catch"](4),t.abrupt("return",r);case 16:case"end":return t.stop()}},t,this,[[4,13]])}));return function(e,a){return t.apply(this,arguments)}}(),V=function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(e,a){var i,n,s,r,o,l,c,d,u,h=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=h.length>2&&void 0!==h[2]?h[2]:null,n={aggs:{groups:{terms:{field:""}}}},s=a.esName,"text"===a.esType&&(s+=".keyword"),n.aggs.groups.terms.field=s,null!=i&&(n["query"]=i),r="/".concat(e,"/_search?pretty&size=0"),o={method:"post",url:r,body:JSON.stringify(n)},l=[],t.prev=9,t.next=12,f.a.post(B,o,F);case 12:for(c=t.sent,d=c.data.aggregations.groups.buckets,u=0;u<d.length;u++)l.push({key:d[u].key,count:d[u].doc_count});return t.abrupt("return",l);case 18:return t.prev=18,t.t0=t["catch"](9),t.abrupt("return",l);case 21:case"end":return t.stop()}},t,this,[[9,18]])}));return function(e,a){return t.apply(this,arguments)}}(),L=function(t,e){return{range:Object(P["a"])({},t,{gte:e})}},q=function(t,e){return{range:Object(P["a"])({},t,{lte:e})}},Y=function(t,e){return{terms:Object(P["a"])({},t,e)}},J=function(t,e){return{term:Object(P["a"])({},t,e)}},U=function(t){if(t&&0!=t.length){for(var e={bool:{filter:[]}},a=0;a<t.length;a++){var i=t[a].field,n=t[a].operator,s=t[a].value;if("Text"===i.type){var r=i.esName;if("text"===i.esType&&(r+=".keyword"),"contain"===n)e.bool.filter.push(J(r,s));else if("in"===n){var o=s.split(",");e.bool.filter.push(Y(r,o))}}else"Number"!==i.type&&"Date"!==i.type||(">="===n?e.bool.filter.push(L(i.esName,s)):"<="===n&&e.bool.filter.push(q(i.esName,s)))}return e}return null},X={name:"EditIndex",data:function(){return{id:"",pattern:"",name:"",fields:[],filteredFields:[],search:""}},created:function(){this.loadFields()},computed:{filteredFields:function(){return this.fields}},methods:{updateIndex:function(){var t=this,e={};e.id=this.id,e.name=this.name,e.pattern=this.pattern,e.fields=this.fields,f.a.put("ws/index/",e).then(function(e){t.$router.push({path:"/index"})})},loadFields:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$route.params.id,t.next=3,O(e);case 3:if(a=t.sent,this.id=a.id,this.name=a.name,this.pattern=a.pattern,void 0!==a.fields&&0!=a.fields.length){t.next=14;break}return t.next=10,R(this.pattern);case 10:i=t.sent,this.fields=i,t.next=15;break;case 14:this.fields=a.fields;case 15:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},H=X,W=(a("3ed5"),Object(l["a"])(H,I,N,!1,null,"248c75a3",null));W.options.__file="EditIndex.vue";var K=W.exports,Q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"view-page"},[a("div",[a("div",{staticClass:"breadcrumb"},[t._v("Explore - "+t._s(t.index.name)+" "+t._s(t.index.pattern))])]),a("div",{staticClass:"view-col side-panel"},[t._m(0),a("draggable",{staticClass:"drag-panel",attrs:{options:{group:"fields"}},model:{value:t.columnFields,callback:function(e){t.columnFields=e},expression:"columnFields"}},t._l(t.columnFields,function(e){return a("div",{key:e.id,staticClass:"drag-row"},[a("div",{staticClass:"row"},[a("div",{staticClass:"field-type"},["Text"===e.type?[t._v("\n              Abc\n            ")]:"Number"===e.type?[t._v("\n              #\n            ")]:"Bool"===e.type?[a("i",{staticClass:"fas fa-calendar-alt"})]:"Date"===e.type?[a("i",{staticClass:"fas fa-calendar-alt"})]:[t._v("\n              UN\n            ")]],2),a("div",{staticClass:"field-name"},[t._v(t._s(e.name))])])])}))],1),a("div",{staticClass:"view-content-col"},[a("div",{staticClass:"table-panel"},[a("table",[a("thead",[a("tr",t._l(t.columnFields,function(e){return a("th",{key:e.id},[t._v("\n              "+t._s(e.name)+"\n            ")])}))]),a("tbody",[a("tr",t._l(t.filters,function(e){return a("td",{key:e.field,staticStyle:{"vertical-align":"top"}},[a("div",{staticStyle:{"max-height":"260px","overflow-y":"auto"}},["Text"===e.type?[a("TextBarFilter",{attrs:{data:e.data}})]:"Number"===e.type?[a("div",[t._v("min: "+t._s(e.data.min))]),a("div",[t._v("max: "+t._s(e.data.max))])]:"Date"===e.type?[a("div",[t._v("min: "+t._s(e.data.min))]),a("div",[t._v("max: "+t._s(e.data.max))])]:"Bool"===e.type?[a("TextBarFilter",{attrs:{data:e.data}})]:[t._v("\n                  "+t._s(e.data)+"\n                ")]],2)])}))])])]),a("div",[t._v("\n      Rows per page:\n      "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pageSize,expression:"pageSize"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.pageSize=e.target.multiple?a:a[0]},t.onPageSizeChange]}},[a("option",[t._v("20")]),a("option",[t._v("50")]),a("option",[t._v("100")])]),t._v("\n\n      "+t._s(t.from)+" - "+t._s(t.toRecord)+" of "+t._s(t.totalSize)+"\n      "),a("button",{staticClass:"button button1",on:{click:t.prevPage}},[a("i",{staticClass:"fas fa-chevron-left"})]),a("button",{staticClass:"button button1",on:{click:t.nextPage}},[a("i",{staticClass:"fas fa-chevron-right"})]),t._m(1),t._m(2)]),a("div",{staticClass:"table-panel"},[a("table",[a("thead",[a("tr",t._l(t.columnFields,function(e){return a("th",{key:e.id,on:{click:function(a){t.sortBy(e)}}},[t._v("\n              "+t._s(e.name)+"\n            ")])}))]),a("tbody",t._l(t.table,function(e,i){return a("tr",{key:i},t._l(t.columnFields,function(i){return a("td",{key:i.id},[t._v("\n              "+t._s(e[i.esName])+"\n            ")])}))}))])])])])},Z=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"side-panel-title"},[a("div",{staticClass:"row"},[a("div",{staticClass:"float-left bold"},[t._v("Fields")]),a("div",{staticClass:"float-right"},[a("i",{staticClass:"fas fa-exchange-alt fa-rotate-90"})])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"button button1"},[a("i",{staticClass:"fas fa-table"}),t._v(" Save as Table Vis")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"button button1"},[a("i",{staticClass:"fas fa-file-csv"}),t._v(" CSV")])}],tt=a("1516"),et=a.n(tt),at=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("label",[t._v("Start:")]),a("datepicker",{attrs:{format:"yyyy-MM-dd",disabledDates:t.disabledStartDates,"input-class":"time-input","wrapper-class":"inline-block"},on:{closed:t.onClosed},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),a("div",[a("label",[t._v("End:")]),a("datepicker",{attrs:{format:"yyyy-MM-dd",disabledDates:t.disabledEndDates,"input-class":"time-input","wrapper-class":"inline-block"},on:{closed:t.onClosed},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)])},it=[],nt=a("fa33"),st={name:"DateRangeFilter",components:{Datepicker:nt["a"]},props:{field:String,start:Date,end:Date},data:function(){return{startDate:"",endDate:"",disabledStartDates:{},disabledEndDates:{}}},created:function(){this.startDate=this.date,this.endDate=this.date,this.changeDisabledDates()},methods:{formatDate:function(t){var e=new Date(t),a=""+(e.getMonth()+1),i=""+e.getDate(),n=e.getFullYear();return a.length<2&&(a="0"+a),i.length<2&&(i="0"+i),[n,a,i].join("-")},changeDisabledDates:function(){var t=this;this.$nextTick(function(){t.disabledStartDates={to:t.start,from:t.endDate},t.disabledEndDates={to:t.startDate,from:t.end}})},onClosed:function(){this.changeDisabledDates(),this.$emit("date-changed",{start:this.startDate,end:this.endDate})}}},rt=st,ot=(a("44d4"),Object(l["a"])(rt,at,it,!1,null,null,null));ot.options.__file="DateRangeFilter.vue";var lt=ot.exports,ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"min-width":"200px"}},[a("button",{staticClass:"button button1",on:{click:t.applyFilter}},[t._v("Apply")]),t._l(t.selectors,function(e){return a("div",{key:e.key,staticStyle:{"margin-top":"2px"}},[a("label",{staticClass:"checkbox-container"},[a("div",{staticClass:"progress-wrap"},[a("div",{staticClass:"progress-bar",style:{width:e.width+"%"}}),a("div",{staticClass:"progress-name"},[t._v(t._s(e.key))]),a("div",{staticClass:"progress-count"},[t._v(t._s(e.count))])]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"d.selected"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.selected)?t._i(e.selected,null)>-1:e.selected},on:{change:function(a){var i=e.selected,n=a.target,s=!!n.checked;if(Array.isArray(i)){var r=null,o=t._i(i,r);n.checked?o<0&&t.$set(e,"selected",i.concat([r])):o>-1&&t.$set(e,"selected",i.slice(0,o).concat(i.slice(o+1)))}else t.$set(e,"selected",s)}}}),a("span",{staticClass:"checkmark"})])])})],2)},dt=[],ut={name:"TextBarFilter",props:{data:Array},data:function(){return{selectors:[]}},created:function(){console.log("TextBarFilter",this.data);for(var t=[],e=0,a=0;a<this.data.length;a++){var i=this.data[a].count;i>e&&(e=i)}for(var n=0;n<this.data.length;n++)t.push({key:this.data[n].key,count:this.data[n].count,width:Math.floor(100*this.data[n].count/e),selected:!1});this.selectors=t,console.log("TextBarFilter",this.selectors)},methods:{applyFilter:function(){}}},ht=ut,pt=(a("e09e"),Object(l["a"])(ht,ct,dt,!1,null,null,null));pt.options.__file="TextBarFilter.vue";var vt=pt.exports,ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"number-range-panel"},[a("vue-slider",t._b({model:{value:t.slider.value,callback:function(e){t.$set(t.slider,"value",e)},expression:"slider.value"}},"vue-slider",t.slider,!1)),a("div",[a("div",{staticStyle:{float:"left"}},[t._v("Min: "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.slider.value[0],expression:"slider.value[0]"}],staticClass:"num-range-input",attrs:{type:"number"},domProps:{value:t.slider.value[0]},on:{input:function(e){e.target.composing||t.$set(t.slider.value,0,e.target.value)}}})]),a("div",{staticStyle:{float:"right"}},[t._v("Max: "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.slider.value[1],expression:"slider.value[1]"}],staticClass:"num-range-input",attrs:{type:"number"},domProps:{value:t.slider.value[1]},on:{input:function(e){e.target.composing||t.$set(t.slider.value,1,e.target.value)}}})])])],1)},gt=[],mt=a("6f79"),bt=a.n(mt),yt={name:"NumberRangeFilter",components:{vueSlider:bt.a},props:{min:Number,max:Number},data:function(){return{slider:{value:[0,100],width:"100%",height:8,dotSize:16,min:0,max:500,disabled:!1,show:!0,useKeyboard:!1,tooltip:"always",formatter:"{value}",enableCross:!1,mergeFormatter:"{value1} ~ {value2}",bgStyle:{backgroundColor:"#fff",boxShadow:"inset 0.5px 0.5px 3px 1px rgba(0,0,0,.36)"},tooltipStyle:{backgroundColor:"#000000",borderColor:"#000000"},processStyle:{backgroundColor:"#999"}}}},created:function(){this.slider.value=[this.min,this.max],this.slider.min=this.min,this.slider.max=this.max}},_t=yt,xt=(a("ab50"),Object(l["a"])(_t,ft,gt,!1,null,null,null));xt.options.__file="NumberRangeFilter.vue";var Ct=xt.exports,wt={name:"ExploreIndex",components:{draggable:et.a,DateRangeFilter:lt,TextBarFilter:vt,NumberRangeFilter:Ct},data:function(){return{pageSize:20,from:0,totalSize:0,fields:[],columnFields:[],sortFields:[],rows:[],index:{},filters:[]}},created:function(){this.loadIndex()},computed:{toRecord:function(){var t=Number(this.pageSize),e=Number(this.from);return e+t>=this.totalSize?this.totalSize:e+t}},methods:{loadIndex:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$route.params.id,t.next=3,O(e);case 3:return a=t.sent,this.index=a,this.fields=a.fields,t.next=8,this.loadTable();case 8:return t.next=10,A(a.pattern,this.columnFields);case 10:i=t.sent,this.filters=i;case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),loadTable:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n,s,r,o,l,c,d,u,h,p;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:for(e=[],a=0;a<this.sortFields.length;a++)e.push(Object(P["a"])({},this.sortFields[a].name,{order:this.sortFields[a].order}));return i={from:this.from,size:this.pageSize,sort:e},console.log(i),t.next=6,T(this.index.pattern,i);case 6:n=t.sent,console.log(n),this.totalSize=n.size,s=n.table||[],r=n.columns||[],this.columnFields=[],o=0;case 13:if(!(o<r.length)){t.next=25;break}l=0;case 15:if(!(l<this.fields.length)){t.next=22;break}if(r[o]!==this.fields[l].esName){t.next=19;break}return this.columnFields.push(this.fields[l]),t.abrupt("break",22);case 19:l++,t.next=15;break;case 22:o++,t.next=13;break;case 25:console.log(this.columnFields),this.table=[],c=0;case 28:if(!(c<s.length)){t.next=48;break}d=s[c],u={},h=0;case 32:if(!(h<r.length)){t.next=44;break}p=0;case 34:if(!(p<d.length)){t.next=41;break}if(r[h]!==d[p].key){t.next=38;break}return u[d[p].key]=d[p].value,t.abrupt("break",41);case 38:p++,t.next=34;break;case 41:h++,t.next=32;break;case 44:this.table.push(u);case 45:c++,t.next=28;break;case 48:console.log(this.table);case 49:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),prevPage:function(){var t=Number(this.pageSize),e=Number(this.from);this.from=e-t<0?0:e-t,this.loadTable()},nextPage:function(){var t=Number(this.pageSize),e=Number(this.from);e+t>=this.totalSize||(this.from=e+t,this.loadTable())},onPageSizeChange:function(){this.loadTable()},sortBy:function(t){var e=!1,a=t.esName;"Text"===t.type&&(a+=".keyword");for(var i=0;i<this.sortFields.length;i++)if(this.sortFields[i].name===a){this.sortFields[i].order="asc"===this.sortFields[i].order?"desc":"asc",e=!0;break}e||(this.sortFields=[],this.sortFields.push({name:a,order:"asc"})),this.loadTable()},onDateFilterChange:function(t){console.log(t.start,t.end)}}},kt=wt,Ot=(a("4dd8"),Object(l["a"])(kt,Q,Z,!1,null,null,null));Ot.options.__file="ExploreIndex.vue";var St=Ot.exports,zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"view-page"},[a("div",{staticClass:"breadcrumb"},[t._v("\n    Dashboard\n  ")]),a("div",{staticClass:"view-content-full"},[a("div",[t._v("list of dashboard")]),a("button",{staticClass:"button button1",on:{click:function(e){t.showDash=!t.showDash}}},[a("i",{staticClass:"fas fa-plus"}),t._v(" Add\n    ")]),a("div",t._l(t.dashboards,function(e){return a("div",{key:e.id},[t._v("\n        name: "+t._s(e.name)+"\n        "),a("button",{staticClass:"button button1",on:{click:function(a){t.view(e.id)}}},[a("i",{staticClass:"fas fa-desktop"})]),a("button",{staticClass:"button button1",on:{click:function(a){t.edit(e.id)}}},[a("i",{staticClass:"fas fa-edit"})]),a("button",{staticClass:"button button1",on:{click:function(a){t.remove(e.id)}}},[a("i",{staticClass:"fas fa-trash-alt"})]),a("hr")])})),a("transition",{attrs:{name:"slide"}},[t.showDash?a("div",{attrs:{id:"add-dashboard-panel"}},[a("div",[a("div",[t._v("Name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),a("button",{staticClass:"button button1",on:{click:t.addDashboard}},[t._v("Add")])]):t._e()])],1)])},$t=[],jt={name:"Dashboard",data:function(){return{name:"",width:1280,height:720,dashboards:[],showDash:!1}},created:function(){var t=this;f.a.get("ws/dashboard").then(function(e){t.dashboards=e.data})},methods:{addDashboard:function(){var t=this,e={};e.name=this.name,e.width=this.width,e.height=this.height,f.a.post("ws/dashboard",e).then(function(e){var a=e.data;console.log(a),t.name="",t.$router.push({path:"/dashboard/edit/".concat(a)})})},view:function(t){this.$router.push({path:"/dashboard/view/".concat(t)})},edit:function(t){this.$router.push({path:"/dashboard/edit/".concat(t)})},remove:function(t){f.a.delete("ws/dashboard/"+t)}}},Dt=jt,It=(a("16cb"),Object(l["a"])(Dt,zt,$t,!1,null,"81986c5c",null));It.options.__file="Dashboard.vue";var Nt=It.exports,Pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"view-page"},[a("div",{staticClass:"row"},[a("div",{staticClass:"breadcrumb float-left"},[t._v("Dashboard > Edit: "+t._s(t.dashboard.name))]),a("div",{staticClass:"float-right"},[a("button",{staticClass:"button button1",on:{click:t.save}},[t._v("Save")])])]),a("div",{staticClass:"view-col-3 side-panel"},[a("div",{staticClass:"side-panel-title"},[a("div",{staticClass:"row"},[t._m(0),a("div",{staticClass:"float-right"},[t._v("\n          "+t._s(t.dashboard.width)+" x "+t._s(t.dashboard.height)+"\n        ")])])]),a("div",{staticClass:"side-panel-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"float-left side-panel-label"},[t._v("Snap to grid")]),a("div",{staticClass:"float-right"},[a("label",{staticClass:"switch",staticStyle:{"margin-top":"12px","margin-right":"-2px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.gridOptions.snapToGrid,expression:"gridOptions.snapToGrid"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.gridOptions.snapToGrid)?t._i(t.gridOptions.snapToGrid,null)>-1:t.gridOptions.snapToGrid},on:{change:function(e){var a=t.gridOptions.snapToGrid,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&t.$set(t.gridOptions,"snapToGrid",a.concat([s])):r>-1&&t.$set(t.gridOptions,"snapToGrid",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.gridOptions,"snapToGrid",n)}}}),a("span",{staticClass:"slider round"})])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"float-left side-panel-label"},[t._v("Show gridlines")]),a("div",{staticClass:"float-right"},[a("label",{staticClass:"switch",staticStyle:{"margin-top":"12px","margin-right":"-2px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.gridOptions.showGridlines,expression:"gridOptions.showGridlines"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.gridOptions.showGridlines)?t._i(t.gridOptions.showGridlines,null)>-1:t.gridOptions.showGridlines},on:{change:function(e){var a=t.gridOptions.showGridlines,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&t.$set(t.gridOptions,"showGridlines",a.concat([s])):r>-1&&t.$set(t.gridOptions,"showGridlines",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.gridOptions,"showGridlines",n)}}}),a("span",{staticClass:"slider round"})])])])]),a("div",{staticClass:"side-panel-title"},[a("div",{staticClass:"row"},[a("div",{staticClass:"float-left"},[t._v("Grid")]),a("div",{staticClass:"float-right"},[a("label",{staticClass:"switch"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.gridStyle.gridBgOn,expression:"gridStyle.gridBgOn"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.gridStyle.gridBgOn)?t._i(t.gridStyle.gridBgOn,null)>-1:t.gridStyle.gridBgOn},on:{change:function(e){var a=t.gridStyle.gridBgOn,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&t.$set(t.gridStyle,"gridBgOn",a.concat([s])):r>-1&&t.$set(t.gridStyle,"gridBgOn",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.gridStyle,"gridBgOn",n)}}}),a("span",{staticClass:"slider round"})])])])]),t.gridStyle.gridBgOn?a("div",{staticClass:"side-panel-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"float-left side-panel-label"},[t._v("Background color")]),a("div",{staticClass:"float-right"},[a("ColorInput",{model:{value:t.gridStyle.gridBgColor,callback:function(e){t.$set(t.gridStyle,"gridBgColor",e)},expression:"gridStyle.gridBgColor"}})],1)])]):t._e(),a("div",{staticClass:"side-panel-title"},[a("div",{staticClass:"row"},[a("div",{staticClass:"float-left"},[t._v("Title")]),a("div",{staticClass:"float-right"},[a("label",{staticClass:"switch"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.gridStyle.titleOn,expression:"gridStyle.titleOn"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.gridStyle.titleOn)?t._i(t.gridStyle.titleOn,null)>-1:t.gridStyle.titleOn},on:{change:function(e){var a=t.gridStyle.titleOn,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&t.$set(t.gridStyle,"titleOn",a.concat([s])):r>-1&&t.$set(t.gridStyle,"titleOn",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.gridStyle,"titleOn",n)}}}),a("span",{staticClass:"slider round"})])])])]),t.gridStyle.titleOn?a("div",{staticClass:"side-panel-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"float-left side-panel-label"},[t._v("Font color")]),a("div",{staticClass:"float-right"},[a("ColorInput",{model:{value:t.gridStyle.titleFontColor,callback:function(e){t.$set(t.gridStyle,"titleFontColor",e)},expression:"gridStyle.titleFontColor"}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"float-left side-panel-label"},[t._v("Background color")]),a("div",{staticClass:"float-right"},[a("ColorInput",{model:{value:t.gridStyle.titleBgColor,callback:function(e){t.$set(t.gridStyle,"titleBgColor",e)},expression:"gridStyle.titleBgColor"}})],1)])]):t._e(),a("div",{staticClass:"side-panel-title"},[a("div",{staticClass:"row"},[a("div",{staticClass:"float-left"},[t._v("Border")]),a("div",{staticClass:"float-right"},[a("label",{staticClass:"switch"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.gridStyle.borderOn,expression:"gridStyle.borderOn"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.gridStyle.borderOn)?t._i(t.gridStyle.borderOn,null)>-1:t.gridStyle.borderOn},on:{change:function(e){var a=t.gridStyle.borderOn,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&t.$set(t.gridStyle,"borderOn",a.concat([s])):r>-1&&t.$set(t.gridStyle,"borderOn",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.gridStyle,"borderOn",n)}}}),a("span",{staticClass:"slider round"})])])])]),t.gridStyle.borderOn?a("div",{staticClass:"side-panel-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"float-left side-panel-label"},[t._v("Color")]),a("div",{staticClass:"float-right"},[a("ColorInput",{model:{value:t.gridStyle.borderColor,callback:function(e){t.$set(t.gridStyle,"borderColor",e)},expression:"gridStyle.borderColor"}})],1)])]):t._e(),a("div",{staticClass:"side-panel-title"},[a("div",{staticClass:"row"},[a("div",{staticClass:"float-left"},[t._v("Panel")]),a("div",{staticClass:"float-right"},[a("label",{staticClass:"switch"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.gridStyle.panelBgOn,expression:"gridStyle.panelBgOn"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.gridStyle.panelBgOn)?t._i(t.gridStyle.panelBgOn,null)>-1:t.gridStyle.panelBgOn},on:{change:function(e){var a=t.gridStyle.panelBgOn,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&t.$set(t.gridStyle,"panelBgOn",a.concat([s])):r>-1&&t.$set(t.gridStyle,"panelBgOn",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.gridStyle,"panelBgOn",n)}}}),a("span",{staticClass:"slider round"})])])])]),t.gridStyle.panelBgOn?a("div",{staticClass:"side-panel-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"float-left side-panel-label"},[t._v("Background color")]),a("div",{staticClass:"float-right"},[a("ColorInput",{model:{value:t.gridStyle.panelBgColor,callback:function(e){t.$set(t.gridStyle,"panelBgColor",e)},expression:"gridStyle.panelBgColor"}})],1)])]):t._e(),a("div",{staticClass:"side-panel-title"},[t._v("\n      Visualizations\n    ")]),a("div",{staticClass:"side-panel-content"},t._l(t.dashboard.visualizations,function(e){return a("div",{key:e.id},[t._v("\n        "+t._s(e.name)+" "+t._s(e.type)+" \n      ")])})),a("div",{staticClass:"side-panel-title"},[t._v("Visualization")]),a("div",{staticClass:"side-panel-content"},[a("button",{staticClass:"button button1",on:{click:t.newVisualization}},[t._v("\n        Add Visualization\n      ")])]),a("div",{staticClass:"side-panel-title"},[t._v("Filters")]),a("div",{staticClass:"side-panel-content"},[t._v("\n      TODO: get all indices used by visualizations on this dashboard.\n      choose fields to filter.\n    ")])]),a("div",{staticClass:"view-content-col-3",staticStyle:{padding:"15px"}},[a("Grid",{attrs:{dashboard:t.dashboard,gridStyle:t.gridStyle,gridOptions:t.gridOptions},on:{"box-changed":t.onBoxChanged,"edit-visualization":t.onEdit,"remove-visualization":t.onRemove}})],1)])},Bt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"float-left tab-name"},[a("i",{staticClass:"fas fa-cog"})])}],Ft=(a("20d6"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"grid",staticClass:"grid",style:t.style},t._l(t.boxes,function(e){return a("GridBox",{key:e.id,attrs:{visualization:e,gridStyle:t.gridStyle,zIndex:2,readOnly:t.gridOptions.readOnly},on:{"edit-visualization":t.onEdit,"remove-visualization":t.onRemove}})}))}),Rt=[],Tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"grid-box",style:t.boxStyle,attrs:{id:t.id}},[t.gridStyle.titleOn?a("div",{staticClass:"grid-box-title",style:t.titleStyle},[t._v("\n    "+t._s(t.visualization.name)+"\n  ")]):t._e(),a("div",{staticClass:"grid-box-content",style:t.contentStyle},["pie"===t.visualization.type||"bar"===t.visualization.type?[a("v-chart",{attrs:{options:t.chartOptions,"auto-resize":!0},on:{click:t.onChartClick}})]:t._e(),"table"===t.visualization.type?[a("table",t._l(10,function(e){return a("tr",{key:e},t._l(10,function(i){return a("td",{key:i},[t._v("\n            "+t._s(e)+" "+t._s(i)+"\n          ")])}))}))]:t._e()],2),t.readOnly?t._e():a("div",{staticClass:"grid-box-resize"}),t.readOnly?t._e():a("div",{staticClass:"grid-box-edit"},[a("i",{staticClass:"fas fa-edit fa-fw",on:{click:function(e){return e.target!==e.currentTarget?null:t.edit(e)}}})]),t.readOnly?t._e():a("div",{staticClass:"grid-box-remove"},[a("i",{staticClass:"fas fa-times fa-fw",on:{click:function(e){return e.target!==e.currentTarget?null:t.remove(e)}}})])])},At=[],Et=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],Gt=function(t,e){return{color:Et,tooltip:{},legend:{data:t,orient:"vertical",right:10,top:10,bottom:10},series:[{type:"pie",center:["50%","50%"],radius:"50%",data:e}]}},Mt={name:"GridBox",props:{visualization:Object,readOnly:Boolean,gridStyle:Object},data:function(){return{chartOptions:{}}},created:function(){this.chartOptions={},"pie"===this.visualization.type&&this.createPieChart()},computed:{id:function(){return"grid-box-"+this.visualization.id},boxStyle:function(){var t=this.visualization.x,e=this.visualization.y,a=this.visualization.width,i=this.visualization.height,n=this.zIndex,s="left: ".concat(t,"px; top: ").concat(e,"px; width: ").concat(a,"px; height: ").concat(i,"px; z-index: ").concat(n,";");if(this.gridStyle.borderOn){var r=this.gridStyle.borderColor;s+="border: 3px solid ".concat(r,";")}return s},titleStyle:function(){if(this.gridStyle.titleOn){var t=this.gridStyle.titleFontColor,e=this.gridStyle.titleBgColor,a="color: ".concat(t,"; background-color: ").concat(e,";");return a}},contentStyle:function(){var t=this.gridStyle.titleOn?this.visualization.height-26:this.visualization.height,e="height: ".concat(t,"px; overflow: auto;");if(this.gridStyle.panelBgOn){var a=this.gridStyle.panelBgColor;e+="background-color: ".concat(a,";")}return e}},methods:{createPieChart:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return console.log(this.visualization),e=U(this.visualization.filter),t.next=4,V(this.visualization.indexPattern,this.visualization.option.key,e);case 4:for(a=t.sent,i=[],n=[],s=0;s<a.length;s++)i.push(a[s].key),n.push({name:a[s].key,value:a[s].count});this.chartOptions=Gt(i,n),console.log(this.chartOptions);case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),edit:function(){this.$emit("edit-visualization",this.visualization.id)},remove:function(){this.$emit("remove-visualization",this.visualization.id)},onChartClick:function(t){console.log(t)}}},Vt=Mt,Lt=(a("d615"),Object(l["a"])(Vt,Tt,At,!1,null,null,null));Lt.options.__file="GridBox.vue";var qt=Lt.exports,Yt={name:"Grid",props:{dashboard:Object,gridStyle:Object,gridOptions:Object},components:{GridBox:qt},mounted:function(){this.$refs.grid.addEventListener("mousedown",this.mouseDown,!1),this.$refs.grid.addEventListener("mouseup",this.mouseUp,!1),this.$refs.grid.addEventListener("mousemove",this.mouseMove,!1);var t=this.$el.parentNode;t.offsetWidth,t.offsetHeight},beforeDestroy:function(){this.$refs.grid.removeEventListener("mousedown",this.mouseDown,!1),this.$refs.grid.removeEventListener("mouseup",this.mouseUp,!1),this.$refs.grid.removeEventListener("mousemove",this.mouseMove,!1)},data:function(){return{boxes:[],dragObject:null,isDragging:!1,isResizing:!1,xOffset:0,yOffset:0,currentX:0,currentY:0}},computed:{style:function(){var t=this.dashboard.width,e=this.dashboard.height,a="\n        background-size: 20px 20px;\n        background-image: linear-gradient(to right, grey 1px, transparent 1px), linear-gradient(to bottom, grey 1px, transparent 1px);\n      ",i="width: ".concat(t,"px; height: ").concat(e,"px;");if(this.gridOptions.showGridlines&&(i+=a),this.gridStyle.gridBgOn){var n=this.gridStyle.gridBgColor;i+="background-color: ".concat(n,";")}return i}},watch:{dashboard:function(t){this.boxes=t.visualizations,console.log("grid",this.boxes)}},methods:{mouseDown:function(t){if(t.preventDefault(),"grid-box-title"===t.target.className){if(null==this.dragObject){this.dragObject=t.target.parentNode,this.isDragging=!0,this.isResizing=!1,this.xOffset=t.clientX-this.dragObject.offsetLeft,this.yOffset=t.clientY-this.dragObject.offsetTop;for(var e=document.getElementsByClassName("grid-box"),a=0;a<e.length;a++)e[a].style.zIndex=2;this.dragObject.style.zIndex=3}}else if("grid-box-resize"===t.target.className&&null==this.dragObject){this.dragObject=t.target.parentNode,this.isDragging=!1,this.isResizing=!0,this.xOffset=t.clientX,this.yOffset=t.clientY;e=document.getElementsByClassName("grid-box");for(var i=0;i<e.length;i++)e[i].style.zIndex=2;this.dragObject.style.zIndex=3}},mouseUp:function(t){console.log("up"),t.preventDefault(),null!=this.dragObject&&(this.dragObject=null,this.isDragging=!1,this.isResizing=!1,this.xOffset=0,this.yOffset=0,this.$emit("box-changed",this.boxes))},mouseMove:function(t){t.preventDefault();var e=1;this.gridOptions.snapToGrid&&(e=5);var a=this.$el.clientWidth,i=this.$el.clientHeight,n=t.clientX-this.xOffset,s=t.clientY-this.yOffset;if(this.isDragging){n=Math.floor(n/e)*e,s=Math.floor(s/e)*e;var r=parseInt(this.dragObject.style.width,10)+6,o=parseInt(this.dragObject.style.height,10)+6;n<0&&(n=0),s<0&&(s=0),n+r>a&&(n=a-r),s+o>i&&(s=i-o),this.dragObject.style.left=n+"px",this.dragObject.style.top=s+"px";var l=this.dragObject.id,c=parseInt(this.dragObject.style.left,10),d=parseInt(this.dragObject.style.top,10),u=parseInt(this.dragObject.style.width,10),h=parseInt(this.dragObject.style.height,10),p=this.boxes.findIndex(function(t){return"grid-box-"+t.id===l});-1!==p&&(this.boxes[p].x=c,this.boxes[p].y=d,this.boxes[p].width=u,this.boxes[p].height=h,console.log("resize - this.boxes",this.boxes[p]))}else if(this.isResizing){var v=parseInt(this.dragObject.style.width,10),f=parseInt(this.dragObject.style.height,10);this.xOffset=t.clientX,this.yOffset=t.clientY,v+n<=50&&(n=50-v),f+s<=50&&(s=50-f),v+n>a&&(n=a-v),f+s>i&&(s=i-s),this.dragObject.style.width=Math.floor(v+n)+"px",this.dragObject.style.height=Math.floor(f+s)+"px";var g=this.dragObject.id,m=parseInt(this.dragObject.style.left,10),b=parseInt(this.dragObject.style.top,10),y=parseInt(this.dragObject.style.width,10),_=parseInt(this.dragObject.style.height,10),x=this.boxes.findIndex(function(t){return"grid-box-"+t.id===g});-1!==x&&(this.boxes[x].x=m,this.boxes[x].y=b,this.boxes[x].width=y,this.boxes[x].height=_,console.log("resize - this.boxes",this.boxes[x]))}},onEdit:function(t){this.$emit("edit-visualization",t)},onRemove:function(t){this.$emit("remove-visualization",t)}}},Jt=Yt,Ut=(a("b401"),Object(l["a"])(Jt,Ft,Rt,!1,null,null,null));Ut.options.__file="Grid.vue";var Xt=Ut.exports,Ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{width:"20px",height:"20px","margin-top":"12px"},style:"background-color: "+t.value,on:{click:function(e){t.showPanel=!t.showPanel}}}),t.showPanel?a("Chrome",{attrs:{value:t.colors},on:{input:t.updateColor}}):t._e()],1)},Wt=[],Kt=a("c345"),Qt={name:"ColorInput",components:{Chrome:Kt["Chrome"]},props:{value:String},data:function(){return{colors:"#123456",showPanel:!1}},watch:{value:function(t){this.colors=t}},methods:{updateColor:function(t){this.$emit("input",t.hex)}}},Zt=Qt,te=(a("efaf"),Object(l["a"])(Zt,Ht,Wt,!1,null,null,null));te.options.__file="ColorInput.vue";var ee=te.exports,ae={titleOn:!1,titleFontColor:"#ffffff",titleBgColor:"#000000",borderOn:!1,borderColor:"#000000",panelBgOn:!1,panelBgColor:"#ffffff",gridBgOn:!1,gridBgColor:"#ffffff"},ie={name:"EditDashboard",components:{Grid:Xt,ColorInput:ee},data:function(){return{dashboard:{id:0,name:"",width:1280,height:720,visualizations:[]},gridStyle:ae,gridOptions:{snapToGrid:!1,showGridlines:!1,readOnly:!1}}},created:function(){this.loadDashboard()},methods:{loadDashboard:function(){var t=this;this.id=this.$route.params.id,f.a.get("ws/dashboard/"+this.id).then(function(e){var a=e.data;t.dashboard=a||{},t.gridStyle=a.gridStyle||ae,console.log("editDashboard created",t.dashboard)})},newVisualization:function(){var t=this.$route.params.id;this.$router.push({path:"/dashboard/".concat(t,"/visualization/0")})},save:function(){var t=this.dashboard;t.gridStyle=this.gridStyle,f.a.put("ws/dashboard",t).then(function(t){console.log("dashboard saved")})},onBoxChanged:function(t){console.log("onBoxChanged",t),this.dashboard.visualizations=t,console.log("onBoxChanged",this.dashboard.visualizations)},onEdit:function(t){var e=this.dashboard.id,a=t;this.$router.push({path:"/dashboard/".concat(e,"/visualization/").concat(a)})},onRemove:function(t){var e=this;f.a.delete("ws/visualization/"+t).then(function(a){var i=e.dashboard.visualizations.findIndex(function(e){return e===t});e.dashboard.visualizations.splice(i,1)})}}},ne=ie,se=(a("756c"),Object(l["a"])(ne,Pt,Bt,!1,null,null,null));se.options.__file="EditDashboard.vue";var re=se.exports,oe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"view-page"},[t._v("\n  view dashboard\n  "),a("button",{staticClass:"button button1"},[t._v("Share")]),a("h3",[t._v("filter Panel - toggle")]),a("div",[t._v("\n    TODO: range filters.\n  ")]),a("div",{staticClass:"view-content-full"},[a("Grid",{attrs:{dashboard:t.dashboard,gridOptions:t.gridOptions}})],1)])},le=[],ce={name:"ViewDashboard",components:{Grid:Xt},data:function(){return{dashboard:{},gridOptions:{snapToGrid:!1,showGridlines:!1,readOnly:!0}}},created:function(){this.loadDashboard()},methods:{loadDashboard:function(){var t=this;this.id=this.$route.params.id,axios.get("ws/dashboard/"+this.id).then(function(e){t.dashboard=e.data,console.log("editDashboard created",t.dashboard)})}}},de=ce,ue=(a("21d7"),Object(l["a"])(de,oe,le,!1,null,"6955c349",null));ue.options.__file="ViewDashboard.vue";var he=ue.exports,pe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"view-page"},[a("div",{staticClass:"row"},[a("div",{staticClass:"breadcrumb float-left"},[t._v("Visualization: "+t._s(t.name))]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),a("div",{staticClass:"float-right"},[a("button",{staticClass:"button button1",on:{click:t.save}},[t._v("Save")])]),a("div",{staticClass:"float-right"},[a("button",{staticClass:"button button1",on:{click:t.backToDashboard}},[t._v("Back")])])]),a("div",{staticClass:"view-col-1 side-panel"},[a("div",{staticClass:"side-panel-title"},[t._v("\n      Visualizations\n    ")]),a("div",{staticClass:"side-panel-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"vis-box",on:{click:function(e){t.type="table"}}},[a("i",{staticClass:"fas fa-table fa-2x"})]),a("div",{staticClass:"vis-box",on:{click:function(e){t.type="bar"}}},[a("i",{staticClass:"fas fa-chart-bar fa-2x"})]),a("div",{staticClass:"vis-box",on:{click:function(e){t.type="pie"}}},[a("i",{staticClass:"fas fa-chart-pie fa-2x"})]),a("div",{staticClass:"vis-box",on:{click:function(e){t.type="text"}}},[a("i",{staticClass:"fas fa-font fa-2x"})])])]),a("div",{staticClass:"side-panel-title"},[t._v("\n      Drill down\n    ")]),a("div",{staticClass:"side-panel-content"},[t._v("\n      pie: -> key \n      table: -> column \n      text: -> link \n      bar: -> \n      line: ->\n    ")]),a("div",{staticClass:"side-panel-title"},[t._v("\n      Style\n    ")]),a("div",{staticClass:"side-panel-content"},[t._v("\n     chart style\n    ")])]),a("div",{staticClass:"view-col-2 side-panel"},[a("div",{staticClass:"side-panel-title"},[t._v("\n      Index\n    ")]),a("div",{staticClass:"side-panel-content"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.indexPattern,expression:"indexPattern"}],staticClass:"select",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.indexPattern=e.target.multiple?a:a[0]},t.onIndexChange]}},t._l(t.indices,function(e){return a("option",{key:e.id,domProps:{value:e.pattern}},[t._v("\n          "+t._s(e.name)+"\n        ")])}))]),a("div",{staticClass:"side-panel-title"},[t._v("\n      Filter\n    ")]),a("div",{staticClass:"side-panel-content"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.filterField,expression:"filterField"}],staticClass:"select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.filterField=e.target.multiple?a:a[0]}}},t._l(t.fields,function(e){return a("option",{key:e.id,domProps:{value:e}},[t._v("\n          "+t._s(e.type)+", "+t._s(e.name)+"\n        ")])})),a("div",[a("select",{directives:[{name:"model",rawName:"v-model",value:t.filterOperator,expression:"filterOperator"}],staticClass:"select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.filterOperator=e.target.multiple?a:a[0]}}},t._l(t.filterOperators,function(e){return a("option",{key:e,domProps:{value:e}},[t._v("\n            "+t._s(e)+"\n          ")])})),a("input",{directives:[{name:"model",rawName:"v-model",value:t.filterValue,expression:"filterValue"}],attrs:{type:"text"},domProps:{value:t.filterValue},on:{input:function(e){e.target.composing||(t.filterValue=e.target.value)}}}),a("button",{on:{click:t.addFilter}},[t._v("Add")])]),a("div",t._l(t.filter,function(e,i){return a("div",{key:i},[t._v("\n          "+t._s(e.field.name)+" "+t._s(e.operator)+" "+t._s(e.value)+"\n          "),a("button",{on:{click:function(e){t.deleteFilter(i)}}},[t._v("delete")])])}))]),"pie"===t.type?[a("div",{staticClass:"title bold"},[t._v("\n        Pie "+t._s(t.pieChart.option.aggr)+" "+t._s(t.pieChart.option.value)+" by "+t._s(t.pieChart.option.key)+"\n      ")]),a("div",{staticClass:"title"},[t._v("Aggr")]),a("div",{staticClass:"content"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pieChart.option.aggr,expression:"pieChart.option.aggr"}],staticClass:"select",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.pieChart.option,"aggr",e.target.multiple?a:a[0])},t.onPieAggrChange]}},t._l(t.pieChart.aggrs,function(e){return a("option",{key:e},[t._v("\n            "+t._s(e)+"\n          ")])}))]),a("div",{staticClass:"title"},[t._v("Number")]),a("div",{staticClass:"content"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pieChart.option.value,expression:"pieChart.option.value"}],staticClass:"select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.pieChart.option,"value",e.target.multiple?a:a[0])}}},t._l(t.pieChart.values,function(e){return a("option",{key:e,domProps:{value:e}},[t._v("\n            "+t._s(e.type)+", "+t._s(e.name)+"\n          ")])}))]),a("div",{staticClass:"title"},[t._v("By value")]),a("div",{staticClass:"content"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pieChart.option.key,expression:"pieChart.option.key"}],staticClass:"select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.pieChart.option,"key",e.target.multiple?a:a[0])}}},t._l(t.pieChart.keys,function(e){return a("option",{key:e,domProps:{value:e}},[t._v("\n            "+t._s(e.type)+", "+t._s(e.name)+"\n          ")])}))])]:t._e(),a("button",{staticClass:"button button1",on:{click:t.run}},[t._v("Run")])],2),a("div",{staticClass:"view-content-col-2"},[a("v-chart",{attrs:{options:t.chartOptions,"auto-resize":!0}})],1)])},ve=[],fe={name:"EditVisualization",data:function(){return{visualizationId:0,name:"",type:"",dashboardId:0,indexPattern:"",style:"",option:{},filter:[],indices:[],fields:[],filterField:"",filterOperator:"",filterValue:"",pieChart:{option:{aggr:"",key:"",value:""},aggrs:["count","sum","avg"],keys:[],values:[]},tableChart:{columns:[]},barChart:{},textChart:{},chartOptions:{}}},created:function(){this.loadIndices(),this.dashboardId=this.$route.params.dashboardId,this.visualizationId=this.$route.params.visualizationId,"0"===this.visualizationId||this.loadVisualization(this.visualizationId),console.log("create pie",this.dashboardId,this.visualizationId)},computed:{filterOperators:function(){var t=[];return"Text"===this.filterField.type?t=["contain","in"]:"Number"===this.filterField.type?t=[">=","<=","=="]:"Date"===this.filterField.type&&(t=[">=","<="]),t}},methods:{loadVisualization:function(t){var e=this;f.a.get("ws/visualization/"+t).then(function(t){var a=t.data;console.log("get vis",a),e.name=a.name,e.type=a.type,e.indexPattern=a.indexPattern,e.style=a.style||{},e.filter=a.filter||[],"pie"===e.type&&(e.pieChart.option=a.option||{}),e.onIndexChange(),e.run(),console.log("aggr",e.pieChart.option)})},loadIndices:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w();case 2:this.indices=t.sent;case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onIndexChange:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.indexPattern){t.next=6;break}return t.next=3,k(this.indexPattern);case 3:if(this.index=t.sent,this.fields=this.index.fields,"pie"===this.type){for(this.pieChart.keys=[],this.pieChart.values=[],e=0;e<this.fields.length;e++)"Text"===this.fields[e].type&&this.pieChart.keys.push(this.fields[e]),"Text"!==this.fields[e].type&&"Number"!==this.fields[e].type||this.pieChart.values.push(this.fields[e]);this.onPieAggrChange()}case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onPieAggrChange:function(){if(this.pieChart.values=[],"count"===this.pieChart.aggr)for(var t=0;t<this.fields.length;t++)"Text"===this.fields[t].type&&this.pieChart.values.push(this.fields[t]);else if("sum"===this.pieChart.aggr||"avg"===this.pieChart.aggr)for(var e=0;e<this.fields.length;e++)"Number"===this.fields[e].type&&this.pieChart.values.push(this.fields[e])},run:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("run",this.type),e=U(this.filter),console.log("filter",this.filter),console.log("query",e),"pie"!==this.type){t.next=14;break}return console.log("pie - pattern:",this.indexPattern,"esName",this.pieChart.option.key),t.next=8,V(this.indexPattern,this.pieChart.option.key,e);case 8:for(a=t.sent,i=[],n=[],s=0;s<a.length;s++)i.push(a[s].key),n.push({name:a[s].key,value:a[s].count});this.chartOptions=Gt(i,n),console.log(this.chartOptions);case 14:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),backToDashboard:function(){var t=this.dashboardId;this.$router.push({path:"/dashboard/edit/".concat(t)})},save:function(){var t=this,e={};e.id=this.visualizationId,e.dashboardId=this.dashboardId,e.name=this.name,e.type=this.type,e.filter=this.filter,e.indexPattern=this.indexPattern,"pie"===this.type&&(e.option=this.pieChart.option);var a=this.dashboardId;"0"!==this.visualizationId?f.a.put("ws/visualization",e).then(function(e){t.$router.push({path:"/dashboard/edit/".concat(a)})}):f.a.post("ws/visualization",e).then(function(e){t.$router.push({path:"/dashboard/edit/".concat(a)})})},addFilter:function(){for(var t={field:this.filterField,operator:this.filterOperator,value:this.filterValue},e=!1,a=0;a<this.filter.length;a++)if(JSON.stringify(t)===JSON.stringify(this.filter[a])){e=!0;break}e||(this.filter.push(t),this.filterField="",this.filterOperator="",this.filterValue="")},deleteFilter:function(t){this.filter.splice(t,1)}}},ge=fe,me=(a("ea43"),Object(l["a"])(ge,pe,ve,!1,null,null,null));me.options.__file="EditVisualization.vue";var be=me.exports;i["a"].use(u["a"]);var ye=new u["a"]({routes:[{path:"/",component:y},{path:"/system",component:y},{path:"/dashboard",component:Nt},{path:"/dashboard/edit/:id",component:re},{path:"/dashboard/view/:id",component:he},{path:"/dashboard/:dashboardId/visualization/:visualizationId",component:be},{path:"/index",component:D},{path:"/index/edit/:id",component:K},{path:"/index/explore/:id",component:St}]}),_e=a("9ca8");a("c037"),a("ef97"),a("94b1"),a("007d"),a("d28f"),a("1f68");i["a"].component("v-chart",_e["a"]),i["a"].config.productionTip=!1,f.a.interceptors.response.use(function(t){return t},function(t){return Promise.reject(t)}),new i["a"]({router:ye,render:function(t){return t(d)}}).$mount("#app")},"59d5":function(t,e,a){},"756c":function(t,e,a){"use strict";var i=a("a0e0"),n=a.n(i);n.a},8008:function(t,e,a){},"8c45":function(t,e,a){},9229:function(t,e,a){},"94e1":function(t,e,a){},"9d0b":function(t,e,a){},a0e0:function(t,e,a){},ab50:function(t,e,a){"use strict";var i=a("8008"),n=a.n(i);n.a},b313:function(t,e,a){},b401:function(t,e,a){"use strict";var i=a("ca54"),n=a.n(i);n.a},c21b:function(t,e,a){},c639:function(t,e,a){},ca54:function(t,e,a){},ce55:function(t,e,a){},d523:function(t,e,a){"use strict";var i=a("9229"),n=a.n(i);n.a},d615:function(t,e,a){"use strict";var i=a("9d0b"),n=a.n(i);n.a},e09e:function(t,e,a){"use strict";var i=a("2855"),n=a.n(i);n.a},ea43:function(t,e,a){"use strict";var i=a("ce55"),n=a.n(i);n.a},ea60:function(t,e,a){},efaf:function(t,e,a){"use strict";var i=a("59d5"),n=a.n(i);n.a}});
//# sourceMappingURL=app.8b1c78f1.js.map