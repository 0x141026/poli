(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e,t,a){},188:function(e,t,a){},313:function(e,t,a){e.exports=a(836)},340:function(e,t,a){},344:function(e,t,a){},345:function(e,t,a){},346:function(e,t,a){},509:function(e,t,a){},510:function(e,t,a){},820:function(e,t,a){},821:function(e,t,a){},822:function(e,t,a){},823:function(e,t,a){},831:function(e,t,a){},832:function(e,t,a){},833:function(e,t,a){},834:function(e,t,a){},835:function(e,t,a){},836:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(32),s=a.n(r),l=a(312),i=a(5),c=a(6),u=a(8),d=a(7),h=a(9),m=a(842),p=a(837),f=a(839),v=a(841),g=a(10),b=a.n(g),E=a(101),w=a(22),C=a(12),y=(a(340),a(16)),k=(a(187),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleKeyPress=function(e){13===e.keyCode&&a.login()},a.login=function(){var e=a.state,t=e.username,n=e.password,o={username:t,password:n};t?n?b.a.post("/auth/login/user",o).then(function(e){var t=e.data;t.error?a.setState({errorMsg:t.error}):a.props.onLoginSuccess(t)}):a.setState({errorMsg:"Enter password."}):a.setState({errorMsg:"Enter username."})},a.state={errorMsg:"",username:"",password:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=!1;this.props.sysRole&&(t=!0),t||b.a.post("/auth/login/cookie").then(function(t){var a=t.data;a.error||e.props.onLoginSuccess(a)})}},{key:"render",value:function(){return o.a.createElement("div",{className:"login-view"},o.a.createElement("div",{className:"login-panel"},o.a.createElement("div",{className:"login-app-title"},"Poli"),o.a.createElement("div",{className:"login-error-msg"},this.state.errorMsg),o.a.createElement("div",{className:"login-panel-body"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Username"),o.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange,onKeyDown:this.handleKeyPress}),o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange,onKeyDown:this.handleKeyPress}),o.a.createElement("button",{className:"button login-button",onClick:this.login},"Login")))))}}]),t}(o.a.Component)),O=Object(v.a)(k),j=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.changePassword=function(){var e=a.state,t=e.password,n=e.confirmedPassword;if(t&&n&&t===n){if(t.length<8)return void a.setState({errorMsg:"Use 8 or more characters."});var o={password:t};b.a.post("/auth/login/change-password",o).then(function(e){var t=e.data||{};t.error?a.setState({errorMsg:t.error}):a.props.history.push("/workspace/dashboard")})}else a.setState({errorMsg:"Those passwords didn't match."})},a.state={errorMsg:"",password:"",confirmedPassword:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return o.a.createElement("div",{className:"login-view"},o.a.createElement("div",{className:"login-panel"},o.a.createElement("div",{style:{fontSize:"22px",textAlign:"center",fontWeight:"bold",marginBottom:"15px"}},"Change password"),o.a.createElement("div",{className:"login-error-msg"},this.state.errorMsg),o.a.createElement("div",{className:"login-panel-body"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("div",{style:{fontWeight:"bold",marginBottom:"5px",fontSize:"15px"}},"* Use 8 or more characters"),o.a.createElement("label",null,"New password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.username,onChange:this.handleInputChange}),o.a.createElement("label",null,"Confirm password"),o.a.createElement("input",{type:"password",name:"confirmedPassword",value:this.state.confirmedPassword,onChange:this.handleInputChange}),o.a.createElement("button",{className:"button login-button",onClick:this.changePassword},"Confirm")))))}}]),t}(o.a.Component),N=Object(v.a)(j),D=a(838),S=a(46),x=a.n(S),P=a(74),I=function(){var e=Object(P.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("/ws/jdbcdatasource");case 3:return t=e.sent,e.abrupt("return",t.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),T=(a(344),function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.show,n=t.modalClass,r=void 0===n?"":n,s=t.title,l=t.children,i=a?"display-block":"display-none";return o.a.createElement("div",{className:"modal-overlay ".concat(i)},o.a.createElement("div",{className:"modal-panel ".concat(r)},o.a.createElement("div",{className:"model-header row"},o.a.createElement("div",{className:"model-title"},s),o.a.createElement("button",{className:"model-close-button icon-button",onClick:function(){return e.props.onClose()}},o.a.createElement(C.a,{icon:"times",size:"lg"}))),o.a.createElement("hr",null),o.a.createElement("div",{className:"modal-body"},l)))}}]),t}(o.a.Component)),M=a(21),W=(a(345),"#FF5630"),R=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).show=function(e,t){var n=a.state.timeoutId;n&&clearTimeout(n),a.setState({showToast:!0,message:e,backgroundColor:t,timeoutId:""},function(){var e=setTimeout(function(){a.hide()},3e3);a.setState({timeoutId:e})})},a.hide=function(){a.setState({showToast:!1,message:""})},a.state={showToast:!1,message:"",backgroundColor:W,timeoutId:""},t._toastRef=Object(M.a)(Object(M.a)(a)),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=this.state.timeoutId;e&&clearInterval(e)}},{key:"render",value:function(){var e=this.state,t=e.showToast,a=e.message,n=t?"display-block":"display-none",r={backgroundColor:e.backgroundColor};return o.a.createElement("div",{className:"toast-container ".concat(n),style:r},a)}}]),t}(o.a.Component);R.showSuccess=function(e){R._toastRef.show(e,"#36B37E")},R.showError=function(e){R._toastRef.show(e,W)};var U=R,V=(a(346),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){var t=a.props.name,n=e.target.value;a.props.onChange(t,n)},a.reset=function(){var e=a.props.name;a.props.onChange(e,"")},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.value,n=e.inputWidth,r={};return n&&(r.width=n+"px"),o.a.createElement("div",{className:"search-input-container"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"search-input-icon float-left"},o.a.createElement(C.a,{icon:"search",style:{margin:"10px"}})),o.a.createElement("div",{className:"float-left"},o.a.createElement("input",{type:"text",name:t,value:a,placeholder:"Search...",onChange:this.handleInputChange,className:"search-input-input",style:r})),o.a.createElement("button",{className:"button search-input-reset-button float-right",onClick:this.reset},o.a.createElement(C.a,{icon:"times",size:"lg"}))))}}]),t}(o.a.Component)),F=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleNameInputChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.save=function(){var e=a.state,t=e.showUpdatePassword,n=e.id,o=e.connectionUrl,r=e.driverClassName,s=e.username,l=e.password,i=e.name,c=e.ping;if(i){var u={connectionUrl:o,driverClassName:r,username:s,name:i,ping:c};null!==n?(u.id=n,t&&l&&(u.password=l),b.a.put("/ws/jdbcdatasource",u).then(function(e){a.closeEditPanel(),a.fetchDataSources()}).catch(function(e){U.showError("The name exists. Try another.")})):(u.password=l,b.a.post("/ws/jdbcdatasource",u).then(function(e){a.closeEditPanel(),a.fetchDataSources()}).catch(function(e){U.showError("The name exists. Try another.")}))}else U.showError("Enter a name.")},a.ping=function(e){b.a.get("/ws/jdbcdatasource/ping/".concat(e)).then(function(e){var t=e.data;"success"===t?U.showSuccess("Ping Succeeded"):U.showError(t)})},a.clearEditPanel=function(){a.setState(a.initialState)},a.openEditPanel=function(e){null!==e?a.setState({showUpdatePassword:!1,id:e.id,connectionUrl:e.connectionUrl,driverClassName:e.driverClassName,username:e.username,name:e.name,ping:e.ping}):a.clearEditPanel(),a.setState({showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.confirmDelete=function(){var e=a.state.objectToDelete,t=void 0===e?{}:e;b.a.delete("/ws/jdbcdatasource/"+t.id).then(function(e){a.fetchDataSources(),a.closeConfirmDeletionPanel()})},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.state={jdbcDataSources:[],showEditPanel:!1,showConfirmDeletionPanel:!1,objectToDelete:{},showUpdatePassword:!1,searchValue:"",id:null,name:"",connectionUrl:"",driverClassName:"",username:"",password:"",ping:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchDataSources()}},{key:"fetchDataSources",value:function(){var e=Object(P.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:t=e.sent,this.setState({jdbcDataSources:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){for(var e=this,t=this.state,a=t.showUpdatePassword,n=t.id,r=t.jdbcDataSources,s=void 0===r?[]:r,l=t.searchValue,i=t.showConfirmDeletionPanel,c=t.objectToDelete,u=void 0===c?{}:c,d=null===n?"New":"Edit",h=[],m=function(t){var a=s[t],n=a.name;(!l||l&&n.includes(l))&&h.push(o.a.createElement("div",{key:t,className:"card float-left"},o.a.createElement("div",{className:"card-header ellipsis"},n),o.a.createElement("div",{className:"card-content"}),o.a.createElement("div",{className:"card-footer row"},o.a.createElement("div",{className:"float-right"},o.a.createElement("button",{className:"icon-button card-icon-button",onClick:function(){return e.openEditPanel(a)}},o.a.createElement(C.a,{icon:"edit",size:"lg"})),o.a.createElement("button",{className:"icon-button card-icon-button",onClick:function(){return e.openConfirmDeletionPanel(a)}},o.a.createElement(C.a,{icon:"trash-alt",size:"lg"})),o.a.createElement("button",{className:"icon-button card-icon-button",onClick:function(){return e.ping(a.id)}},o.a.createElement(C.a,{icon:"plug",size:"lg"}))))))},p=0;p<s.length;p++)m(p);return o.a.createElement("div",{className:"full-page-content"},o.a.createElement("div",{class:"row"},o.a.createElement("div",{className:"float-left",style:{marginRight:"5px"}},o.a.createElement(V,{name:"searchValue",value:this.state.searchValue,onChange:this.handleNameInputChange,inputWidth:200})),o.a.createElement("button",{className:"button float-left",onClick:function(){return e.openEditPanel(null)}},o.a.createElement(C.a,{icon:"plus"})," New")),o.a.createElement("div",{className:"row mt-10"},h),o.a.createElement(T,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"small-modal-panel",title:d},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Name ",o.a.createElement("span",{className:"required"},"*")),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),o.a.createElement("label",null,"Connection Url"),o.a.createElement("textarea",{rows:"4",type:"text",name:"connectionUrl",value:this.state.connectionUrl,onChange:this.handleInputChange}),o.a.createElement("label",null,"Driver Class Name"),o.a.createElement("input",{type:"text",name:"driverClassName",value:this.state.driverClassName,onChange:this.handleInputChange}),o.a.createElement("label",null,"Username"),o.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange}),"Edit"===d&&o.a.createElement("div",{style:{margin:"3px 0px 8px 0px"}},o.a.createElement("button",{className:"button",onClick:this.toggleUpdatePassword},"Update password")),("New"===d||a)&&o.a.createElement("div",null,o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange})),o.a.createElement("label",null,"Ping"),o.a.createElement("input",{type:"text",name:"ping",value:this.state.ping,onChange:this.handleInputChange}),o.a.createElement("button",{className:"button mt-3",onClick:this.save},"Save"))),o.a.createElement(T,{show:i,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",u.name,"?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}},{key:"initialState",get:function(){return{showUpdatePassword:!1,id:null,name:"",connectionUrl:"",driverClassName:"",username:"",password:"",ping:""}}}]),t}(n.Component),L=(a(188),"chart"),B="filter",G=[L,B],z="slicer",A="single",q=[z,A],K="pie",Q="table",X=[Q,K],Y="admin",J="viewer",$=600,_=800,H=a(136),Z=a(25),ee=a(309),te=(a(509),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleClick=function(){a.setState(function(e){return{showPalette:!e.showPalette}})},a.handleChange=function(e){var t=a.props.name,n=e.rgb,o="rgba(".concat(n.r,", ").concat(n.g,", ").concat(n.b,", ").concat(n.a,")");a.props.onChange(t,o)},a.state={showPalette:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={width:"36px",height:"14px",borderRadius:"2px",background:this.props.value};return o.a.createElement("div",null,o.a.createElement("div",{className:"colorpicker-select",onClick:this.handleClick},o.a.createElement("div",{style:e})),this.state.showPalette&&o.a.createElement("div",{className:"colorpicker-popover"},o.a.createElement(ee.ChromePicker,{color:this.props.value,onChange:this.handleChange})))}}]),t}(o.a.Component)),ae=(a(510),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).toggle=function(){var e=a.props,t=e.name,n=e.checked;a.props.onChange(t,!n)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a={backgroundColor:e.checked?"#000000":"#FFFFFF"};return o.a.createElement("div",{className:"checkbox-container",onClick:this.toggle},o.a.createElement("div",{className:"checkbox-checkmark"},o.a.createElement("div",{className:"checkbox-checkmark-box",style:a})),o.a.createElement("div",{className:"checkbox-label"},t))}}]),t}(o.a.Component)),ne=a(137),oe=a.n(ne),re=function(e){var t;try{t=JSON.parse(e)}catch(a){t=[]}return t},se=function(e,t){var a=Math.abs(e-t)/1e3;if(a<=5)return"Just now";if(a>5&&a<60)return Math.floor(a)+" seconds ago";var n=Math.floor(a/60);if(1==n)return"1 minute ago";if(n>1&&n<60)return n+" minutes ago";var o=Math.floor(a/3600);return 1==o?"1 hour ago":o+" hours ago"},le=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],ie=function(e,t,a){for(var n=[],o=[],r=0;r<e.length;r++){var s=e[r];n.push(s[t]),o.push({name:s[t],value:s[a]})}return function(e,t){return{color:le,tooltip:{},legend:{type:"scroll",orient:"vertical",data:e,right:10,top:10,bottom:10},series:[{type:"pie",center:["50%","50%"],radius:"50%",data:t}]}}(n,o)};var ce=2,ue=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).parentNode,n=e.clientX-t.offsetLeft,o=e.clientY-t.offsetTop,r=t.ownerDocument;r.addEventListener("mouseup",a.onMouseUp),r.addEventListener("mousemove",a.onMouseMove),a.setState({xOffset:n,yOffset:o}),a.props.onMouseDown("drag")},a.onMouseUp=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a)));if(t){var n=t.ownerDocument;n.removeEventListener("mousedown",a.onMouseDown),n.removeEventListener("mouseup",a.onMouseUp),n.removeEventListener("mousemove",a.onMouseMove)}a.props.onMouseUp()},a.onMouseMove=function(e){if(e.preventDefault(),"drag"===a.props.mode){var t=1;a.props.snapToGrid&&(t=4);var n=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).parentNode,o=e.clientX-a.state.xOffset,r=e.clientY-a.state.yOffset,l=n.parentNode,i=l.clientWidth,c=l.clientHeight,u=parseInt(n.style.width,10)+2*ce,d=parseInt(n.style.height,10)+2*ce;o<0&&(o=0),r<0&&(r=0),o+u>i&&(o=i-u),r+d>c&&(r=c-d),o=Math.floor(o/t)*t,r=Math.floor(r/t)*t,n.style.left=o+"px",n.style.top=r+"px"}},a.state={xOffset:0,yOffset:0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){return o.a.createElement("div",{className:"grid-draggable",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},this.props.children)}}]),t}(o.a.Component),de=30,he=30,me=2,pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))),n=e.clientX,o=e.clientY,r=t.ownerDocument;r.addEventListener("mouseup",a.onMouseUp),r.addEventListener("mousemove",a.onMouseMove),a.setState({currentX:n,currentY:o}),a.props.onMouseDown("resize")},a.onMouseUp=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a)));if(t){var n=t.ownerDocument;n.removeEventListener("mousedown",a.onMouseDown),n.removeEventListener("mouseup",a.onMouseUp),n.removeEventListener("mousemove",a.onMouseMove)}a.props.onMouseUp()},a.onMouseMove=function(e){if(e.preventDefault(),"resize"===a.props.mode){var t=e.clientX-a.state.currentX,n=e.clientY-a.state.currentY,o=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).parentNode,r=parseInt(o.style.width,10),l=parseInt(o.style.height,10),i=o.parentNode,c=i.clientWidth,u=i.clientHeight,d=Math.floor(r+t),h=Math.floor(l+n);d<de&&(d=de),h<he&&(h=he);var m=o.offsetLeft+2*me,p=o.offsetTop+2*me;d+m>c&&(d=c-m),h+p>u&&(h=u-p),o.style.width=d+"px",o.style.height=h+"px",a.setState({currentX:e.clientX,currentY:e.clientY})}},a.state={currentX:0,currentY:0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){return o.a.createElement("div",{className:"grid-resizable",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},o.a.createElement(C.a,{icon:"compress",fixedWidth:!0}))}}]),t}(o.a.Component),fe=a(311),ve=(a(819),a(820),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleTdClick=function(e,t,n){a.props.onTableTdClick(e,t,n)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=void 0===a?[]:a,r=t.columns,s=void 0===r?[]:r,l=t.drillThrough,i=void 0===l?[]:l,c=t.error,u=[];return s.forEach(function(t){var a=t.name,n={Header:a,accessor:a};if(i.length>0){var r=i.findIndex(function(e){return e.columnName===a});if(-1!==r){var s=i[r].dashboardId;n.Cell=function(t){return o.a.createElement("span",{className:"link-label",onClick:function(){return e.handleTdClick(s,a,t.value)}},t.value)}}}u.push(n)}),c?o.a.createElement("div",null,c):0===n.length||0===s.length?o.a.createElement("div",null,"No data"):o.a.createElement(fe.a,{data:n,columns:u,defaultPageSize:10,previousText:"Prev",nextText:"Next"})}}]),t}(o.a.Component)),ge=(a(821),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).toggleSelectAll=function(){for(var e=!a.state.isSelectAll,t=Object(Z.a)(a.props.checkBoxes),n=0;n<t.length;n++)t[n].isChecked=e;a.setState(function(e){return{isSelectAll:!e.isSelectAll}}),a.props.onChange(a.props.id,t)},a.handleSearchValueChange=function(e){var t=e.target.value;a.setState({searchValue:t})},a.handleCheckBoxChange=function(e,t){var n=Object(Z.a)(a.props.checkBoxes),o=n.findIndex(function(t){return t.value===e});n[o].isChecked=t,a.props.onChange(a.props.id,n)},a.state={isSelectAll:!1,searchValue:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=this.props.checkBoxes,t=void 0===e?[]:e,a=this.state,n=a.searchValue,r=a.isSelectAll,s=[],l=0;l<t.length;l++){var i=t[l],c=i.value;(!n||n&&c.includes(n))&&s.push(o.a.createElement(ae,{key:l,name:i.value,value:i.value,checked:i.isChecked,onChange:this.handleCheckBoxChange}))}var u=r?"Deselect All":"Select All";return o.a.createElement("div",null,o.a.createElement("button",{className:"button",style:{marginBottom:"5px"},onClick:this.toggleSelectAll},u),o.a.createElement("input",{type:"text",name:"name",value:this.state.searchValue,onChange:this.handleSearchValueChange,placeholder:"Search..."}),o.a.createElement("div",{className:"slicer-body"},s))}}]),t}(o.a.Component)),be=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){a.setState({mode:e})},a.onMouseUp=function(){a.setState({mode:""});var e=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))),t=e.offsetLeft,n=e.offsetTop,o=parseInt(e.style.width,10),r=parseInt(e.style.height,10),l={id:a.props.id,x:t,y:n,width:o,height:r};a.props.onWidgetMove(l)},a.onMouseMove=function(e,t,a){e.preventDefault()},a.editWidget=function(e){a.props.onWidgetEdit(e)},a.exportCsv=function(e){},a.exportJson=function(e){},a.removeWidget=function(e){a.props.onWidgetRemove(e)},a.onTableTdPropsChange=function(e,t,a,n){return{onClick:function(e,o){console.log("A Td Element was clicked!"),console.log("it produced this event:",e),console.log("It was in this column:",a),console.log("It was in this row:",t),console.log("It was in this table instance:",n);var r=a.Header,s=t.row[r],l=n.props.widgetDrillThrough||[];console.log("onTableTdPropsChange",r,s,l);var i=l.findIndex(function(e){return e.columnName===r});if(-1!==i)l[i].dashboardId}}},a.onChartClick=function(e,t){console.log("onChartClick",e,t)},a.onChartLegendselectchanged=function(e,t){console.log("onChartLegendselectchanged",e,t)},a.onTableTdClick=function(e,t,n){var o={type:"tableTdClick",data:{dashboardId:e,columnName:t,columnValue:n}};a.props.onWidgetContentClick(o)},a.onSlicerChange=function(e,t){var n={checkBoxes:t};a.props.onWidgetFilterInputChange(e,n)},a.onSingleValueChange=function(e,t){var n={value:t.target.value};a.props.onWidgetFilterInputChange(e,n)},a.renderWidgetContent=function(){var e={click:a.onChartClick,legendselectchanged:a.onChartLegendselectchanged},t=a.props,n=t.id,r=t.type,s=t.chartType,l=t.filterType,i=t.queryResult,c=void 0===i?{}:i,u=t.drillThrough,d=t.data,h=void 0===d?{}:d,m=t.checkBoxes,p=t.value,f=re(c.data),v=c.columns||[],g=c.error,b=o.a.createElement("div",null);if(r===L){if(s===Q)b=o.a.createElement(ve,{data:f,columns:v,error:g,drillThrough:u,onTableTdClick:a.onTableTdClick});else if(s===K){var E=h.pieKey,w=h.pieValue,C=ie(f,E,w);b=o.a.createElement(oe.a,{option:C,className:"echarts",onEvents:e})}}else r===B&&(l===z?b=o.a.createElement("div",{className:"grid-box-content-panel"},o.a.createElement(ge,{id:n,checkBoxes:m,onChange:a.onSlicerChange})):l===A&&(b=o.a.createElement("div",{className:"grid-box-content-panel"},o.a.createElement("input",{type:"text",value:p,onChange:function(e){return a.onSingleValueChange(n,e)}}))));return b},a.state={mode:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.id,r=a.title,s=a.isEditMode,l=a.style,i=void 0===l?{}:l,c=a.drillThrough,u=i.showBorder,d=void 0!==u&&u,h=i.showTitle,m=void 0===h||h,p=i.borderColor,f=i.titleFontColor,v=i.titleBackgroundColor,g=i.contentBackgroundColor,b=i.zIndex,E=d?"2px solid ".concat(p):"2px solid transparent",w={left:this.props.x+"px",top:this.props.y+"px",width:this.props.width+"px",height:this.props.height+"px",zIndex:b,border:E},y=(e=c,!Array.isArray(e)||e.length,{color:f,backgroundColor:v}),k={backgroundColor:g};return o.a.createElement("div",{className:"grid-box",style:w},s&&o.a.createElement(ue,{onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,mode:this.state.mode,snapToGrid:this.props.snapToGrid},m&&o.a.createElement("div",{className:"grid-box-title",style:y},o.a.createElement("div",{className:"grid-box-title-value ellipsis",style:{marginRight:"50px"}},r))),!s&&m&&o.a.createElement("div",{className:"grid-box-title",style:y},o.a.createElement("div",{className:"grid-box-title-value ellipsis"},r)),s&&o.a.createElement("div",{className:"grid-edit-panel"},o.a.createElement("div",{className:"grid-box-icon inline-block",onClick:function(){return t.editWidget(n)}},o.a.createElement(C.a,{icon:"edit",fixedWidth:!0})),o.a.createElement("div",{className:"grid-box-icon inline-block",onClick:function(){return t.removeWidget(n)}},o.a.createElement(C.a,{icon:"trash-alt",fixedWidth:!0}))),o.a.createElement("div",{className:"grid-box-content",style:k},this.renderWidgetContent()),s&&o.a.createElement(pe,{onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,mode:this.state.mode}))}}]),t}(o.a.Component),Ee=(a(822),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.width,n=t.height,r=t.backgroundColor,s=t.widgets,l=void 0===s?[]:s,i={width:a+"px",height:n+"px",backgroundColor:r};t.showGridlines&&(i.backgroundSize="15px 15px",i.backgroundImage="radial-gradient(rgb(63, 93, 131) 10%, transparent 10%)");var c=l.map(function(t,a){return o.a.createElement(be,Object.assign({key:a,snapToGrid:e.props.snapToGrid,isEditMode:e.props.isEditMode},t,{onWidgetMove:e.props.onWidgetMove,onWidgetEdit:e.props.onWidgetEdit,onWidgetRemove:e.props.onWidgetRemove,onWidgetFilterInputChange:e.props.onWidgetFilterInputChange,onWidgetContentClick:e.props.onWidgetContentClick}))});return o.a.createElement("div",{className:"grid-layout",style:i},c)}}]),t}(o.a.Component)),we=(a(823),1200),Ce=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).resizeGrid=function(e){var t=a.state.widgets,n=Object(Z.a)(t),o=e-10,r=a.props,s=r.isFixedWidth,l=r.fixedWidth;s&&(o=l),a.resizeWidgetsToActual(n,o),a.setState({widgets:n,gridWidth:o})},a.resizeWidgetsToBase=function(e,t){for(var n=0;n<e.length;n++){var o=a.scaleToBase(e[n].x,t),r=a.scaleToBase(e[n].width,t);e[n].x=o,e[n].width=r}},a.resizeWidgetsToActual=function(e,t){for(var n=0;n<e.length;n++){var o=a.scaleToActual(e[n].x,t),r=a.scaleToActual(e[n].width,t);e[n].x=o,e[n].width=r}},a.scaleToActual=function(e,t){return e*t/we/100},a.scaleToBase=function(e,t){return 100*Number.parseFloat(e*we/t).toFixed(2)},a.fetchWidgets=function(e,t){null!==e&&b.a.get("/ws/widget/dashboard/".concat(e)).then(function(e){var n=e.data;a.setState({widgets:n},function(){a.resizeGrid(t),a.queryFilters(),a.queryCharts()})})},a.handleCheckBoxChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.saveWidgets=function(){var e=JSON.parse(JSON.stringify(a.state.widgets)),t=a.state.gridWidth;a.resizeWidgetsToBase(e,t),b.a.post("/ws/widget/position",e).then(function(e){})},a.onWidgetMove=function(e){var t=a.state.widgets,n=t.findIndex(function(t){return t.id===e.id}),o=Object(Z.a)(t);o[n].x=e.x,o[n].y=e.y,o[n].width=e.width,o[n].height=e.height,a.setState({widgets:o},function(){a.saveWidgets()})},a.confirmDelete=function(){var e=a.state.objectToDelete;b.a.delete("/ws/widget/".concat(e)).then(function(t){var n=a.state.widgets,o=n.findIndex(function(t){return t.id===e}),r=Object(Z.a)(n);r.splice(o,1),a.setState({widgets:r}),a.closeConfirmDeletionPanel()})},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.onWidgetFilterInputChange=function(e,t){var n=a.state.widgets,o=void 0===n?[]:n,r=o.findIndex(function(t){return t.id===e}),s=Object(Z.a)(o),l=o[r];if(l.filterType===z){var i=t.checkBoxes;s[r].checkBoxes=i}else if(l.filterType===A){var c=t.value;s[r].value=c}a.setState({widgets:s})},a.getFilterParams=function(){for(var e=a.state.widgets,t=void 0===e?[]:e,n=[],o=0;o<t.length;o++){var r=t[o];if(r.type===B){var s=r.filterType,l={};if(s===z){for(var i=r.checkBoxes,c=void 0===i?[]:i,u=[],d=0;d<c.length;d++){var h=c[d];h.isChecked&&u.push(h.value)}l.value=u,u.length===c.length&&(l.remark="select all")}else s===A&&(l.value=r.value);l.param=r.data.queryParameter,l.type=r.filterType,n.push(l)}}return n},a.handleSavedWidget=function(e){b.a.get("/ws/widget/".concat(e)).then(function(e){var t=e.data,n=a.state,o=n.widgets,r=n.gridWidth,s=o.findIndex(function(e){return e.id===t.id}),l=Object(Z.a)(o);t.x=a.scaleToActual(t.x,r),t.width=a.scaleToActual(t.width,r),-1===s?l.push(t):l[s]=t,a.setState({widgets:l},function(){var e=a.getFilterParams(),n=t.id;t.type===L&&a.queryChart(n,e)})})},a.state={widgets:[],gridWidth:1200,snapToGrid:!1,showGridlines:!1,showConfirmDeletionPanel:!1,objectToDelete:{}},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){console.log("WidgetViewPanel componentDidMount")}},{key:"queryCharts",value:function(){for(var e=this.getFilterParams(),t=this.state.widgets,a=0;a<t.length;a++){var n=t[a],o=n.id;n.type===L&&this.queryChart(o,e)}}},{key:"queryFilters",value:function(){for(var e=this.state.widgets,t=0;t<e.length;t++){var a=e[t],n=a.id,o=a.type,r=a.filterType;o===B&&this.queryFilter(n,r)}}},{key:"queryChart",value:function(e,t){var a=this,n=null===t?[]:t,o=this.state.widgets;b.a.post("/ws/jdbcquery/widget/".concat(e),n).then(function(e){var t=e.data,n=o.findIndex(function(e){return e.id===t.id}),r=Object(Z.a)(o);r[n].queryResult=t,a.setState({widgets:r})})}},{key:"queryFilter",value:function(e,t){var a=this,n=this.state.widgets;if(t===z)b.a.post("/ws/jdbcquery/widget/".concat(e),[]).then(function(e){for(var t=e.data,o=re(t.data),r=[],s=0;s<o.length;s++)for(var l=Object.values(o[s]),i=0;i<l.length;i++){var c=l[i];r.push({value:c,isChecked:!1})}var u=n.findIndex(function(e){return e.id===t.id}),d=Object(Z.a)(n);d[u].queryResult=t,d[u].checkBoxes=r,a.setState({widgets:d})});else if(t===A){var o=n.findIndex(function(t){return t.id===e}),r=Object(Z.a)(n);r[o].value="",this.setState({widgets:r})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.widgetViewWidth,n=t.isEditMode,r={top:t.showControl?"50px":"10px",width:a+"px"};return o.a.createElement("div",{className:"dashboard-content-widget-panel",style:r},n&&o.a.createElement("div",{className:"dashboard-attribute-edit-panel"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Height"),o.a.createElement("input",{type:"text",name:"height",value:this.props.height,onChange:function(t){return e.props.onStyleValueChange("height",t.target.value)}}),o.a.createElement(ae,{name:"isFixedWidth",value:"Fixed width",checked:this.props.isFixedWidth,onChange:this.props.onStyleValueChange}),this.props.isFixedWidth&&o.a.createElement("div",null,o.a.createElement("label",null,"Fixed Width"),o.a.createElement("input",{type:"text",name:"fixedWidth",value:this.props.fixedWidth,onChange:function(t){return e.props.onStyleValueChange("fixedWidth",t.target.value)}})),o.a.createElement("label",null,"Background Color"),o.a.createElement(te,{name:"backgroundColor",value:this.props.backgroundColor,onChange:this.props.onStyleValueChange}),o.a.createElement(ae,{name:"snapToGrid",value:"Snap to grid",checked:this.state.snapToGrid,onChange:this.handleCheckBoxChange}),o.a.createElement(ae,{name:"showGridlines",value:"Show gridlines",checked:this.state.showGridlines,onChange:this.handleCheckBoxChange}))),o.a.createElement(Ee,{width:this.state.gridWidth,height:this.props.height,backgroundColor:this.props.backgroundColor,snapToGrid:this.state.snapToGrid,showGridlines:this.state.showGridlines,widgets:this.state.widgets,isEditMode:this.props.isEditMode,onWidgetMove:this.onWidgetMove,onWidgetEdit:this.props.onWidgetEdit,onWidgetRemove:this.openConfirmDeletionPanel,onWidgetFilterInputChange:this.onWidgetFilterInputChange,onWidgetContentClick:this.props.onWidgetContentClick}),o.a.createElement(T,{show:this.state.showConfirmDeletionPanel,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete this widget?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}}]),t}(o.a.Component),ye=a(310),ke=a.n(ye),Oe=(a(829),a(830),a(831),a(832),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleTabClick=function(e){a.setState({activeTab:e})},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.activeTab;this.setState({activeTab:e})}},{key:"render",value:function(){for(var e=this,t=this.props.children,a=this.state.activeTab,n=[],r=null,s=0;s<t.length;s++)t[s]&&function(){var l=t[s].props.title,i="";l===a&&(i="tab-header-active",r=t[s].props.children),n.push(o.a.createElement("li",{className:"tab-header-item ".concat(i),key:s,onClick:function(){return e.handleTabClick(l)}},l))}();return o.a.createElement("div",{className:"tab-container"},o.a.createElement("ul",{className:"tab-header"},n),o.a.createElement("div",{className:"tab-content"},r))}}]),t}(o.a.Component)),je=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleOptionChange=function(e){var t=a.props.name,n=e.target.value;a.props.onChange(t,n)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.options,n=void 0===a?[]:a,r=e.optionValue,s=e.optionDisplay,l=e.preloadOneEmpty,i=[];return(void 0===l||l)&&i.push(o.a.createElement("option",{value:"",key:""})),n.forEach(function(e,t){var a,n;r&&s?(a=e[r],n=e[s]):(a=e,n=e),i.push(o.a.createElement("option",{value:a,key:t},n))}),o.a.createElement("select",{value:t,onChange:this.handleOptionChange},i)}}]),t}(o.a.Component),Ne=(a(833),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).clickButton=function(e){var t=a.props.name;a.props.onChange(t,e)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=this,t=this.props,a=t.value,n=t.selections,r=void 0===n?[]:n,s=[],l=function(t){var n=r[t],l=n===a?"select-button-active":"";s.push(o.a.createElement("div",{className:"select-button ".concat(l),onClick:function(){return e.clickButton(n)},key:n},n))},i=0;i<r.length;i++)l(i);return o.a.createElement("div",{className:"selectbuttons-container"},s)}}]),t}(o.a.Component)),De=(a(834),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){var t=a.props.name,n=Number(e.target.value);a.props.onChange(t,n)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.min,n=e.max,r=e.value,s=e.step;return o.a.createElement("div",{className:"input-range-container"},o.a.createElement("div",null,o.a.createElement("span",{className:"input-range-value"},r)),o.a.createElement("input",{type:"range",name:t,min:a,max:n,value:r,onChange:this.handleInputChange,step:s,className:"input-range"}))}}]),t}(o.a.Component)),Se=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchWidget=function(){var e=Object(P.a)(x.a.mark(function e(t){var n;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState(a.initialState),e.next=3,I();case 3:n=e.sent,a.setState({jdbcDataSources:n}),b.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({drillDashboards:t})}),null===t?a.setState({widgetId:null}):(a.setState({widgetId:t}),b.a.get("/ws/widget/"+t).then(function(e){var n=e.data,o=n.type,r=n.chartType,s=n.filterType,l=n.drillThrough;if(o===L){if(a.setState({chartType:r,drillThrough:l}),r===K){var i=n.data,c=i.pieKey,u=i.pieValue;a.setState({pieKey:c,pieValue:u})}}else if(o===B){var d=n.data.queryParameter;a.setState({filterType:s,queryParameter:d})}a.setState({widgetId:t,title:n.title,x:n.x,y:n.y,width:n.width,height:n.height,sqlQuery:n.sqlQuery,type:o,jdbcDataSourceId:n.jdbcDataSourceId,style:n.style},function(){a.runQuery()})}));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.onStyleValueChange=function(e,t){var n=Object(H.a)({},a.state.style);n[[e]]=t,a.setState({style:n})},a.handleAceEditorChange=function(e){a.setState({sqlQuery:e})},a.handleIntegerOptionChange=function(e,t){var n=parseInt(t,10)||0;a.setState(Object(y.a)({},e,n))},a.handleOptionChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.save=function(){var e=a.state,t=e.widgetId,n=e.title,o=e.jdbcDataSourceId,r=e.sqlQuery,s=e.type,l=e.style,i={title:n,dashboardId:a.props.dashboardId,type:s,jdbcDataSourceId:o,sqlQuery:r,style:l};if(s===L){var c=a.state,u=c.chartType,d=c.drillThrough;if(i.drillThrough=d,i.chartType=u,u===Q);else if(u===K){var h=a.state,m=h.pieKey,p=h.pieValue;i.data={pieKey:m,pieValue:p}}}else if(s===B){var f=a.state,v=f.filterType,g=f.queryParameter;i.filterType=v,i.data={queryParameter:g}}null===t?(i.style={showBorder:!1,borderColor:"rgba(9, 30, 66, 1)",showTitle:!0,titleFontColor:"rgba(9, 30, 66, 1)",titleBackgroundColor:"rgba(255, 255, 255, 1)",contentBackgroundColor:"rgba(255, 255, 255, 1)",zIndex:50},i.x=0,i.y=0,i.width=2e4,i.height=200,b.a.post("/ws/widget",i).then(function(e){var t=e.data;a.props.onSave(t)})):(i.id=t,b.a.put("/ws/widget",i).then(function(e){a.props.onSave(t)}))},a.runQuery=function(){var e={jdbcDataSourceId:a.state.jdbcDataSourceId,sqlQuery:a.state.sqlQuery};b.a.post("/ws/jdbcquery/query",e).then(function(e){var t=e.data;a.setState({queryResult:t})})},a.addDrillThrough=function(){var e=a.state,t=e.drillThrough,n=e.drillColumnName,o=e.drillDashboardId;if(-1===t.findIndex(function(e){return e.columnName===n})){var r=Object(Z.a)(t);r.push({columnName:n,dashboardId:o}),a.setState({drillThrough:r})}},a.removeDrillThrough=function(e){var t=a.state.drillThrough,n=t.findIndex(function(t){return t.columnName===e.columnName&&t.dashboardId===e.dashboardId});if(-1!==n){var o=Object(Z.a)(t);o.splice(n,1),a.setState({drillThrough:o})}},a.generateChart=function(){if(a.state.chartType===K){var e=a.state,t=e.pieKey,n=e.pieValue,o=e.queryResult,r=re((void 0===o?{}:o).data),s=ie(r,t,n);a.setState({chartOption:s})}},a.renderChartPreview=function(){var e=a.state,t=e.chartType,n=e.queryResult,r=(void 0===n?{}:n).columns||[],s=o.a.createElement("div",null,"NOT SUPPORTED");if(t===Q);else if(t===K){var l=a.state,i=l.chartOption,c=l.pieKey,u=l.pieValue;s=o.a.createElement("div",null,o.a.createElement("div",null,'For example, count "value" by "key"'),o.a.createElement("label",null,"Key (text)"),o.a.createElement(je,{name:"pieKey",value:c,onChange:a.handleOptionChange,options:r,optionDisplay:"name",optionValue:"name"}),o.a.createElement("label",null,"Value (number)"),o.a.createElement(je,{name:"pieValue",value:u,onChange:a.handleOptionChange,options:r,optionDisplay:"name",optionValue:"name"}),o.a.createElement("button",{className:"button",onClick:a.generateChart},"Generete Chart"),o.a.createElement(oe.a,{option:i,style:{height:"350px",width:"100%"},className:"react_for_echarts"}))}return s},a.state=a.initialState,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.type,n=t.queryResult,r=t.jdbcDataSources,s=void 0===r?[]:r,l=t.drillThrough,i=void 0===l?[]:l,c=t.drillDashboards,u=void 0===c?[]:c,d=re(n.data),h=n.columns||[],m=n.error,p=i.map(function(t){return o.a.createElement("div",{key:t.columnName,className:"row table-row"},o.a.createElement("div",{className:"float-left ellipsis"},"Column: ",t.columnName,", Dashboard: ",t.dashboardId),o.a.createElement("button",{className:"button table-row-button float-right",onClick:function(){return e.removeDrillThrough(t)}},o.a.createElement(C.a,{icon:"trash-alt"})))}),f=h.map(function(e){return o.a.createElement("div",{className:"table-row row",key:e.name},o.a.createElement("div",{className:"float-left"},e.name),o.a.createElement("div",{className:"float-right"},e.dataType))}),v=a===L||a===B&&this.state.filterType===z;return o.a.createElement("div",null,o.a.createElement("button",{className:"button",style:{width:"80px"},onClick:this.save},"Save"),o.a.createElement("div",{className:"mt-10"},o.a.createElement(Ne,{name:"type",value:a,onChange:this.handleOptionChange,selections:G})),o.a.createElement("div",{className:"mt-10"},o.a.createElement(Oe,{activeTab:"Basic"},o.a.createElement("div",{title:"Basic"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Title"),o.a.createElement("input",{type:"text",name:"title",value:this.state.title,onChange:this.handleInputChange}),o.a.createElement("hr",null),o.a.createElement("label",null,"Z Index"),o.a.createElement("input",{type:"number",name:"zIndex",value:this.state.style.zIndex,onChange:function(t){return e.onStyleValueChange("zIndex",t.target.value)}}),o.a.createElement(De,{name:"zIndex",value:this.state.style.zIndex,onChange:this.onStyleValueChange,min:1,max:50,step:1}),o.a.createElement("hr",null),o.a.createElement(ae,{name:"showBorder",value:"Show border",checked:this.state.style.showBorder,onChange:this.onStyleValueChange}),this.state.style.showBorder&&o.a.createElement("div",null,o.a.createElement("label",null,"Border Color"),o.a.createElement(te,{name:"borderColor",value:this.state.style.borderColor,onChange:this.onStyleValueChange})),o.a.createElement("hr",null),o.a.createElement(ae,{name:"showTitle",value:"Show title",checked:this.state.style.showTitle,onChange:this.onStyleValueChange}),this.state.style.showTitle&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement("label",null,"Title Font Color"),o.a.createElement(te,{name:"titleFontColor",value:this.state.style.titleFontColor,onChange:this.onStyleValueChange})),o.a.createElement("div",null,o.a.createElement("label",null,"Title Background Color"),o.a.createElement(te,{name:"titleBackgroundColor",value:this.state.style.titleBackgroundColor,onChange:this.onStyleValueChange}))),o.a.createElement("hr",null),o.a.createElement("div",null,o.a.createElement("label",null,"Content Background Color"),o.a.createElement(te,{name:"contentBackgroundColor",value:this.state.style.contentBackgroundColor,onChange:this.onStyleValueChange})))),a===B&&o.a.createElement("div",{title:"Filter"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Filter Options"),o.a.createElement(je,{name:"filterType",value:this.state.filterType,onChange:this.handleOptionChange,options:q,preloadOneEmpty:!1}))),v&&o.a.createElement("div",{title:"Query"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"DataSource"),o.a.createElement(je,{name:"jdbcDataSourceId",value:this.state.jdbcDataSourceId,onChange:this.handleIntegerOptionChange,options:s,optionDisplay:"name",optionValue:"id"}),o.a.createElement("label",null,"SQL Query"),o.a.createElement(ke.a,{value:this.state.sqlQuery,mode:"mysql",theme:"xcode",name:"blah2",onChange:this.handleAceEditorChange,height:"300px",width:"100%",fontSize:15,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!0,setOptions:{showLineNumbers:!0,tabSize:2}}),o.a.createElement("div",{style:{margin:"5px 0px 8px 0px"}},o.a.createElement("button",{className:"button",onClick:this.runQuery},"Run Query")),o.a.createElement("label",null,"Result"),o.a.createElement(ve,{data:d,columns:h,error:m}),o.a.createElement("label",{style:{marginTop:"8px"}},"Columns Mapping"),o.a.createElement("div",null,f))),a===L&&o.a.createElement("div",{title:"Chart"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Chart Type"),o.a.createElement(je,{name:"chartType",value:this.state.chartType,onChange:this.handleOptionChange,options:X,preloadOneEmpty:!1}),o.a.createElement("label",null,"Preview"),this.renderChartPreview())),a===L&&o.a.createElement("div",{title:"Drill Through"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Column"),o.a.createElement(je,{name:"drillColumnName",value:this.state.drillColumnName,options:h,onChange:this.handleOptionChange,optionDisplay:"name",optionValue:"name"}),o.a.createElement("label",null,"Dashboard"),o.a.createElement(je,{name:"drillDashboardId",value:this.state.drillDashboardId,options:u,onChange:this.handleIntegerOptionChange,optionDisplay:"name",optionValue:"id"}),o.a.createElement("button",{className:"button",onClick:this.addDrillThrough},"Add"),o.a.createElement("div",{style:{marginTop:"8px"}},p))),a===B&&o.a.createElement("div",{title:"Query parameter"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Parameter"),o.a.createElement("input",{type:"text",name:"queryParameter",value:this.state.queryParameter,onChange:this.handleInputChange}))))))}},{key:"initialState",get:function(){return{jdbcDataSources:[],widgetId:null,title:"",sqlQuery:"",jdbcDataSourceId:"",queryResult:{},type:L,filterType:A,chartType:Q,style:{showBorder:!1,borderColor:"rgba(9, 30, 66, 1)",showTitle:!0,titleFontColor:"rgba(9, 30, 66, 1)",titleBackgroundColor:"rgba(255, 255, 255, 1)",contentBackgroundColor:"rgba(255, 255, 255, 1)",zIndex:50},queryParameter:"",drillThrough:[],drillDashboards:[],drillColumnName:"",drillDashboardId:"",pieKey:"",pieValue:"",chartOption:{}}}}]),t}(o.a.Component),xe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).loadViewByDashboardName=function(){var e=a.props.match.params.name,t=a.props.location.search,n=new URLSearchParams(t),o=n.get("$showControl");o=null==o||!!o;var r=n.get("$fromDashboard"),s=a.getPageWidth();a.setState({isFullScreenView:!0,name:e,widgetViewWidth:s,fromDashboard:r,showControl:o},function(){b.a.get("/ws/dashboard/name/".concat(e)).then(function(e){var t=e.data;a.setState({dashboardId:t.id,name:t.name,style:t.style},function(){a.refresh()})})})},a.handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.getPageWidth=function(){return s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).clientWidth-40},a.toggleAutoRefresh=function(){var e=a.state.autoRefreshTimerId;if(e)clearInterval(e),a.setState({autoRefreshTimerId:""});else{var t=a.state.refreshInterval,n=parseInt(t,10)||15;n=n<1?1:n;var o=setInterval(function(){a.applyFilters()},1e3*n);a.setState({autoRefreshTimerId:o})}},a.refresh=function(){a.refreshWidgetView(),a.updateLastRefreshed()},a.refreshWidgetView=function(){var e=a.state,t=e.dashboardId,n=e.widgetViewWidth;a.widgetViewPanel.current.fetchWidgets(t,n,null)},a.updateLastRefreshed=function(){var e=new Date;a.setState({lastRefreshed:e},function(){a.updateReadableLastRefreshed()})},a.updateReadableLastRefreshed=function(){var e=a.state.lastRefreshed;if(e instanceof Date){var t=se(e,new Date);a.setState({readableLastRefreshed:t})}},a.save=function(){var e=a.state,t=e.dashboardId,n=e.name,o=e.style,r={id:t,name:n,style:o};b.a.put("/ws/dashboard/",r).then(function(e){a.props.onDashboardSave(t),a.setState({isEditMode:!1})})},a.edit=function(){a.setState({isEditMode:!0})},a.cancelEdit=function(){a.setState({isEditMode:!1})},a.onWidgetSave=function(e){a.setState({showWidgetEditPanel:!1}),a.widgetViewPanel.current.handleSavedWidget(e)},a.openWidgetEditPanel=function(e){a.widgetEditPanel.current.fetchWidget(e),a.setState({showWidgetEditPanel:!0})},a.applyFilters=function(){a.widgetViewPanel.current.queryCharts(),a.updateLastRefreshed()},a.fullScreen=function(){var e=a.state.name,t="/workspace/dashboard/full/".concat(e);window.open(t,"_blank")},a.onStyleValueChange=function(e,t){var n=Object(H.a)({},a.state.style);n[[e]]=t,a.setState({style:n},function(){"isFixedWidth"!==e&&"fixedWidth"!==e||a.refreshWidgetView()})},a.onWidgetContentClick=function(e){var t=a.state,n=t.name,o=t.isFullScreenView,r=e.type,s=e.data;if("tableTdClick"===r){var l=s.dashboardId,i=s.columnName,c=s.columnValue;if(o)b.a.get("/ws/dashboard/".concat(l)).then(function(e){var t=e.data.name,o="/workspace/dashboard/full/".concat(t,"?$fromDashboard=").concat(n,"&").concat(i,"=").concat(c);a.props.history.push(o)});else{var u="/workspace/dashboard/".concat(l,"?$fromDashboard=").concat(n,"&").concat(i,"=").concat(c);a.props.history.push(u)}}},a.goBackToFromDashboard=function(){a.props.history.goBack()},a.confirmDelete=function(){var e=a.state.objectToDelete,t=(void 0===e?{}:e).id;b.a.delete("/ws/dashboard/".concat(t)).then(function(e){a.props.onDashboardDelete(t),a.closeConfirmDeletionPanel()})},a.deleteDashboard=function(){var e=a.state,t={id:e.dashboardId,name:e.name};a.openConfirmDeletionPanel(t)},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.state={showWidgetEditPanel:!1,showConfirmDeletionPanel:!1,showControl:!0,objectToDelete:{},isEditMode:!1,isFullScreenView:!1,autoRefreshTimerId:"",lastRefreshed:"",refreshInterval:15,lastRefreshLabelTimerId:"",jdbcDataSourceOptions:[],fromDashboard:"",dashboardId:0,name:"",style:{},widgetViewWidth:1e3},a.widgetViewPanel=o.a.createRef(),a.widgetEditPanel=o.a.createRef(),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;if(void 0===t&&void 0!==this.props.match.params.name)return void this.loadViewByDashboardName();var a=void 0!==t?t:null;console.log("DashboardEditView - componentDidMount",a);var n=this.props.location.search,o=new URLSearchParams(n).get("$fromDashboard"),r=this.getPageWidth();this.setState({widgetViewWidth:r,fromDashboard:o},function(){null===a?e.setState({dashboardId:null}):b.a.get("/ws/dashboard/".concat(a)).then(function(t){var a=t.data;e.setState({dashboardId:a.id,name:a.name,style:a.style},function(){e.refresh()})})});var s=setInterval(function(){e.updateReadableLastRefreshed()},5e3);this.setState({lastRefreshLabelTimerId:s})}},{key:"componentWillUnmount",value:function(){var e=this.state,t=e.autoRefreshTimerId,a=e.lastRefreshLabelTimerId;t&&clearInterval(t),a&&clearInterval(a)}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.autoRefreshTimerId,r=a.readableLastRefreshed,s=a.isEditMode,l=a.isFullScreenView,i=a.fromDashboard,c=a.showControl,u=""===n?"OFF":"ON",d=null,h=o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"inline-block"},o.a.createElement("div",{className:"inline-block",style:{marginRight:"8px"}},"Last refreshed: ",r),"OFF"===u&&o.a.createElement("input",{type:"text",name:"refreshInterval",value:this.state.refreshInterval,onChange:this.handleInputChange,className:"inline-block",style:{width:"50px"}})),o.a.createElement("button",{className:"button square-button mr-3",onClick:this.toggleAutoRefresh},"ON"===u?o.a.createElement(C.a,{icon:"stop-circle",size:"lg",fixedWidth:!0}):o.a.createElement(C.a,{icon:"play-circle",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button square-button mr-3",onClick:this.refresh},o.a.createElement(C.a,{icon:"redo-alt",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button mr-3",onClick:this.applyFilters},o.a.createElement(C.a,{icon:"filter",size:"lg",fixedWidth:!0})," Apply Filters"));return l?d=h:e=s?o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{className:"button mr-3",onClick:this.cancelEdit},o.a.createElement(C.a,{icon:"times",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button mr-3",onClick:this.save},o.a.createElement(C.a,{icon:"save",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button mr-3",onClick:this.deleteDashboard},o.a.createElement(C.a,{icon:"trash-alt",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button",onClick:function(){return t.openWidgetEditPanel(null)}},o.a.createElement(C.a,{icon:"calendar-plus",size:"lg",fixedWidth:!0})," New Widget")):o.a.createElement(o.a.Fragment,null,h,o.a.createElement("button",{className:"button square-button mr-3",onClick:this.fullScreen},o.a.createElement(C.a,{icon:"tv",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button",onClick:this.edit},o.a.createElement(C.a,{icon:"edit",size:"lg",fixedWidth:!0}))),o.a.createElement(o.a.Fragment,null,c&&o.a.createElement("div",{className:"dashboard-menu-panel row"},o.a.createElement("div",{className:"float-left"},i&&o.a.createElement("div",{className:"dashboard-drillthrough-name",onClick:this.goBackToFromDashboard},o.a.createElement("span",{className:"link-label"},i)," >")),o.a.createElement("div",{className:"float-left"},l||!s?o.a.createElement("div",{className:"dashboard-name"},this.state.name):o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange,className:"dashboard-name-input"})),o.a.createElement("div",{className:"float-right"},d,e)),o.a.createElement(Ce,Object.assign({ref:this.widgetViewPanel,isEditMode:this.state.isEditMode,showControl:this.state.showControl,widgetViewWidth:this.state.widgetViewWidth,onWidgetEdit:this.openWidgetEditPanel,onStyleValueChange:this.onStyleValueChange,onWidgetContentClick:this.onWidgetContentClick},this.state.style)),o.a.createElement(T,{show:this.state.showWidgetEditPanel,onClose:function(){return t.setState({showWidgetEditPanel:!1})},modalClass:"dashboard-edit-widget-dialog",title:"Widget Edit"},o.a.createElement(Se,{ref:this.widgetEditPanel,jdbcDataSourceOptions:this.state.jdbcDataSourceOptions,dashboardId:this.state.dashboardId,onSave:this.onWidgetSave})),o.a.createElement(T,{show:this.state.showConfirmDeletionPanel,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",this.state.objectToDelete.name,"?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}}]),t}(o.a.Component),Pe=Object(v.a)(xe),Ie=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchBoards=function(){b.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({dashboards:t})})},a.handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleNameInputChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.closeEditPanel=function(){a.setState({showEditPanel:!1,name:""})},a.save=function(){var e=a.state.name;if(e){var t={name:e,style:{height:$,backgroundColor:"rgba(233, 235, 238, 1)",isFixedWidth:!0,fixedWidth:_}};b.a.post("/ws/dashboard",t).then(function(e){var t=e.data;a.closeEditPanel(),a.fetchBoards(),a.props.history.push("/workspace/dashboard/".concat(t))}).catch(function(e){U.showError("The name exists. Try another.")})}else U.showError("Enter a name.")},a.view=function(e){a.setState({activeDashboardId:e},function(){a.props.history.push("/workspace/dashboard/".concat(e))})},a.onDashboardSave=function(e){a.fetchBoards()},a.onDashboardDelete=function(e){a.fetchBoards(),a.setState({activeDashboardId:0},function(){a.props.history.push("/workspace/dashboard")})},a.state={searchValue:"",dashboards:[],showEditPanel:!1,activeDashboardId:0,name:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.location.pathname,t=e.indexOf("/workspace/dashboard/");if(-1!==t){var a=Number(e.substring(t+"/workspace/dashboard/".length));this.setState({activeDashboardId:a})}this.fetchBoards()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.dashboards,n=void 0===a?[]:a,r=t.activeDashboardId,s=t.searchValue,l=this.props.sysRole!==J,i=[],c=function(t){var a=n[t],l=a.name,c=r===a.id?"dashboard-menu-item-active":"";(!s||s&&l.includes(s))&&i.push(o.a.createElement("div",{key:t,className:"dashboard-menu-item ellipsis ".concat(c),onClick:function(){return e.view(a.id)}},l))},u=0;u<n.length;u++)c(u);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"dashboard-sidebar"},o.a.createElement("div",{style:{margin:"5px"}},l&&o.a.createElement("button",{className:"button icon-button dashboard-add-button",onClick:function(){return e.setState({showEditPanel:!0})}},o.a.createElement(C.a,{icon:"plus"})," New"),o.a.createElement("div",{style:{marginTop:"5px"}},o.a.createElement(V,{name:"searchValue",value:this.state.searchValue,onChange:this.handleNameInputChange,inputWidth:117}))),o.a.createElement("div",null,i)),o.a.createElement("div",{className:"dashboard-content"},o.a.createElement(p.a,{path:"/workspace/dashboard/:id",render:function(t){return o.a.createElement(Pe,{key:t.match.params.id,onDashboardSave:e.onDashboardSave,onDashboardDelete:e.onDashboardDelete})}})),o.a.createElement(T,{show:this.state.showEditPanel,onClose:function(){return e.setState({showEditPanel:!1})},modalClass:"small-modal-panel",title:"New"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),o.a.createElement("button",{className:"button",onClick:this.save},"Save"))))}}]),t}(n.Component),Te=Object(v.a)(Ie),Me=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleNameInputChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.handleIntegerOptionChange=function(e,t){var n=parseInt(t,10)||0;a.setState(Object(y.a)({},e,n))},a.fetchUsers=function(){b.a.get("/ws/user").then(function(e){var t=e.data;a.setState({users:t})})},a.fetchGroups=function(){b.a.get("/ws/group").then(function(e){var t=e.data;a.setState({groups:t})})},a.openEditPanel=function(e){null!==e?b.a.get("/ws/user/"+e.id).then(function(e){var t=e.data;a.setState({id:t.id,username:t.username,name:t.name,tempPassword:"",sysRole:t.sysRole,userGroups:t.userGroups})}):a.clearEditPanel(),a.setState({userGroupId:"",showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.clearEditPanel=function(){a.setState(a.initialEditPanelState)},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.save=function(){var e=a.state,t=e.showUpdatePassword,n=e.id,o=e.username,r=e.name,s=e.tempPassword,l=e.sysRole,i=e.userGroups;if(o){var c=J;if(Y===a.props.sysRole){if(!l)return void U.showError("Select a role.");c=l}var u={username:o,name:r,sysRole:c,userGroups:i};if(null!==n){if(u.id=n,t){if(!s||s.length<8)return void U.showError("Use 8 or more characters for password.");u.tempPassword=s}b.a.put("/ws/user",u).then(function(e){a.clearEditPanel(),a.closeEditPanel(),a.fetchUsers()})}else{if(!s||s.length<8)return void U.showError("Use 8 or more characters for password.");u.tempPassword=s,b.a.post("/ws/user",u).then(function(e){a.clearEditPanel(),a.closeEditPanel(),a.fetchUsers()})}}else U.showError("Enter a username.")},a.addUserGroup=function(){var e=a.state,t=e.userGroupId,n=e.userGroups,o=void 0===n?[]:n;if(-1===o.findIndex(function(e){return e===t})){var r=Object(Z.a)(o);r.push(t),a.setState({userGroups:r})}},a.removeUserGroup=function(e){var t=a.state.userGroups,n=void 0===t?[]:t,o=n.findIndex(function(t){return t===e});if(-1!==o){var r=Object(Z.a)(n);r.splice(o,1),a.setState({userGroups:r})}},a.confirmDelete=function(){var e=a.state.objectToDelete,t=void 0===e?{}:e;b.a.delete("/ws/user/"+t.id).then(function(e){a.fetchUsers(),a.closeConfirmDeletionPanel()})},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.state={users:[],groups:[],showConfirmDeletionPanel:!1,objectToDelete:{},searchValue:"",showUpdatePassword:!1,showEditPanel:!1,id:null,username:"",name:"",tempPassword:"",sysRole:J,userGroupId:"",userGroups:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchUsers(),this.fetchGroups()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.id,n=t.showUpdatePassword,r=t.users,s=void 0===r?[]:r,l=t.groups,i=void 0===l?[]:l,c=t.userGroups,u=void 0===c?[]:c,d=t.searchValue,h=t.showConfirmDeletionPanel,m=t.objectToDelete,p=void 0===m?{}:m,f=this.props.sysRole,v=null===a?"New":"Edit",g=[],b=function(t){var a=s[t],n=a.name,r=a.username;(!d||d&&(r.includes(d)||n.includes(d)))&&g.push(o.a.createElement("div",{key:t,className:"card float-left"},o.a.createElement("div",{className:"card-header ellipsis"},a.username),o.a.createElement("div",{className:"card-content"},a.name,o.a.createElement("br",null),a.sysRole),o.a.createElement("div",{className:"card-footer row"},o.a.createElement("div",{className:"float-right"},o.a.createElement("button",{className:"icon-button card-icon-button",onClick:function(){return e.openEditPanel(a)}},o.a.createElement(C.a,{icon:"edit",size:"lg"})),o.a.createElement("button",{className:"icon-button card-icon-button",onClick:function(){return e.openConfirmDeletionPanel(a)}},o.a.createElement(C.a,{icon:"trash-alt",size:"lg"}))))))},E=0;E<s.length;E++)b(E);var w=[],y=function(t){for(var a=u[t],n=0;n<i.length;n++)if(a===i[n].id){w.push(o.a.createElement("div",{key:a,className:"row table-row"},o.a.createElement("div",{className:"float-left ellipsis "},i[n].name),o.a.createElement("button",{className:"button table-row-button float-right",onClick:function(){return e.removeUserGroup(a)}},o.a.createElement(C.a,{icon:"trash-alt"}))));break}};for(E=0;E<u.length;E++)y(E);return o.a.createElement("div",null,o.a.createElement("div",{class:"row"},o.a.createElement("div",{className:"float-left",style:{marginRight:"5px"}},o.a.createElement(V,{name:"searchValue",value:this.state.searchValue,onChange:this.handleNameInputChange,inputWidth:200})),o.a.createElement("button",{className:"button float-left",onClick:function(){return e.openEditPanel(null)}},o.a.createElement(C.a,{icon:"plus"})," New")),o.a.createElement("div",{className:"row mt-10"},g),o.a.createElement(T,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"mid-modal-panel",title:v},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"form-panel float-left",style:{width:"240px"}},o.a.createElement("label",null,"Username ",o.a.createElement("span",{className:"required"},"*")),o.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange}),o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),"Edit"===v&&o.a.createElement("div",{style:{margin:"3px 0px 8px 0px"}},o.a.createElement("button",{className:"button",onClick:this.toggleUpdatePassword},"Update password")),("New"===v||n)&&o.a.createElement("div",null,o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"tempPassword",value:this.state.tempPassword,onChange:this.handleInputChange})),o.a.createElement("label",null,"System Role"),Y===f&&o.a.createElement(je,{name:"sysRole",value:this.state.sysRole,onChange:this.handleNameInputChange,options:[J,"developer"]}),"developer"===f&&o.a.createElement("div",null,J)),o.a.createElement("div",{className:"form-panel float-right",style:{width:"240px"}},o.a.createElement("label",null,"Groups"),o.a.createElement(je,{name:"userGroupId",value:this.state.userGroupId,onChange:this.handleIntegerOptionChange,options:i,optionDisplay:"name",optionValue:"id"}),o.a.createElement("button",{className:"button",onClick:this.addUserGroup},"Add"),o.a.createElement("div",{style:{marginTop:"8px"}},w))),o.a.createElement("button",{className:"button mt-3",onClick:this.save},"Save")),o.a.createElement(T,{show:h,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",p.name,"?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}},{key:"initialEditPanelState",get:function(){return{id:null,username:"",name:"",tempPassword:"",sysRole:"",userGroupId:"",userGroups:[]}}}]),t}(o.a.Component),We=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleNameInputChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.handleIntegerOptionChange=function(e,t){var n=parseInt(t,10)||0;a.setState(Object(y.a)({},e,n))},a.fetchGroups=function(){b.a.get("/ws/group").then(function(e){var t=e.data;a.setState({groups:t})})},a.fetchDashboards=function(){b.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({dashboards:t})})},a.openEditPanel=function(e){null!==e?b.a.get("/ws/group/"+e.id).then(function(e){var t=e.data;a.setState({id:t.id,name:t.name,groupDashboards:t.groupDashboards})}):a.clearEditPanel(),a.setState({groupDashboardId:"",showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.clearEditPanel=function(){a.setState(a.initialEditPanelState)},a.save=function(){var e=a.state,t=e.id,n={name:e.name,groupDashboards:e.groupDashboards};null!==t?(n.id=t,b.a.put("/ws/group",n).then(function(e){a.clearEditPanel(),a.fetchGroups(),a.closeEditPanel()})):b.a.post("/ws/group",n).then(function(e){a.clearEditPanel(),a.fetchGroups(),a.closeEditPanel()})},a.addGroupDashboard=function(){var e=a.state,t=e.groupDashboardId,n=e.groupDashboards,o=void 0===n?[]:n;if(t&&-1===o.findIndex(function(e){return e===t})){var r=Object(Z.a)(o);r.push(t),a.setState({groupDashboards:r})}},a.removeGroupDashboard=function(e){var t=a.state.groupDashboards,n=void 0===t?[]:t,o=n.findIndex(function(t){return t===e});if(-1!==o){var r=Object(Z.a)(n);r.splice(o,1),a.setState({groupDashboards:r})}},a.confirmDelete=function(){var e=a.state.objectToDelete,t=void 0===e?{}:e;b.a.delete("/ws/group/"+t.id).then(function(e){a.fetchGroups(),a.closeConfirmDeletionPanel()})},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.state={groups:[],dashboards:[],showConfirmDeletionPanel:!1,objectToDelete:{},showEditPanel:!1,searchValue:"",id:null,name:"",groupDashboardId:"",groupDashboards:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchGroups(),this.fetchDashboards()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.id,n=t.groups,r=void 0===n?[]:n,s=t.dashboards,l=void 0===s?[]:s,i=t.groupDashboards,c=void 0===i?[]:i,u=t.searchValue,d=t.showConfirmDeletionPanel,h=t.objectToDelete,m=void 0===h?{}:h,p=null===a?"New":"Edit",f=[],v=function(t){var a=r[t],n=a.name;(!u||u&&n.includes(u))&&f.push(o.a.createElement("div",{key:t,className:"card float-left"},o.a.createElement("div",{className:"card-header ellipsis"},n),o.a.createElement("div",{className:"card-content"}),o.a.createElement("div",{className:"card-footer row"},o.a.createElement("div",{className:"float-right"},o.a.createElement("button",{className:"icon-button card-icon-button",onClick:function(){return e.openEditPanel(a)}},o.a.createElement(C.a,{icon:"edit",size:"lg"})),o.a.createElement("button",{className:"icon-button card-icon-button",onClick:function(){return e.openConfirmDeletionPanel(a)}},o.a.createElement(C.a,{icon:"trash-alt",size:"lg"}))))))},g=0;g<r.length;g++)v(g);var b=[],E=function(t){for(var a=c[t],n=0;n<l.length;n++)if(a===l[n].id){b.push(o.a.createElement("div",{key:a,className:"row table-row"},o.a.createElement("div",{className:"float-left ellipsis"},l[n].name),o.a.createElement("button",{className:"button table-row-button float-right",onClick:function(){return e.removeGroupDashboard(a)}},o.a.createElement(C.a,{icon:"trash-alt"}))));break}};for(g=0;g<c.length;g++)E(g);return o.a.createElement("div",null,o.a.createElement("div",{class:"row"},o.a.createElement("div",{className:"float-left",style:{marginRight:"5px"}},o.a.createElement(V,{name:"searchValue",value:this.state.searchValue,onChange:this.handleNameInputChange,inputWidth:200})),o.a.createElement("button",{className:"button float-left",onClick:function(){return e.openEditPanel(null)}},o.a.createElement(C.a,{icon:"plus"})," New")),o.a.createElement("div",{className:"row mt-10"},f),o.a.createElement(T,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"mid-modal-panel",title:p},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"form-panel float-left",style:{width:"240px"}},o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange})),o.a.createElement("div",{className:"form-panel float-right",style:{width:"240px"}},o.a.createElement("label",null,"Dashboards"),o.a.createElement(je,{name:"groupDashboardId",value:this.state.groupDashboardId,onChange:this.handleIntegerOptionChange,options:l,optionDisplay:"name",optionValue:"id"}),o.a.createElement("button",{className:"button",onClick:this.addGroupDashboard},"Add"),o.a.createElement("div",{style:{marginTop:"8px"}},b))),o.a.createElement("button",{className:"button mt-3",onClick:this.save},"Save")),o.a.createElement(T,{show:d,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",m.name,"?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}},{key:"initialEditPanelState",get:function(){return{id:null,name:"",groupDashboardId:"",groupDashboards:[]}}}]),t}(o.a.Component),Re=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"full-page-content"},o.a.createElement(Oe,{activeTab:"Group"},o.a.createElement("div",{title:"Group"},o.a.createElement(We,null)),o.a.createElement("div",{title:"User"},o.a.createElement(Me,this.props))))}}]),t}(o.a.Component),Ue=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.fetchUser=function(){b.a.get("/ws/user/account").then(function(e){var t=e.data;a.setState({id:t.id,username:t.username,name:t.name,sysRole:t.sysRole,apiKey:t.apiKey})})},a.generateApiKey=function(){b.a.get("/auth/generate-apikey").then(function(e){var t=e.data;a.setState({apiKey:t})})},a.save=function(){var e=a.state,t=e.showUpdatePassword,n=e.name,o=e.password,r=e.confirmedPassword,s={name:n};if(t){if(o!==r)return void U.showError("Those passwords didn't match.");if(o.length<8)return void U.showError("Use 8 or more characters for password.");s.password=o}b.a.put("/ws/user/account",s).then(function(e){U.showSuccess("Saved.")})},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.state={showUpdatePassword:!1,id:null,username:"",name:"",sysRole:"",apiKey:"",password:"",confirmedPassword:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchUser()}},{key:"render",value:function(){var e=this.state,t=e.showUpdatePassword,a=e.username,n=e.sysRole,r=e.apiKey;return o.a.createElement("div",{className:"full-page-content"},o.a.createElement("div",{className:"form-panel",style:{width:"400px"}},o.a.createElement("label",null,"Username"),o.a.createElement("div",null,a),o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),o.a.createElement("label",null,"System Role"),o.a.createElement("div",null,n),o.a.createElement("label",null,"API Key"),o.a.createElement("div",null,r),o.a.createElement("button",{className:"button mt-10",onClick:this.generateApiKey},"Generate new API Key"),o.a.createElement("br",null),o.a.createElement("button",{className:"button mt-3",onClick:this.toggleUpdatePassword},"Update password"),t&&o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange}),o.a.createElement("label",null,"Confirm Password"),o.a.createElement("input",{type:"password",name:"confirmedPassword",value:this.state.confirmedPassword,onChange:this.handleInputChange})),o.a.createElement("br",null),o.a.createElement("button",{className:"button mt-10",onClick:this.save},"Save")))}}]),t}(o.a.Component),Ve=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.location.pathname;return o.a.createElement("div",{className:"full-screen-view"},o.a.createElement(Pe,{key:e}))}}]),t}(o.a.Component),Fe=(a(835),[{link:"/workspace/dashboard",value:"Dashboard",icon:"chalkboard"},{link:"/workspace/datasource",value:"Data Source",icon:"database"},{link:"/workspace/usermanagement",value:"User Management",icon:"users-cog"}]),Le=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleMenuClick=function(e){a.setState({currentMenuLink:e})},a.logout=function(){b.a.get("/auth/logout").then(function(e){a.props.onLogout()})},a.state={currentMenuLink:"/workspace/dashboard"},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t=this.props.location.pathname;t.startsWith("/workspace/account")?e="/workspace/account":e=Fe.find(function(e){return t.startsWith(e.link)}).link;this.setState({currentMenuLink:e})}},{key:"render",value:function(){var e=this,t=this.state.currentMenuLink,a=this.props,n=a.username,r=a.sysRole,s=[],l=[];l=r===J?Fe.filter(function(e){return"/workspace/dashboard"===e.link}):Fe;for(var i=function(a){var n=l[a],r=t===n.link?"menu-item-active":"";s.push(o.a.createElement("li",{key:n.link,className:r},o.a.createElement(D.a,{to:n.link,onClick:function(){return e.handleMenuClick(n.link)}},o.a.createElement(C.a,{icon:n.icon,fixedWidth:!0}),o.a.createElement("span",{className:"workspace-nav-menu-text"},n.value))))},c=0;c<l.length;c++)i(c);var u="/workspace/account"===t?"menu-item-active":"";return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"workspace-nav"},o.a.createElement("div",{className:"workspace-name"},"Poli"),o.a.createElement("ul",{className:"workspace-nav-menu"},s),o.a.createElement("div",{className:"workspace-account-menu"},o.a.createElement("div",{className:"workspace-account-button inline-block ".concat(u)},o.a.createElement(D.a,{to:"/workspace/account",onClick:function(){return e.handleMenuClick("/workspace/account")}},o.a.createElement(C.a,{icon:"user",fixedWidth:!0}),o.a.createElement("span",{className:"workspace-nav-menu-text"},n))),o.a.createElement("div",{className:"workspace-logout-button inline-block",onClick:this.logout},o.a.createElement(C.a,{icon:"sign-out-alt",fixedWidth:!0})))),o.a.createElement("div",{className:"workspace-content"},o.a.createElement(m.a,null,o.a.createElement(p.a,{exact:!0,path:"/workspace/datasource",component:F}),o.a.createElement(p.a,{exact:!0,path:"/workspace/account",component:Ue}),o.a.createElement(p.a,{exact:!0,path:"/workspace/dashboard/full/:name",component:Ve}),o.a.createElement(p.a,{exact:!0,path:"/workspace/usermanagement",render:function(){return o.a.createElement(Re,e.props)}}),o.a.createElement(p.a,{path:"/workspace/dashboard",render:function(){return o.a.createElement(Te,e.props)}}))),o.a.createElement(U,null))}}]),t}(o.a.Component),Be=Object(v.a)(Le),Ge=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("h1",null,"PageNotFound"),o.a.createElement(D.a,{to:"/login"},"Login"))}}]),t}(o.a.Component);E.b.add(w.b,w.e,w.x,w.n,w.t,w.f,w.u,w.l,w.s,w.o,w.v,w.m,w.w,w.r,w.d,w.g,w.j,w.i,w.c,w.q,w.p,w.a,w.k,w.h);var ze=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleLoginResponse=function(e,t){e.error?a.setState({sysRole:"",isAuthorizing:!1},function(){a.props.history.push("/login")}):a.onLoginSuccess(e,t)},a.onLoginSuccess=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.isTempPassword?a.props.history.push("/changepassword"):a.setState({username:e.username,sysRole:e.sysRole,isAuthorizing:!1},function(){var e="/workspace/dashboard";t&&(e=t),a.props.history.push(e)})},a.onLogout=function(){a.setState({username:"",sysRole:"",isAuthorizing:!1},function(){a.props.history.push("/login")})},a.configAxiosInterceptors=function(){b.a.interceptors.response.use(function(e){return e},function(e){var t=e.response.status;return 401!==t&&403!==t||a.onLogout(),Promise.reject(e)})},a.state={username:"",sysRole:"",isAuthorizing:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.configAxiosInterceptors();var t=this.props.location.pathname,a=this.props.location.search,n=t+a,o=new URLSearchParams(a).get("$apiKey");if(null==o){var r=!1;this.state.sysRole&&(r=!0),r||this.setState({isAuthorizing:!0},function(){b.a.post("/auth/login/cookie").then(function(t){e.handleLoginResponse(t.data,n)})})}else{var s={apiKey:o};this.setState({isAuthorizing:!0},function(){b.a.post("/auth/login/apikey",s).then(function(t){e.handleLoginResponse(t.data,n)})})}}},{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.sysRole,r=t.isAuthorizing,s=!1;return n&&(s=!0),r?o.a.createElement("div",{className:"authenticating-panel"},o.a.createElement("div",{className:"authenticating-panel-title"},"Poli"),o.a.createElement(C.a,{icon:"circle-notch",spin:!0,size:"2x"})):o.a.createElement("div",{className:"app"},o.a.createElement(m.a,null,o.a.createElement(p.a,{exact:!0,path:"/",render:function(){return o.a.createElement(O,{sysRole:n,onLoginSuccess:e.onLoginSuccess})}}),o.a.createElement(p.a,{path:"/login",render:function(){return o.a.createElement(O,{sysRole:n,onLoginSuccess:e.onLoginSuccess})}}),o.a.createElement(p.a,{path:"/changepassword",component:N}),o.a.createElement(Ae,{authenticated:s,path:"/workspace",component:Be,username:a,sysRole:n,onLogout:this.onLogout}),o.a.createElement(p.a,{component:Ge})))}}]),t}(o.a.Component);function Ae(e){var t=e.component,a=e.authenticated,n=Object(l.a)(e,["component","authenticated"]);return o.a.createElement(p.a,Object.assign({},n,{render:function(e){return!0===a?o.a.createElement(t,Object.assign({},e,n)):o.a.createElement(f.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var qe=Object(v.a)(ze),Ke=a(840);s.a.render(o.a.createElement(Ke.a,{basename:"/poli"},o.a.createElement(qe,null)),document.getElementById("root"))}},[[313,1,2]]]);
//# sourceMappingURL=main.f9ddf19f.chunk.js.map