(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e,t,a){},188:function(e,t,a){},313:function(e,t,a){e.exports=a(832)},340:function(e,t,a){},344:function(e,t,a){},345:function(e,t,a){},346:function(e,t,a){},509:function(e,t,a){},819:function(e,t,a){},820:function(e,t,a){},821:function(e,t,a){},829:function(e,t,a){},830:function(e,t,a){},831:function(e,t,a){},832:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(32),s=a.n(r),i=a(312),l=a(5),c=a(6),u=a(8),d=a(7),h=a(9),m=a(838),p=a(833),f=a(835),v=a(837),g=a(10),b=a.n(g),E=a(101),w=a(26),C=a(15),y=(a(340),a(18)),k=(a(187),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleKeyPress=function(e){13===e.keyCode&&a.login()},a.login=function(){var e=a.state,t=e.username,n=e.password,o={username:t,password:n};t?n?b.a.post("/auth/login/user",o).then(function(e){var t=e.data;t.error?a.setState({errorMsg:t.error}):a.props.onLoginSuccess(t)}):a.setState({errorMsg:"Enter password."}):a.setState({errorMsg:"Enter username."})},a.state={errorMsg:"",username:"",password:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=!1;this.props.sysRole&&(t=!0),t||b.a.post("/auth/login/cookie").then(function(t){var a=t.data;a.error||e.props.onLoginSuccess(a)})}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"login-panel"},o.a.createElement("div",{className:"login-app-title"},"Poli"),o.a.createElement("div",{className:"login-error-msg"},this.state.errorMsg),o.a.createElement("div",{className:"login-panel-body"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Username"),o.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange,onKeyDown:this.handleKeyPress}),o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange,onKeyDown:this.handleKeyPress}),o.a.createElement("button",{className:"button login-button",onClick:this.login},"Login")))))}}]),t}(o.a.Component)),O=Object(v.a)(k),j=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.changePassword=function(){var e=a.state,t=e.password,n=e.confirmedPassword;if(t&&n&&t===n){if(t.length<8)return void a.setState({errorMsg:"Use 8 or more characters."});var o={password:t};b.a.post("/auth/login/changepassword",o).then(function(e){var t=e.data||{};t.error?a.setState({errorMsg:t.error}):a.props.history.push("/workspace/dashboard")})}else a.setState({errorMsg:"Those passwords didn't match."})},a.state={errorMsg:"",password:"",confirmedPassword:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"login-panel"},o.a.createElement("div",{style:{fontSize:"22px",textAlign:"center",fontWeight:"bold",marginBottom:"15px"}},"Change password"),o.a.createElement("div",{className:"login-error-msg"},this.state.errorMsg),o.a.createElement("div",{className:"login-panel-body"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("div",{style:{fontWeight:"bold",marginBottom:"5px",fontSize:"15px"}},"* Use 8 or more characters"),o.a.createElement("label",null,"New password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.username,onChange:this.handleInputChange}),o.a.createElement("label",null,"Confirm password"),o.a.createElement("input",{type:"password",name:"confirmedPassword",value:this.state.confirmedPassword,onChange:this.handleInputChange}),o.a.createElement("button",{className:"button login-button",onClick:this.changePassword},"Confirm")))))}}]),t}(o.a.Component),S=Object(v.a)(j),D=a(834),N=a(35),P=a.n(N),x=a(56),I=(a(344),function(){var e=Object(x.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("/ws/jdbcdatasource");case 3:return t=e.sent,e.abrupt("return",t.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}()),M=(a(345),function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.show,n=t.modalClass,r=void 0===n?"":n,s=t.title,i=t.children,l=a?"display-block":"display-none";return o.a.createElement("div",{className:"modal-overlay ".concat(l)},o.a.createElement("div",{className:"modal-panel ".concat(r)},o.a.createElement("div",{className:"model-header row"},o.a.createElement("div",{className:"model-title"},s),o.a.createElement("button",{className:"model-close-button icon-button",onClick:function(){return e.props.onClose()}},o.a.createElement(C.a,{icon:"times",size:"lg"}))),o.a.createElement("hr",null),o.a.createElement("div",{className:"modal-body"},i)))}}]),t}(o.a.Component)),T=a(21),W=(a(346),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).show=function(e){a.setState({showToast:!0,message:e},function(){setTimeout(function(){a.hide()},3500)})},a.hide=function(){a.setState({showToast:!1,message:""})},a.state={showToast:!1,message:""},t._toastRef=Object(T.a)(Object(T.a)(a)),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state,t=e.showToast,a=e.message,n=t?"display-block":"display-none";return o.a.createElement("div",{className:"toast-container ".concat(n)},o.a.createElement("button",{className:"button",onClick:this.hide},"X"),o.a.createElement("div",null,a))}}]),t}(o.a.Component));W.show=function(e){W._toastRef.show(e)};var U=W,R=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.save=function(){var e=a.state,t=e.showUpdatePassword,n=e.id,o=e.connectionUrl,r=e.driverClassName,s=e.username,i=e.password,l=e.name,c=e.ping;if(l){var u={connectionUrl:o,driverClassName:r,username:s,name:l,ping:c};null!==n?(u.id=n,t&&i&&(u.password=i),b.a.put("/ws/jdbcdatasource",u).then(function(e){a.closeEditPanel(),a.fetchDataSources()}).catch(function(e){U.show("The name exists. Try another.")})):(u.password=i,b.a.post("/ws/jdbcdatasource",u).then(function(e){a.closeEditPanel(),a.fetchDataSources()}).catch(function(e){U.show("The name exists. Try another.")}))}else U.show("Enter a name.")},a.ping=function(e){b.a.get("/ws/jdbcdatasource/ping/".concat(e)).then(function(e){var t=e.data;U.show(t)})},a.clearEditPanel=function(){a.setState(a.initialState)},a.openEditPanel=function(e){null!==e?a.setState({showUpdatePassword:!1,id:e.id,connectionUrl:e.connectionUrl,driverClassName:e.driverClassName,username:e.username,password:e.password,name:e.name,ping:e.ping}):a.clearEditPanel(),a.setState({showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.confirmDelete=function(){var e=a.state.objectToDelete,t=void 0===e?{}:e;b.a.delete("/ws/jdbcdatasource/"+t.id).then(function(e){a.fetchDataSources(),a.closeConfirmDeletionPanel()})},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.clearSearch=function(){a.setState({searchValue:""})},a.state={jdbcDataSources:[],showEditPanel:!1,showConfirmDeletionPanel:!1,objectToDelete:{},showUpdatePassword:!1,searchValue:"",id:null,name:"",connectionUrl:"",driverClassName:"",username:"",password:"",ping:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchDataSources()}},{key:"fetchDataSources",value:function(){var e=Object(x.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:t=e.sent,this.setState({jdbcDataSources:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){for(var e=this,t=this.state,a=t.showUpdatePassword,n=t.showConfirmDeletionPanel,r=t.searchValue,s=t.id,i=t.jdbcDataSources,l=void 0===i?[]:i,c=t.objectToDelete,u=void 0===c?{}:c,d=null===s?"New":"Edit",h=[],m=function(t){var a=l[t],n=a.name;(!r||r&&n.includes(r))&&h.push(o.a.createElement("div",{key:t,className:"datasource-card row"},o.a.createElement("div",{className:"float-left ellipsis datasource-row-name"},n),o.a.createElement("div",{className:"float-right"},o.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.openEditPanel(a)}},o.a.createElement(C.a,{icon:"edit",size:"lg"})),o.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.openConfirmDeletionPanel(a)}},o.a.createElement(C.a,{icon:"trash-alt",size:"lg"})),o.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.ping(a.id)}},o.a.createElement(C.a,{icon:"plug",size:"lg"})))))},p=0;p<l.length;p++)m(p);return o.a.createElement("div",{className:"full-page-content"},o.a.createElement("div",null,o.a.createElement("input",{type:"text",name:"searchValue",value:this.state.searchValue,onChange:this.handleInputChange,placeholder:"Search...",style:{width:"200px"}}),o.a.createElement("button",{className:"button",onClick:this.clearSearch},"Clear"),o.a.createElement("button",{className:"button",onClick:function(){return e.openEditPanel(null)}},o.a.createElement(C.a,{icon:"plus"})," New")),o.a.createElement("div",{className:"table-panel"},h),o.a.createElement(M,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"small-modal-panel",title:d},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Name ",o.a.createElement("span",{className:"required"},"*")),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),o.a.createElement("label",null,"Connection Url"),o.a.createElement("textarea",{rows:"4",type:"text",name:"connectionUrl",value:this.state.connectionUrl,onChange:this.handleInputChange}),o.a.createElement("label",null,"Driver Class Name"),o.a.createElement("input",{type:"text",name:"driverClassName",value:this.state.driverClassName,onChange:this.handleInputChange}),o.a.createElement("label",null,"Username"),o.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange}),"Edit"===d&&o.a.createElement("div",{style:{margin:"3px 0px 8px 0px"}},o.a.createElement("button",{className:"button",onClick:this.toggleUpdatePassword},"Update password")),("New"===d||a)&&o.a.createElement("div",null,o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange})),o.a.createElement("label",null,"Ping"),o.a.createElement("input",{type:"text",name:"ping",value:this.state.ping,onChange:this.handleInputChange}),o.a.createElement("button",{className:"button mt-3",onClick:this.save},"Save"))),o.a.createElement(M,{show:n,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",u.name,"?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}},{key:"initialState",get:function(){return{showUpdatePassword:!1,id:null,name:"",connectionUrl:"",driverClassName:"",username:"",password:"",ping:""}}}]),t}(n.Component),V=(a(188),"chart"),G="filter",L=[V,G],B="slicer",q="single",F=[B,q],A="pie",z="table",K=[z,A],Q="admin",H="viewer",X=600,Y=a(102),J=a(25),_=a(309),$=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleClick=function(){a.setState(function(e){return{showPalette:!e.showPalette}})},a.handleClose=function(){a.setState({showPalette:!1})},a.handleChange=function(e){var t=e.rgb,n="rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")");a.props.onChange(n)},a.state={showPalette:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={width:"36px",height:"14px",borderRadius:"2px",background:this.props.value};return o.a.createElement("div",null,o.a.createElement("div",{style:{padding:"5px",background:"#fff",borderRadius:"1px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:this.handleClick},o.a.createElement("div",{style:e})),this.state.showPalette&&o.a.createElement("div",{style:{position:"absolute",zIndex:"2"}},o.a.createElement("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:this.handleClose}),o.a.createElement(_.ChromePicker,{color:this.props.value,onChange:this.handleChange})))}}]),t}(o.a.Component),Z=(a(509),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).toggle=function(){var e=a.props,t=e.name,n=e.checked;a.props.onChange(t,!n)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a={backgroundColor:e.checked?"#000000":"#FFFFFF"};return o.a.createElement("div",{className:"checkbox-container",onClick:this.toggle},o.a.createElement("div",{className:"checkbox-checkmark"},o.a.createElement("div",{className:"checkbox-checkmark-box",style:a})),o.a.createElement("div",{className:"checkbox-label"},t))}}]),t}(o.a.Component)),ee=a(137),te=a.n(ee),ae=function(e){var t;try{t=JSON.parse(e)}catch(a){t=[]}return t},ne=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],oe=function(e,t,a){for(var n=[],o=[],r=0;r<e.length;r++){var s=e[r];n.push(s[t]),o.push({name:s[t],value:s[a]})}return function(e,t){return{color:ne,tooltip:{},legend:{type:"scroll",orient:"vertical",data:e,right:10,top:10,bottom:10},series:[{type:"pie",center:["40%","50%"],radius:"50%",data:t}]}}(n,o)},re=2,se=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){e.preventDefault();for(var t=s.a.findDOMNode(Object(T.a)(Object(T.a)(a))).parentNode,n=e.clientX-t.offsetLeft,o=e.clientY-t.offsetTop,r=document.getElementsByClassName("grid-box"),i=0;i<r.length;i++)r[i].style.zIndex=20;t.style.zIndex=30;var l=t.ownerDocument;l.addEventListener("mouseup",a.onMouseUp),l.addEventListener("mousemove",a.onMouseMove),a.setState({xOffset:n,yOffset:o}),a.props.onMouseDown("drag")},a.onMouseUp=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(T.a)(Object(T.a)(a)));if(t){var n=t.ownerDocument;n.removeEventListener("mousedown",a.onMouseDown),n.removeEventListener("mouseup",a.onMouseUp),n.removeEventListener("mousemove",a.onMouseMove)}a.props.onMouseUp()},a.onMouseMove=function(e){if(e.preventDefault(),"drag"===a.props.mode){var t=1;a.props.snapToGrid&&(t=4);var n=s.a.findDOMNode(Object(T.a)(Object(T.a)(a))).parentNode,o=e.clientX-a.state.xOffset,r=e.clientY-a.state.yOffset,i=n.parentNode,l=i.clientWidth,c=i.clientHeight,u=parseInt(n.style.width,10)+2*re,d=parseInt(n.style.height,10)+2*re;o<0&&(o=0),r<0&&(r=0),o+u>l&&(o=l-u),r+d>c&&(r=c-d),o=Math.floor(o/t)*t,r=Math.floor(r/t)*t,n.style.left=o+"px",n.style.top=r+"px"}},a.state={xOffset:0,yOffset:0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){return o.a.createElement("div",{className:"grid-draggable",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},o.a.createElement(C.a,{icon:"expand-arrows-alt",fixedWidth:!0}))}}]),t}(o.a.Component),ie=30,le=30,ce=2,ue=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(T.a)(Object(T.a)(a))),n=e.clientX,o=e.clientY,r=t.ownerDocument;r.addEventListener("mouseup",a.onMouseUp),r.addEventListener("mousemove",a.onMouseMove),a.setState({currentX:n,currentY:o}),a.props.onMouseDown("resize")},a.onMouseUp=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(T.a)(Object(T.a)(a)));if(t){var n=t.ownerDocument;n.removeEventListener("mousedown",a.onMouseDown),n.removeEventListener("mouseup",a.onMouseUp),n.removeEventListener("mousemove",a.onMouseMove)}a.props.onMouseUp()},a.onMouseMove=function(e){if(e.preventDefault(),"resize"===a.props.mode){var t=e.clientX-a.state.currentX,n=e.clientY-a.state.currentY,o=s.a.findDOMNode(Object(T.a)(Object(T.a)(a))).parentNode,r=parseInt(o.style.width,10),i=parseInt(o.style.height,10),l=o.parentNode,c=l.clientWidth,u=l.clientHeight,d=Math.floor(r+t),h=Math.floor(i+n);d<ie&&(d=ie),h<le&&(h=le);var m=o.offsetLeft+2*ce,p=o.offsetTop+2*ce;d+m>c&&(d=c-m),h+p>u&&(h=u-p),o.style.width=d+"px",o.style.height=h+"px",a.setState({currentX:e.clientX,currentY:e.clientY})}},a.state={currentX:0,currentY:0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){return o.a.createElement("div",{className:"grid-resizable",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},o.a.createElement(C.a,{icon:"compress",fixedWidth:!0}))}}]),t}(o.a.Component),de=a(311),he=(a(818),a(819),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).goToLink=function(e){a.props.onTableTdClick(e)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=void 0===a?[]:a,r=t.columns,s=void 0===r?[]:r,i=t.drillThrough,l=void 0===i?[]:i,c=t.error,u=[];return s.forEach(function(t){var a=t.name,n={Header:a,accessor:a};if(l.length>0){var r=l.findIndex(function(e){return e.columnName===a});if(-1!==r){var s=l[r].dashboardId;n.Cell=function(t){return o.a.createElement("span",{className:"link-label",onClick:function(){return e.goToLink("/workspace/dashboard/".concat(s,"?").concat(a,"=").concat(t.value))}},t.value)}}}u.push(n)}),c?o.a.createElement("div",null,c):o.a.createElement(de.a,{data:n,columns:u,defaultPageSize:10,previousText:"Prev",nextText:"Next"})}}]),t}(o.a.Component)),me=(a(820),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={isSelectAll:!1,searchValue:""},a.toggleSelectAll=function(){for(var e=!a.state.isSelectAll,t=Object(J.a)(a.props.checkBoxes),n=0;n<t.length;n++)t[n].isChecked=e;a.props.onChange(a.props.filterId,t),a.setState(function(e){return{isSelectAll:!e.isSelectAll}})},a.handleSearchValueChange=function(e){var t=e.target.value;if(t)for(var n=[],o=a.props.checkBoxes,r=0;r<o.length;r++)-1!==o[r].value.indexOf(t)&&n.push(o[r]);a.setState({searchValue:t})},a.handleCheckBoxChange=function(e,t){var n=Object(J.a)(a.props.checkBoxes),o=n.findIndex(function(t){return t.value===e});n[o].isChecked=t,a.props.onChange(a.props.filterId,n)},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.checkBoxes,a=(void 0===t?[]:t).map(function(t,a){return o.a.createElement(Z,{key:a,name:t.value,value:t.value,checked:t.isChecked,onChange:e.handleCheckBoxChange})});return o.a.createElement("div",null,o.a.createElement("button",{className:"button",onClick:this.toggleSelectAll},"Select All ",this.state.isSelectAll),o.a.createElement("input",{type:"text",name:"name",value:this.state.searchValue,onChange:this.handleSearchValueChange,placeholder:"Search..."}),o.a.createElement("div",{className:"slicer-body"},a))}}]),t}(o.a.Component)),pe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){console.log("GridItem onMouseDown",e),a.setState({mode:e})},a.onMouseUp=function(){console.log("GridItem onMouseUp"),a.setState({mode:""});var e=s.a.findDOMNode(Object(T.a)(Object(T.a)(a))),t=e.offsetLeft,n=e.offsetTop,o=parseInt(e.style.width,10),r=parseInt(e.style.height,10),i={id:a.props.id,x:t,y:n,width:o,height:r};a.props.onWidgetMove(i)},a.onMouseMove=function(e,t,a){e.preventDefault()},a.editWidget=function(e){a.props.onWidgetEdit(e)},a.exportCsv=function(e){},a.exportJson=function(e){},a.removeWidget=function(e){a.props.onWidgetRemove(e)},a.onTableTdPropsChange=function(e,t,n,o){return{onClick:function(e,r){console.log("A Td Element was clicked!"),console.log("it produced this event:",e),console.log("It was in this column:",n),console.log("It was in this row:",t),console.log("It was in this table instance:",o);var s=n.Header,i=t.row[s],l=o.props.widgetDrillThrough||[];console.log("onTableTdPropsChange",s,i,l);var c=l.findIndex(function(e){return e.columnName===s});if(-1!==c){var u=l[c].dashboardId;a.props.history.push("/workspace/dashboard/".concat(u,"?").concat(s,"=").concat(i))}}}},a.onChartClick=function(e,t){console.log("onChartClick",e,t)},a.onChartLegendselectchanged=function(e,t){console.log("onChartLegendselectchanged",e,t)},a.onTableTdClick=function(e){a.props.history.push(e)},a.onSlicerChange=function(e,t){var n={checkBoxes:t};a.props.onWidgetFilterInputChange(e,n)},a.onSingleValueChange=function(e,t){var n={value:t.target.value};a.props.onWidgetFilterInputChange(e,n)},a.renderWidgetContent=function(){var e={click:a.onChartClick,legendselectchanged:a.onChartLegendselectchanged},t=a.props,n=t.id,r=t.type,s=t.chartType,i=t.filterType,l=t.queryResult,c=void 0===l?{}:l,u=t.drillThrough,d=t.data,h=void 0===d?{}:d,m=t.checkBoxes,p=t.value,f=ae(c.data),v=c.columns||[],g=c.error,b=o.a.createElement("div",null);if(r===V){if(s===z)b=o.a.createElement(he,{data:f,columns:v,error:g,drillThrough:u,onTableTdClick:a.onTableTdClick});else if(s===A){var E=h.pieKey,w=h.pieValue,C=oe(f,E,w);b=o.a.createElement(te.a,{option:C,className:"echarts",onEvents:e})}}else r===G&&(i===B?b=o.a.createElement(me,{filterId:n,checkBoxes:m,onChange:a.onSlicerChange}):i===q&&(b=o.a.createElement("input",{type:"text",value:p,onChange:function(e){return a.onSingleValueChange(n,e)}})));return b},a.state={mode:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){var e=this,t=this.props,a=t.id,n=t.title,r=t.isEditMode,s=t.style,i=void 0===s?{}:s,l=i.showBorder,c=void 0!==l&&l,u=(i.showTitle,c?"2px solid #4b4f56":"2px solid #FFFFFF"),d={left:this.props.x+"px",top:this.props.y+"px",width:this.props.width+"px",height:this.props.height+"px",zIndex:1,border:u};return o.a.createElement("div",{className:"grid-box",style:d},o.a.createElement("div",{className:"grid-box-title"},n,r?o.a.createElement("div",{className:"float-right",style:{marginRight:"20px"}},o.a.createElement("div",{className:"inline-block",onClick:function(){return e.editWidget(a)}},o.a.createElement(C.a,{icon:"edit",fixedWidth:!0})),o.a.createElement("div",{className:"inline-block",onClick:function(){return e.removeWidget(a)}},o.a.createElement(C.a,{icon:"trash-alt",fixedWidth:!0}))):o.a.createElement("div",{className:"grid-box-file-button-group"},o.a.createElement("div",{className:"inline-block",onClick:function(){return e.exportJson(a)}},o.a.createElement(C.a,{icon:"file-export",fixedWidth:!0})),o.a.createElement("div",{className:"inline-block",onClick:function(){return e.exportCsv(a)}},o.a.createElement(C.a,{icon:"file-csv",fixedWidth:!0})))),o.a.createElement("div",{className:"grid-box-content"},this.renderWidgetContent()),r&&o.a.createElement(se,{onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,mode:this.state.mode,snapToGrid:this.props.snapToGrid}),r&&o.a.createElement(ue,{onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,mode:this.state.mode}))}}]),t}(o.a.Component),fe=Object(v.a)(pe),ve=(a(821),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.width,n=t.height,r=t.backgroundColor,s=t.widgets,i=void 0===s?[]:s,l={width:a+"px",height:n+"px",backgroundColor:r};t.showGridlines&&(l.backgroundSize="15px 15px",l.backgroundImage="radial-gradient(rgb(63, 93, 131) 10%, transparent 10%)");var c=i.map(function(t,a){return o.a.createElement(fe,Object.assign({key:a,snapToGrid:e.props.snapToGrid,isEditMode:e.props.isEditMode},t,{onWidgetMove:e.props.onWidgetMove,onWidgetEdit:e.props.onWidgetEdit,onWidgetRemove:e.props.onWidgetRemove,onWidgetFilterInputChange:e.props.onWidgetFilterInputChange}))});return o.a.createElement("div",{className:"grid-layout",style:l},c)}}]),t}(o.a.Component)),ge=1200,be=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).resizeGrid=function(e){var t=a.state.widgets,n=Object(J.a)(t),o=e-10;a.resizeWidgetsToActual(n,o),a.setState({widgets:n,gridWidth:o})},a.resizeWidgetsToBase=function(e,t){for(var n=0;n<e.length;n++){var o=a.scaleToBase(e[n].x,t),r=a.scaleToBase(e[n].width,t);e[n].x=o,e[n].width=r}},a.resizeWidgetsToActual=function(e,t){for(var n=0;n<e.length;n++){var o=a.scaleToActual(e[n].x,t),r=a.scaleToActual(e[n].width,t);e[n].x=o,e[n].width=r}},a.scaleToActual=function(e,t){return Math.round(e*t/ge)},a.scaleToBase=function(e,t){return Math.round(e*ge/t)},a.fetchWidgets=function(e,t){null!==e&&b.a.get("/ws/widget/dashboard/".concat(e)).then(function(e){var n=e.data;a.setState({widgets:n},function(){a.resizeGrid(t),a.queryFilters(),a.queryCharts()})})},a.handleCheckBoxChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.handleHeightChange=function(e){a.props.onHeightChange(e.target.value)},a.onBackgroundColorChange=function(e){a.props.onBackgroundColorChange(e)},a.saveWidgets=function(){var e=JSON.parse(JSON.stringify(a.state.widgets)),t=a.state.gridWidth;a.resizeWidgetsToBase(e,t),b.a.post("/ws/widget/position",e).then(function(e){})},a.onWidgetMove=function(e){var t=a.state.widgets,n=t.findIndex(function(t){return t.id===e.id}),o=Object(J.a)(t);o[n].x=e.x,o[n].y=e.y,o[n].width=e.width,o[n].height=e.height,a.setState({widgets:o})},a.confirmDelete=function(){var e=a.state.objectToDelete;b.a.delete("/ws/widget/".concat(e)).then(function(t){var n=a.state.widgets,o=n.findIndex(function(t){return t.id===e}),r=Object(J.a)(n);r.splice(o,1),a.setState({widgets:r}),a.closeConfirmDeletionPanel()})},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.onWidgetFilterInputChange=function(e,t){var n=a.state.widgets,o=void 0===n?[]:n,r=o.findIndex(function(t){return t.id===e}),s=Object(J.a)(o),i=o[r];if(i.filterType===B){var l=t.checkBoxes;s[r].checkBoxes=l}else if(i.filterType===q){var c=t.value;s[r].value=c}a.setState({widgets:s})},a.getFilterParams=function(){for(var e=a.state.widgets,t=void 0===e?[]:e,n=[],o=0;o<t.length;o++){var r=t[o];if(r.type===G){var s=r.filterType,i={};if(s===B){for(var l=r.checkBoxes,c=void 0===l?[]:l,u=[],d=0;d<c.length;d++){var h=c[d];h.isChecked&&u.push(h.value)}i.value=u,u.length===c.length&&(i.remark="select all")}else s===q&&(i.value=r.value);i.param=r.data.queryParameter,i.type=r.filterType,n.push(i)}}return n},a.state={widgets:[],gridWidth:1200,snapToGrid:!1,showGridlines:!1,showConfirmDeletionPanel:!1,objectToDelete:{}},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"queryCharts",value:function(){for(var e=this.getFilterParams(),t=this.state.widgets,a=0;a<t.length;a++){var n=t[a],o=n.id;n.type===V&&this.queryChart(o,e)}}},{key:"queryFilters",value:function(){for(var e=this.state.widgets,t=0;t<e.length;t++){var a=e[t],n=a.id,o=a.type,r=a.filterType;o===G&&this.queryFilter(n,r)}}},{key:"queryChart",value:function(e,t){var a=this,n=null===t?[]:t,o=this.state.widgets;b.a.post("/ws/jdbcquery/widget/".concat(e),n).then(function(e){var t=e.data,n=o.findIndex(function(e){return e.id===t.id}),r=Object(J.a)(o);r[n].queryResult=t,a.setState({widgets:r})})}},{key:"queryFilter",value:function(e,t){var a=this,n=this.state.widgets;if(t===B)b.a.post("/ws/jdbcquery/widget/".concat(e),[]).then(function(e){for(var t=e.data,o=ae(t.data),r=[],s=0;s<o.length;s++)for(var i=Object.values(o[s]),l=0;l<i.length;l++){var c=i[l];r.push({value:c,isChecked:!1})}var u=n.findIndex(function(e){return e.id===t.id}),d=Object(J.a)(n);d[u].queryResult=t,d[u].checkBoxes=r,a.setState({widgets:d})});else if(t===q){var o=n.findIndex(function(t){return t.id===e}),r=Object(J.a)(n);r[o].value="",this.setState({widgets:r})}}},{key:"render",value:function(){var e={width:this.props.widgetViewWidth+"px"};return o.a.createElement("div",{className:"dashboard-content-widget-panel",style:e},this.props.isEditMode&&o.a.createElement("div",{className:"dashboard-attribute-edit-panel"},o.a.createElement("div",{className:"inline-block"},"Height:"),o.a.createElement("input",{type:"text",name:"height",value:this.props.height,onChange:this.handleHeightChange,className:"inline-block",style:{width:"200px"}}),o.a.createElement("div",null,"Background Color",o.a.createElement($,{value:this.props.backgroundColor,onChange:this.onBackgroundColorChange})),o.a.createElement(Z,{name:"snapToGrid",value:"Snap to grid",checked:this.state.snapToGrid,onChange:this.handleCheckBoxChange}),o.a.createElement(Z,{name:"showGridlines",value:"Show gridlines",checked:this.state.showGridlines,onChange:this.handleCheckBoxChange})),o.a.createElement(ve,{width:this.state.gridWidth,height:this.props.height,backgroundColor:this.props.backgroundColor,snapToGrid:this.state.snapToGrid,showGridlines:this.state.showGridlines,widgets:this.state.widgets,isEditMode:this.props.isEditMode,onWidgetMove:this.onWidgetMove,onWidgetEdit:this.props.onWidgetEdit,onWidgetRemove:this.openConfirmDeletionPanel,onWidgetFilterInputChange:this.onWidgetFilterInputChange}),o.a.createElement(M,{show:this.state.showConfirmDeletionPanel,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete this widget?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}}]),t}(o.a.Component),Ee=a(310),we=a.n(Ee),Ce=(a(827),a(828),a(829),a(830),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleTabClick=function(e){a.setState({activeTab:e})},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.activeTab;this.setState({activeTab:e})}},{key:"render",value:function(){for(var e=this,t=this.props.children,a=this.state.activeTab,n=[],r=null,s=0;s<t.length;s++)t[s]&&function(){var i=t[s].props.title,l="";i===a&&(l="tab-header-active",r=t[s].props.children),n.push(o.a.createElement("li",{className:"tab-header-item ".concat(l),key:s,onClick:function(){return e.handleTabClick(i)}},i))}();return o.a.createElement("div",{className:"tab-container"},o.a.createElement("ul",{className:"tab-header"},n),o.a.createElement("div",{className:"tab-content"},r))}}]),t}(o.a.Component)),ye=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleOptionChange=function(e){var t=a.props.name,n=e.target.value;a.props.onChange(t,n)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.options,n=void 0===a?[]:a,r=e.optionValue,s=e.optionDisplay,i=e.preloadOneEmpty,l=[];return(void 0===i||i)&&l.push(o.a.createElement("option",{value:"",key:""})),n.forEach(function(e,t){var a,n;r&&s?(a=e[r],n=e[s]):(a=e,n=e),l.push(o.a.createElement("option",{value:a,key:t},n))}),o.a.createElement("select",{value:t,onChange:this.handleOptionChange},l)}}]),t}(o.a.Component),ke=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchWidget=function(){var e=Object(x.a)(P.a.mark(function e(t){var n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState(a.initialState),e.next=3,I();case 3:n=e.sent,a.setState({jdbcDataSources:n}),b.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({drillDashboards:t})}),null===t?a.setState({widgetId:null}):(a.setState({widgetId:t}),b.a.get("/ws/widget/"+t).then(function(e){var n=e.data,o=n.type,r=n.chartType,s=n.filterType,i=n.drillThrough;if(o===V){if(a.setState({chartType:r,drillThrough:i}),r===A){var l=n.data,c=l.pieKey,u=l.pieValue;a.setState({pieKey:c,pieValue:u})}}else if(o===G){var d=n.data.queryParameter;a.setState({filterType:s,queryParameter:d})}a.setState({widgetId:t,title:n.title,x:n.x,y:n.y,width:n.width,height:n.height,sqlQuery:n.sqlQuery,type:o,jdbcDataSourceId:n.jdbcDataSourceId,style:n.style},function(){a.runQuery()})}));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleCheckBoxChange=function(e,t){var n=Object(Y.a)({},a.state.style);n[[e]]=t,a.setState({style:n})},a.handleAceEditorChange=function(e){a.setState({sqlQuery:e})},a.handleIntegerOptionChange=function(e,t){var n=parseInt(t,10)||0;a.setState(Object(y.a)({},e,n))},a.handleOptionChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.save=function(){var e=a.state,t=e.widgetId,n=e.title,o=e.jdbcDataSourceId,r=e.sqlQuery,s=e.type,i=e.style,l={title:n,dashboardId:a.props.dashboardId,type:s,jdbcDataSourceId:o,sqlQuery:r,style:i};if(s===V){var c=a.state,u=c.chartType,d=c.drillThrough;if(l.drillThrough=d,l.chartType=u,u===z);else if(u===A){var h=a.state,m=h.pieKey,p=h.pieValue;l.data={pieKey:m,pieValue:p}}}else if(s===G){var f=a.state,v=f.filterType,g=f.queryParameter;l.filterType=v,l.data={queryParameter:g}}null===t?b.a.post("/ws/widget",l).then(function(e){a.props.onSave()}):(l.id=t,b.a.put("/ws/widget",l).then(function(e){a.props.onSave()}))},a.runQuery=function(){var e={jdbcDataSourceId:a.state.jdbcDataSourceId,sqlQuery:a.state.sqlQuery};b.a.post("/ws/jdbcquery/query",e).then(function(e){var t=e.data;a.setState({queryResult:t})})},a.addDrillThrough=function(){var e=a.state,t=e.drillThrough,n=e.drillColumnName,o=e.drillDashboardId;if(-1===t.findIndex(function(e){return e.columnName===n})){var r=Object(J.a)(t);r.push({columnName:n,dashboardId:o}),a.setState({drillThrough:r})}},a.removeDrillThrough=function(e){var t=a.state.drillThrough,n=t.findIndex(function(t){return t.columnName===e.columnName&&t.dashboardId===e.dashboardId});if(-1!==n){var o=Object(J.a)(t);o.splice(n,1),a.setState({drillThrough:o})}},a.generateChart=function(){if(a.state.chartType===A){var e=a.state,t=e.pieKey,n=e.pieValue,o=e.queryResult,r=void 0===o?{}:o;console.log("generateChart",t,n);var s=ae(r.data),i=oe(s,t,n);a.setState({chartOption:i})}},a.renderChartPreview=function(){var e=a.state,t=e.chartType,n=e.queryResult,r=(void 0===n?{}:n).columns||[],s=o.a.createElement("div",null,"NOT SUPPORTED");if(t===z);else if(t===A){var i=a.state,l=i.chartOption,c=i.pieKey,u=i.pieValue;s=o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("i",{class:"fas fa-chart-pie"})," Pie Chart"),o.a.createElement("div",null,'Count "value" by "key"'),o.a.createElement("label",null,"Aggr Key (string)"),o.a.createElement(ye,{name:"pieKey",value:c,onChange:a.handleOptionChange,options:r,optionDisplay:"name",optionValue:"name"}),o.a.createElement("label",null,"By Aggr Value (number)"),o.a.createElement(ye,{name:"pieValue",value:u,onChange:a.handleOptionChange,options:r,optionDisplay:"name",optionValue:"name"}),o.a.createElement("button",{onClick:a.generateChart},"Generete Chart"),o.a.createElement(te.a,{option:l,style:{height:"350px",width:"100%"},className:"react_for_echarts"}))}return s},a.state=a.initialState,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.type,n=t.queryResult,r=t.jdbcDataSources,s=void 0===r?[]:r,i=t.drillThrough,l=void 0===i?[]:i,c=t.drillDashboards,u=void 0===c?[]:c,d=ae(n.data),h=n.columns||[],m=n.error,p=l.map(function(t){return o.a.createElement("div",{key:t.columnName},o.a.createElement("div",null,"Column: ",t.columnName),o.a.createElement("div",null,"Dashboard: ",t.dashboardId),o.a.createElement("button",{onClick:function(){return e.removeDrillThrough(t)}},"delete"))}),f=h.map(function(e){return o.a.createElement("div",{key:e.name},e.name," ",e.dataType)}),v=a===V||a===G&&this.state.filterType===B;return o.a.createElement("div",null,o.a.createElement("button",{className:"button",onClick:this.save},"Save"),o.a.createElement("div",{className:"row mt-5"},o.a.createElement("div",{className:"float-left"},"Type:"),o.a.createElement("div",{className:"float-left"},o.a.createElement(ye,{name:"type",value:a,onChange:this.handleOptionChange,options:L,preloadOneEmpty:!1}))),o.a.createElement("div",{className:"mt-5"},o.a.createElement(Ce,{activeTab:"Basic"},o.a.createElement("div",{title:"Basic"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Title"),o.a.createElement("input",{type:"text",name:"title",value:this.state.title,onChange:this.handleInputChange})),o.a.createElement(Z,{name:"showBorder",value:"Show border",checked:this.state.style.showBorder,onChange:this.handleCheckBoxChange}),o.a.createElement(Z,{name:"showTitle",value:"Show title",checked:this.state.style.showTitle,onChange:this.handleCheckBoxChange})),a===G&&o.a.createElement("div",{title:"Filter"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Filter Options"),o.a.createElement(ye,{name:"filterType",value:this.state.filterType,onChange:this.handleOptionChange,options:F,preloadOneEmpty:!1}))),v&&o.a.createElement("div",{title:"Query"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"DataSource"),o.a.createElement(ye,{name:"jdbcDataSourceId",value:this.state.jdbcDataSourceId,onChange:this.handleIntegerOptionChange,options:s,optionDisplay:"name",optionValue:"id"}),o.a.createElement("label",null,"SQL Query"),o.a.createElement(we.a,{style:{marginTop:"8px"},value:this.state.sqlQuery,mode:"mysql",theme:"xcode",name:"blah2",onChange:this.handleAceEditorChange,height:"300px",width:"100%",fontSize:15,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!0,setOptions:{showLineNumbers:!0,tabSize:2}}),o.a.createElement("div",{className:"mt-3"},o.a.createElement("button",{className:"button",onClick:this.runQuery},"Run Query")),o.a.createElement("label",null,"Result"),o.a.createElement(he,{data:d,columns:h,error:m}),o.a.createElement("label",null,"Columns Mapping"),o.a.createElement("div",null,f))),a===V&&o.a.createElement("div",{title:"Chart"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Chart Options"),o.a.createElement(ye,{name:"chartType",value:this.state.chartType,onChange:this.handleOptionChange,options:K,preloadOneEmpty:!1}),o.a.createElement("label",null,"Preview"),this.renderChartPreview())),a===V&&o.a.createElement("div",{title:"Drill through"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Drill through"),o.a.createElement("label",null,"Column"),o.a.createElement(ye,{name:"drillColumnName",value:this.state.drillColumnName,options:h,onChange:this.handleOptionChange,optionDisplay:"name",optionValue:"name"}),o.a.createElement("label",null,"Dashboard"),o.a.createElement(ye,{name:"drillDashboardId",value:this.state.drillDashboardId,options:u,onChange:this.handleIntegerOptionChange,optionDisplay:"name",optionValue:"id"}),o.a.createElement("div",null,p),o.a.createElement("button",{className:"button",onClick:this.addDrillThrough},"Add"))),a===G&&o.a.createElement("div",{title:"Query parameter"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Parameter"),o.a.createElement("input",{type:"text",name:"queryParameter",value:this.state.queryParameter,onChange:this.handleInputChange}))))))}},{key:"initialState",get:function(){return{jdbcDataSources:[],widgetId:null,title:"",sqlQuery:"",jdbcDataSourceId:"",queryResult:{},type:V,filterType:q,chartType:z,style:{showBorder:!1,showTitle:!0},queryParameter:"",drillThrough:[],drillDashboards:[],drillColumnName:"",drillDashboardId:"",pieKey:"",pieValue:"",chartOption:{}}}}]),t}(o.a.Component),Oe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).loadViewByDashboardName=function(){var e=a.props.location.search,t=new URLSearchParams(e).get("name"),n=a.getPageWidth();a.setState({isReadOnly:!0,name:t,widgetViewWidth:n},function(){b.a.get("/ws/dashboard/name/".concat(t)).then(function(e){var t=e.data;a.setState({dashboardId:t.id,name:t.name,style:t.style},function(){a.refresh()})})})},a.handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.getPageWidth=function(){return s.a.findDOMNode(Object(T.a)(Object(T.a)(a))).clientWidth-40},a.toggleAutoRefresh=function(){var e=a.state.autoRefreshTimerId;if(e)clearInterval(e),a.setState({autoRefreshTimerId:""});else{var t=a.state.refreshInterval,n=parseInt(t,10)||15;n=n<1?1:n;var o=setInterval(function(){a.queryWidgets(),a.updateLastRefreshed()},1e3*n);a.setState({autoRefreshTimerId:o})}},a.refresh=function(){a.refreshWidgetView(),a.updateLastRefreshed()},a.refreshWidgetView=function(){var e=a.state,t=e.dashboardId,n=e.widgetViewWidth;a.widgetViewPanel.current.fetchWidgets(t,n,null)},a.queryWidgets=function(){a.widgetViewPanel.current.queryCharts()},a.updateLastRefreshed=function(){var e=(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1");a.setState({lastRefreshed:e})},a.save=function(){console.log("save");var e=a.state,t=e.dashboardId,n={id:t,name:e.name,style:e.style};b.a.put("/ws/dashboard/",n).then(function(e){}),a.widgetViewPanel.current.saveWidgets(),a.props.onDashboardSave(t),a.setState({isEditMode:!1})},a.edit=function(){a.setState({isEditMode:!0})},a.cancelEdit=function(){a.setState({isEditMode:!1})},a.onSaveWidget=function(){a.setState({showWidgetEditPanel:!1}),a.refreshWidgetView()},a.openWidgetEditPanel=function(e){a.widgetEditPanel.current.fetchWidget(e),a.setState({showWidgetEditPanel:!0})},a.applyFilters=function(e){a.widgetViewPanel.current.queryWidgets(e)},a.fullScreen=function(){var e=a.state.name,t="/workspace/dashboard/view?name=".concat(e);window.open(t,"_blank")},a.onTableCellClick=function(){a.props.history.push("/workspace/dashboard/drill?name=&")},a.onHeightChange=function(e){var t=Object(Y.a)({},a.state.style);t.height=e,a.setState({style:t})},a.onBackgroundColorChange=function(e){var t=Object(Y.a)({},a.state.style);t.backgroundColor=e,a.setState({style:t})},a.confirmDelete=function(){var e=a.state.objectToDelete,t=(void 0===e?{}:e).id;b.a.delete("/ws/dashboard/".concat(t)).then(function(e){a.props.onDashboardDelete(t),a.closeConfirmDeletionPanel()})},a.deleteDashboard=function(){var e=a.state,t={id:e.dashboardId,name:e.name};a.openConfirmDeletionPanel(t)},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.state={showWidgetEditPanel:!1,showConfirmDeletionPanel:!1,objectToDelete:{},isEditMode:!1,isReadOnly:!1,autoRefreshTimerId:"",lastRefreshed:"",refreshInterval:15,jdbcDataSourceOptions:[],dashboardId:0,name:"",style:{},widgetViewWidth:1e3},a.widgetViewPanel=o.a.createRef(),a.widgetEditPanel=o.a.createRef(),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id,a=void 0!==t?t:null;console.log("DashboardEditView - componentDidMount",a);var n=this.props.location.search,o=new URLSearchParams(n),r=!0,s=!1,i=void 0;try{for(var l,c=o.entries()[Symbol.iterator]();!(r=(l=c.next()).done);r=!0){var u=l.value;console.log(u[0]+", "+u[1])}}catch(h){s=!0,i=h}finally{try{r||null==c.return||c.return()}finally{if(s)throw i}}var d=this.getPageWidth();this.setState({widgetViewWidth:d},function(){null===a?e.setState({dashboardId:null}):b.a.get("/ws/dashboard/".concat(a)).then(function(t){var a=t.data;e.setState({dashboardId:a.id,name:a.name,style:a.style},function(){e.refresh()})})})}},{key:"componentWillUnmount",value:function(){var e=this.state.autoRefreshTimerId;e&&clearInterval(e)}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.autoRefreshTimerId,r=a.lastRefreshed,s=a.isEditMode,i=a.isReadOnly,l=""===n?"OFF":"ON",c=null,u=o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:"mr-3"},"Last refreshed: ",r),"OFF"===l&&o.a.createElement("input",{type:"text",name:"refreshInterval",value:this.state.refreshInterval,onChange:this.handleInputChange,className:"inline-block",style:{width:"50px"}}),o.a.createElement("button",{className:"button square-button mr-3",onClick:this.toggleAutoRefresh},"ON"===l?o.a.createElement(C.a,{icon:"stop-circle",size:"lg",fixedWidth:!0}):o.a.createElement(C.a,{icon:"play-circle",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button square-button",onClick:this.refresh},o.a.createElement(C.a,{icon:"redo-alt",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button mr-3",onClick:this.queryWidgets},"Apply Filters"));return i?c=u:e=s?o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{className:"button mr-3",onClick:this.cancelEdit},"Cancel"),o.a.createElement("button",{className:"button mr-3",onClick:this.save},"Save"),o.a.createElement("button",{className:"button mr-3",onClick:this.deleteDashboard},"Delete"),o.a.createElement("button",{className:"button",onClick:function(){return t.openWidgetEditPanel(null)}},"Add Widget")):o.a.createElement(o.a.Fragment,null,u,o.a.createElement("button",{className:"button square-button mr-3",onClick:this.fullScreen},o.a.createElement(C.a,{icon:"tv",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button",onClick:this.edit},"Edit")),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"dashboard-menu-panel row"},o.a.createElement("div",{className:"float-left"},i||!s?o.a.createElement("div",{className:"dashboard-name"},this.state.name):o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange,className:"dashboard-name"})),o.a.createElement("div",{className:"float-right"},c,e)),o.a.createElement(be,Object.assign({ref:this.widgetViewPanel,isEditMode:this.state.isEditMode,widgetViewWidth:this.state.widgetViewWidth,onWidgetEdit:this.openWidgetEditPanel,onHeightChange:this.onHeightChange,onBackgroundColorChange:this.onBackgroundColorChange},this.state.style)),o.a.createElement(M,{show:this.state.showWidgetEditPanel,onClose:function(){return t.setState({showWidgetEditPanel:!1})},modalClass:"dashboard-edit-widget-dialog",title:"Widget Edit"},o.a.createElement(ke,{ref:this.widgetEditPanel,jdbcDataSourceOptions:this.state.jdbcDataSourceOptions,dashboardId:this.state.dashboardId,onSave:this.onSaveWidget})),o.a.createElement(M,{show:this.state.showConfirmDeletionPanel,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",this.state.objectToDelete.name,"?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}}]),t}(o.a.Component),je=Object(v.a)(Oe),Se=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchBoards=function(){b.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({dashboards:t})})},a.handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.closeEditPanel=function(){a.setState({showEditPanel:!1,name:""})},a.save=function(){var e=a.state.name;if(e){var t={name:e,style:{height:X,backgroundColor:"rgba(233, 235, 238, 1)"}};b.a.post("/ws/dashboard",t).then(function(e){var t=e.data;a.closeEditPanel(),a.fetchBoards(),a.props.history.push("/workspace/dashboard/".concat(t))}).catch(function(e){U.show("The name exists. Try another.")})}else U.show("Enter a name.")},a.view=function(e){a.setState({activeDashboardId:e},function(){a.props.history.push("/workspace/dashboard/".concat(e))})},a.onDashboardSave=function(e){a.fetchBoards()},a.onDashboardDelete=function(e){a.fetchBoards(),a.setState({activeDashboardId:0},function(){a.props.history.push("/workspace/dashboard")})},a.state={searchValue:"",dashboards:[],showEditPanel:!1,activeDashboardId:0,name:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.location.pathname,t=e.indexOf("/workspace/dashboard/");if(-1!==t){var a=Number(e.substring(t+"/workspace/dashboard/".length));this.setState({activeDashboardId:a})}this.fetchBoards()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.dashboards,n=void 0===a?[]:a,r=t.activeDashboardId,s=t.searchValue,i=this.props.sysRole!==H,l=[],c=function(t){var a=n[t],i=a.name,c=r===a.id?"dashboard-menu-item-active":"";(!s||s&&i.includes(s))&&l.push(o.a.createElement("div",{key:t,className:"dashboard-menu-item ellipsis ".concat(c),onClick:function(){return e.view(a.id)}},i))},u=0;u<n.length;u++)c(u);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"dashboard-sidebar"},o.a.createElement("div",{style:{margin:"5px"}},i&&o.a.createElement("button",{className:"button icon-button dashboard-add-button",onClick:function(){return e.setState({showEditPanel:!0})}},o.a.createElement(C.a,{icon:"plus"})," New"),o.a.createElement("input",{type:"text",name:"searchValue",value:this.state.searchValue,placeholder:"Search...",onChange:this.handleInputChange,style:{marginTop:"5px"}})),o.a.createElement("div",null,l)),o.a.createElement("div",{className:"dashboard-content"},o.a.createElement(p.a,{path:"/workspace/dashboard/:id",render:function(t){return o.a.createElement(je,{key:t.match.params.id,onDashboardSave:e.onDashboardSave,onDashboardDelete:e.onDashboardDelete})}})),o.a.createElement(M,{show:this.state.showEditPanel,onClose:function(){return e.setState({showEditPanel:!1})},modalClass:"small-modal-panel",title:"New"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),o.a.createElement("button",{className:"button",onClick:this.save},"Save"))))}}]),t}(n.Component),De=Object(v.a)(Se),Ne=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleOptionChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.handleIntegerOptionChange=function(e,t){var n=parseInt(t,10)||0;a.setState(Object(y.a)({},e,n))},a.fetchUsers=function(){b.a.get("/ws/user").then(function(e){var t=e.data;a.setState({users:t})})},a.fetchGroups=function(){b.a.get("/ws/group").then(function(e){var t=e.data;a.setState({groups:t})})},a.openEditPanel=function(e){null!==e?a.setState({id:e.id,username:e.username,name:e.name,tempPassword:"",sysRole:e.sysRole,userGroups:e.userGroups}):a.clearEditPanel(),a.setState({userGroupId:"",showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.clearEditPanel=function(){a.setState(a.initialEditPanelState)},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.save=function(){var e=a.state,t=e.showUpdatePassword,n=e.id,o=e.username,r=e.name,s=e.tempPassword,i=e.sysRole,l=e.userGroups;if(o){var c=H;if(Q===a.props.sysRole){if(!i)return;c=i}var u={username:o,name:r,sysRole:c,userGroups:l};null!==n?(u.id=n,t&&s&&(u.tempPassword=s),b.a.put("/ws/user",u).then(function(e){a.clearEditPanel(),a.closeEditPanel(),a.fetchUsers()})):(u.tempPassword=s,b.a.post("/ws/user",u).then(function(e){a.clearEditPanel(),a.closeEditPanel(),a.fetchUsers()}))}},a.delete=function(e){b.a.delete("/ws/user/"+e).then(function(e){a.fetchUsers()})},a.addUserGroup=function(){var e=a.state,t=e.userGroupId,n=e.userGroups,o=void 0===n?[]:n;if(-1===o.findIndex(function(e){return e===t})){var r=Object(J.a)(o);r.push(t),a.setState({userGroups:r})}},a.removeUserGroup=function(e){var t=a.state.userGroups,n=void 0===t?[]:t,o=n.findIndex(function(t){return t===e});if(-1!==o){var r=Object(J.a)(n);r.splice(o,1),a.setState({userGroups:r})}},a.state={users:[],groups:[],searchValue:"",showUpdatePassword:!1,showEditPanel:!1,id:null,username:"",name:"",tempPassword:"",sysRole:H,userGroupId:"",userGroups:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchUsers(),this.fetchGroups()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.id,n=t.showUpdatePassword,r=t.users,s=void 0===r?[]:r,i=t.groups,l=void 0===i?[]:i,c=t.userGroups,u=void 0===c?[]:c,d=this.props.sysRole,h=null===a?"New":"Edit",m=s.map(function(t){return o.a.createElement("div",{key:t.id,className:"user-card"},o.a.createElement("p",null,t.username,t.name,t.sysRole,o.a.createElement("button",{className:"button",onClick:function(){return e.openEditPanel(t)}},"update"),o.a.createElement("button",{className:"button",onClick:function(){return e.delete(t.id)}},"delete")))}),p=[],f=function(t){for(var a=u[t],n=0;n<l.length;n++)if(a===l[n].id){p.push(o.a.createElement("div",{key:a},o.a.createElement("div",null,"Group: ",l[n].name),o.a.createElement("button",{className:"button",onClick:function(){return e.removeUserGroup(a)}},"delete")));break}},v=0;v<u.length;v++)f(v);return o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("input",{type:"text",name:"searchValue",value:this.state.searchValue,onChange:this.handleInputChange,placeholder:"Search...",style:{width:"200px"}}),o.a.createElement("button",{className:"button",onClick:this.clearSearch},"Clear"),o.a.createElement("button",{className:"button",onClick:function(){return e.openEditPanel(null)}},o.a.createElement(C.a,{icon:"plus"})," New User")),o.a.createElement("div",{className:"row"},m),o.a.createElement(M,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"mid-modal-panel",title:h},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Username"),o.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange}),o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),"Edit"===h&&o.a.createElement("div",{style:{margin:"3px 0px 8px 0px"}},o.a.createElement("button",{className:"button",onClick:this.toggleUpdatePassword},"Update password")),("New"===h||n)&&o.a.createElement("div",null,o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"tempPassword",value:this.state.tempPassword,onChange:this.handleInputChange})),o.a.createElement("label",null,"System Role"),Q===d&&o.a.createElement(ye,{name:"sysRole",value:this.state.sysRole,onChange:this.handleOptionChange,options:[H,"developer"]}),"developer"===d&&o.a.createElement("div",null,H),o.a.createElement("br",null),o.a.createElement("label",null,"Groups"),o.a.createElement(ye,{name:"userGroupId",value:this.state.userGroupId,onChange:this.handleIntegerOptionChange,options:l,optionDisplay:"name",optionValue:"id"}),o.a.createElement("button",{className:"button",onClick:this.addUserGroup},"Add"),o.a.createElement("div",null,p),o.a.createElement("button",{className:"button",onClick:this.save},"Save"))))}},{key:"initialEditPanelState",get:function(){return{id:null,username:"",name:"",tempPassword:"",sysRole:"",userGroupId:"",userGroups:[]}}}]),t}(o.a.Component),Pe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleIntegerOptionChange=function(e,t){var n=parseInt(t,10)||0;a.setState(Object(y.a)({},e,n))},a.fetchGroups=function(){b.a.get("/ws/group").then(function(e){var t=e.data;a.setState({groups:t})})},a.fetchDashboards=function(){b.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({dashboards:t})})},a.openEditPanel=function(e){null!==e?a.setState({id:e.id,name:e.name,groupDashboards:e.groupDashboards}):a.clearEditPanel(),a.setState({groupDashboardId:"",showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.clearEditPanel=function(){a.setState(a.initialEditPanelState)},a.save=function(){var e=a.state,t=e.id,n={name:e.name,groupDashboards:e.groupDashboards};null!==t?(n.id=t,b.a.put("/ws/group",n).then(function(e){a.clearEditPanel(),a.fetchGroups(),a.closeEditPanel()})):b.a.post("/ws/group",n).then(function(e){a.clearEditPanel(),a.fetchGroups(),a.closeEditPanel()})},a.delete=function(e){b.a.delete("/ws/group/"+e).then(function(e){a.fetchGroups()})},a.addGroupDashboard=function(){var e=a.state,t=e.groupDashboardId,n=e.groupDashboards,o=void 0===n?[]:n;if(t&&-1===o.findIndex(function(e){return e===t})){var r=Object(J.a)(o);r.push(t),a.setState({groupDashboards:r})}},a.removeGroupDashboard=function(e){var t=a.state.groupDashboards,n=void 0===t?[]:t,o=n.findIndex(function(t){return t===e});if(-1!==o){var r=Object(J.a)(n);r.splice(o,1),a.setState({groupDashboards:r})}},a.state={groups:[],dashboards:[],showEditPanel:!1,searchValue:"",id:null,name:"",groupDashboardId:"",groupDashboards:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchGroups(),this.fetchDashboards()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.id,n=t.groups,r=void 0===n?[]:n,s=t.dashboards,i=void 0===s?[]:s,l=t.groupDashboards,c=void 0===l?[]:l,u=null===a?"New":"Edit",d=r.map(function(t){return o.a.createElement("div",{key:t.id,className:"group-card"},o.a.createElement("p",null,t.name,o.a.createElement("button",{className:"button",onClick:function(){return e.openEditPanel(t)}},"update"),o.a.createElement("button",{className:"button",onClick:function(){return e.delete(t.id)}},"delete")))}),h=[],m=function(t){for(var a=c[t],n=0;n<i.length;n++)if(a===i[n].id){h.push(o.a.createElement("div",{key:a},o.a.createElement("div",null,"Name: ",i[n].name),o.a.createElement("button",{className:"button",onClick:function(){return e.removeGroupDashboard(a)}},"delete")));break}},p=0;p<c.length;p++)m(p);return o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("input",{type:"text",name:"searchValue",value:this.state.searchValue,onChange:this.handleInputChange,placeholder:"Search...",style:{width:"200px"}}),o.a.createElement("button",{className:"button",onClick:this.clearSearch},"Clear"),o.a.createElement("button",{className:"button",onClick:function(){return e.openEditPanel(null)}},o.a.createElement(C.a,{icon:"plus"})," New Group")),o.a.createElement("div",{className:"row"},d),o.a.createElement(M,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"mid-modal-panel",title:u},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),o.a.createElement("label",null,"Dashboards"),o.a.createElement(ye,{name:"groupDashboardId",value:this.state.groupDashboardId,onChange:this.handleIntegerOptionChange,options:i,optionDisplay:"name",optionValue:"id"}),o.a.createElement("button",{className:"button",onClick:this.addGroupDashboard},"Add"),o.a.createElement("div",null,h),o.a.createElement("button",{className:"button",onClick:this.save},"Save"))))}},{key:"initialEditPanelState",get:function(){return{id:null,name:"",groupDashboardId:"",groupDashboards:[]}}}]),t}(o.a.Component),xe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"full-page-content"},o.a.createElement(Ce,{activeTab:"Group"},o.a.createElement("div",{title:"Group"},o.a.createElement(Pe,null)),o.a.createElement("div",{title:"User"},o.a.createElement(Ne,this.props))))}}]),t}(o.a.Component),Ie=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.fetchUser=function(){b.a.get("/ws/user/account").then(function(e){var t=e.data;a.setState({id:t.id,username:t.username,name:t.name,sysRole:t.sysRole,apiKey:t.apiKey})})},a.generateApiKey=function(){},a.save=function(){var e=a.state,t=e.showUpdatePassword,n=e.name,o=e.password,r=e.confirmedPassword,s={name:n};if(t){if(o!==r)return;s.password=o}b.a.put("/ws/user/account",s).then(function(e){})},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.state={showUpdatePassword:!1,id:null,username:"",name:"",sysRole:"",apiKey:"",password:"",confirmedPassword:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchUser()}},{key:"render",value:function(){var e=this.state,t=e.showUpdatePassword,a=e.username,n=e.sysRole,r=e.apiKey;return o.a.createElement("div",{className:"full-page-content"},o.a.createElement("div",null,"Account"),o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Username"),o.a.createElement("div",null,a),o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),o.a.createElement("label",null,"System Role"),o.a.createElement("div",null,n),o.a.createElement("label",null,"API Key"),o.a.createElement("div",null,r),o.a.createElement("button",{className:"button",onClick:this.generateApiKey},"Generate new API Key"),o.a.createElement("br",null),o.a.createElement("button",{className:"button",onClick:this.toggleUpdatePassword},"Update password"),t&&o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange}),o.a.createElement("label",null,"Confirm Password"),o.a.createElement("input",{type:"password",name:"confirmedPassword",value:this.state.confirmedPassword,onChange:this.handleInputChange})),o.a.createElement("br",null),o.a.createElement("button",{className:"button",onClick:this.save},"Save")))}}]),t}(o.a.Component),Me=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){console.log("DashboardFullScreenView","componentDidMount"),this.dashboardEditView.loadViewByDashboardName()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"full-screen-view"},o.a.createElement(je,{wrappedComponentRef:function(t){return e.dashboardEditView=t}}))}}]),t}(o.a.Component),Te=(a(831),[{link:"/workspace/dashboard",value:"Dashboard",icon:"chalkboard"},{link:"/workspace/datasource",value:"Data Source",icon:"database"},{link:"/workspace/usermanagement",value:"User Management",icon:"users-cog"}]),We=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleMenuClick=function(e){a.setState({currentMenuLink:e})},a.logout=function(){b.a.get("/auth/logout").then(function(e){a.props.onLogout()})},a.state={currentMenuLink:"/workspace/dashboard"},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t=this.props.location.pathname;t.startsWith("/workspace/account")?e="/workspace/account":e=Te.find(function(e){return t.startsWith(e.link)}).link;this.setState({currentMenuLink:e})}},{key:"render",value:function(){var e=this,t=this.state.currentMenuLink;console.log("Workspace - render");var a=this.props,n=a.username,r=a.sysRole,s=[],i=[];i=r===H?Te.filter(function(e){return"/workspace/dashboard"===e.link}):Te;for(var l=function(a){var n=i[a],r=t===n.link?"menu-item-active":"";s.push(o.a.createElement("li",{key:n.link,className:r},o.a.createElement(D.a,{to:n.link,onClick:function(){return e.handleMenuClick(n.link)}},o.a.createElement(C.a,{icon:n.icon,fixedWidth:!0}),o.a.createElement("span",{className:"workspace-nav-menu-text"},n.value))))},c=0;c<i.length;c++)l(c);var u="/workspace/account"===t?"menu-item-active":"";return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"workspace-nav"},o.a.createElement("div",{className:"workspace-name"},"Poli"),o.a.createElement("ul",{className:"workspace-nav-menu"},s),o.a.createElement("div",{className:"workspace-account-menu"},o.a.createElement("div",{className:"workspace-account-button inline-block ".concat(u)},o.a.createElement(D.a,{to:"/workspace/account",onClick:function(){return e.handleMenuClick("/workspace/account")}},o.a.createElement(C.a,{icon:"user",fixedWidth:!0}),o.a.createElement("span",{className:"workspace-nav-menu-text"},n))),o.a.createElement("div",{className:"workspace-logout-button inline-block",onClick:this.logout},o.a.createElement(C.a,{icon:"sign-out-alt",fixedWidth:!0})))),o.a.createElement("div",{className:"workspace-content"},o.a.createElement(m.a,null,o.a.createElement(p.a,{exact:!0,path:"/workspace/datasource",component:R}),o.a.createElement(p.a,{exact:!0,path:"/workspace/account",component:Ie}),o.a.createElement(p.a,{exact:!0,path:"/workspace/dashboard/view",component:Me}),o.a.createElement(p.a,{exact:!0,path:"/workspace/usermanagement",render:function(){return o.a.createElement(xe,e.props)}}),o.a.createElement(p.a,{path:"/workspace/dashboard",render:function(){return o.a.createElement(De,e.props)}}))),o.a.createElement(U,null))}}]),t}(o.a.Component),Ue=Object(v.a)(We),Re=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("h1",null,"PageNotFound"),o.a.createElement(D.a,{to:"/login"},"Login"))}}]),t}(o.a.Component);E.b.add(w.a,w.d,w.s,w.k,w.o,w.e,w.p,w.i,w.n,w.l,w.q,w.j,w.r,w.m,w.c,w.f,w.h,w.g,w.b);var Ve=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onLoginSuccess=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.tempPassword?a.props.history.push("/changepassword"):a.setState({username:e.username,sysRole:e.sysRole,isAuthorizing:!1},function(){var e="/workspace/dashboard";t&&(e=t),a.props.history.push(e)})},a.onLogout=function(){a.setState({username:"",sysRole:"",isAuthorizing:!1},function(){a.props.history.push("/login")})},a.state={username:"",sysRole:"",isAuthorizing:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.pathname,a=this.props.location.search,n=(new URLSearchParams(a).get("apiKey"),t+a),o=!1;this.state.sysRole&&(o=!0),o||this.setState({isAuthorizing:!0},function(){b.a.post("/auth/login/cookie").then(function(t){var a=t.data;a.error?e.setState({sysRole:"",isAuthorizing:!1},function(){e.props.history.push("/login")}):e.onLoginSuccess(a,n)})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.sysRole,r=t.isAuthorizing,s=!1;return n&&(s=!0),r?o.a.createElement(C.a,{icon:"cicle-notch",spin:!0,size:"3x"}):o.a.createElement("div",{className:"app"},o.a.createElement(m.a,null,o.a.createElement(p.a,{exact:!0,path:"/",render:function(){return o.a.createElement(O,{sysRole:n,onLoginSuccess:e.onLoginSuccess})}}),o.a.createElement(p.a,{path:"/login",render:function(){return o.a.createElement(O,{sysRole:n,onLoginSuccess:e.onLoginSuccess})}}),o.a.createElement(p.a,{path:"/changepassword",component:S}),o.a.createElement(Ge,{authenticated:s,path:"/workspace",component:Ue,username:a,sysRole:n,onLogout:this.onLogout}),o.a.createElement(p.a,{component:Re})))}}]),t}(o.a.Component);function Ge(e){var t=e.component,a=e.authenticated,n=Object(i.a)(e,["component","authenticated"]);return o.a.createElement(p.a,Object.assign({},n,{render:function(e){return!0===a?o.a.createElement(t,Object.assign({},e,n)):o.a.createElement(f.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var Le=Object(v.a)(Ve),Be=a(836);s.a.render(o.a.createElement(Be.a,{basename:"/poli"},o.a.createElement(Le,null)),document.getElementById("root"))}},[[313,1,2]]]);
//# sourceMappingURL=main.bfc93c3d.chunk.js.map