(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{311:function(e,t,a){},315:function(e,t,a){e.exports=a(834)},320:function(e,t,a){},339:function(e,t,a){},345:function(e,t,a){},348:function(e,t,a){},349:function(e,t,a){},350:function(e,t,a){},351:function(e,t,a){},352:function(e,t,a){},823:function(e,t,a){},824:function(e,t,a){},830:function(e,t,a){},831:function(e,t,a){},832:function(e,t,a){},833:function(e,t,a){},834:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(31),s=a.n(o),i=a(314),l=a(5),c=a(6),u=a(8),d=a(7),h=a(9),m=a(840),p=a(835),f=a(837),v=(a(320),a(20)),g=a(839),b=a(10),E=a.n(b),w=new(function(){function e(){Object(l.a)(this,e),this._sysRole="",this._username=""}return Object(c.a)(e,[{key:"sysRole",set:function(e){this._sysRole=e},get:function(){return this._sysRole}},{key:"username",set:function(e){this._username=e},get:function(){return this._username}},{key:"isAuthenticated",get:function(){return!0}}]),e}()),y=(a(339),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.tryLogin=function(){E.a.post("/auth/login/cookie").then(function(e){e.data})},a.login=function(e){e.preventDefault();var t=a.state,n=t.username,r=t.password,o={username:n,password:r};n?r?(w.username="testuser",w.sysRole="developer",a.props.history.push("/workspace/dashboard"),E.a.post("/auth/login/user",o).then(function(e){e.data})):a.setState({errorMsg:"Enter password"}):a.setState({errorMsg:"Enter username"})},a.state={errorMsg:"",username:"",password:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.tryLogin()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"login-panel"},r.a.createElement("div",{className:"login-app-title"},"Poli"),r.a.createElement("div",{className:"login-error-msg"},this.state.errorMsg),r.a.createElement("form",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Username"),r.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange}),r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange})),r.a.createElement("button",{className:"button login-button",onClick:this.login},"Login"))))}}]),t}(r.a.Component)),C=Object(g.a)(y),k=a(836),O=a(32),j=a.n(O),S=a(47),D=function(){var e=Object(S.a)(j.a.mark(function e(){var t;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.a.get("/ws/jdbcdatasource");case 3:return t=e.sent,e.abrupt("return",t.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(S.a)(j.a.mark(function e(t){return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("/ws/filter/dashboard/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(S.a)(j.a.mark(function e(t){var a;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.a.get(t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),P=(a(345),a(15)),I=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.show,n=t.modalClass,o=void 0===n?"":n,s=t.title,i=t.children,l=a?"display-block":"display-none";return r.a.createElement("div",{className:"modal-overlay ".concat(l)},r.a.createElement("div",{className:"modal-panel ".concat(o)},r.a.createElement("div",{className:"model-header row"},r.a.createElement("div",{className:"model-title"},s),r.a.createElement("button",{className:"model-close-button icon-button",onClick:function(){return e.props.onClose()}},r.a.createElement(P.a,{icon:"times",size:"lg"}))),r.a.createElement("hr",null),r.a.createElement("div",{className:"modal-body"},i)))}}]),t}(r.a.Component),M=a(21),W=(a(348),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).show=function(e){a.setState({showToast:!0,message:e},function(){setTimeout(function(){a.hide()},3e3)})},a.hide=function(){a.setState({showToast:!1,message:""})},a.state={showToast:!1,message:""},t._toastRef=Object(M.a)(Object(M.a)(a)),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state,t=e.showToast,a=e.message,n=t?"display-block":"display-none";return r.a.createElement("div",{className:"toast-container ".concat(n)},r.a.createElement("button",{onClick:this.hide},"X"),r.a.createElement("div",null,a))}}]),t}(r.a.Component));W.show=function(){W._toastRef.show()};var T=W,U=(a(349),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.save=function(){var e=a.state,t=e.showUpdatePassword,n=e.id,r=e.connectionUrl,o=e.driverClassName,s=e.username,i=e.password,l=e.name,c=e.ping;if(l){var u={connectionUrl:r,driverClassName:o,username:s,name:l,ping:c};null!==n?(u.id=n,t&&(u.password=i),E.a.put("/ws/jdbcdatasource",u).then(function(e){a.closeEditPanel(),a.fetchDataSources()}).catch(function(e){console.log(e)})):(u.password=i,E.a.post("/ws/jdbcdatasource",u).then(function(e){a.closeEditPanel(),a.fetchDataSources()}).catch(function(e){console.log(e)}))}},a.confirmDelete=function(){var e=a.state.datasourceToDelete,t=void 0===e?{}:e;E.a.delete("/ws/jdbcdatasource/"+t.id).then(function(e){a.fetchDataSources(),a.closeConfirmDeletionPanel()})},a.ping=function(e){E.a.get("/ws/jdbcdatasource/ping/".concat(e)).then(function(e){T.show("ping"+e.data)})},a.clearEditPanel=function(){a.setState(a.initialState)},a.openEditPanel=function(e){null!==e?a.setState({showUpdatePassword:!1,id:e.id,connectionUrl:e.connectionUrl,driverClassName:e.driverClassName,username:e.username,password:e.password,name:e.name,ping:e.ping}):a.clearEditPanel(),a.setState({showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.openConfirmDeletionPanel=function(e){a.setState({datasourceToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({datasourceToDelete:{},showConfirmDeletionPanel:!1})},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.clearSearch=function(){a.setState({searchValue:""})},a.state={jdbcDataSources:[],showEditPanel:!1,showConfirmDeletionPanel:!1,datasourceToDelete:{},showUpdatePassword:!1,searchValue:"",id:null,name:"",connectionUrl:"",driverClassName:"",username:"",password:"",ping:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchDataSources()}},{key:"fetchDataSources",value:function(){var e=Object(S.a)(j.a.mark(function e(){var t;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:t=e.sent,this.setState({jdbcDataSources:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){for(var e=this,t=this.state,a=t.showUpdatePassword,n=t.showConfirmDeletionPanel,o=t.searchValue,s=t.id,i=t.jdbcDataSources,l=void 0===i?[]:i,c=t.datasourceToDelete,u=void 0===c?{}:c,d=null===s?"New":"Edit",h=[],m=function(t){var a=l[t],n=a.name;(!o||o&&n.includes(o))&&h.push(r.a.createElement("div",{key:t,className:"datasource-card row"},r.a.createElement("div",{className:"float-left ellipsis datasource-row-name"},n),r.a.createElement("div",{className:"float-right"},r.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.openEditPanel(a)}},r.a.createElement(P.a,{icon:"edit",size:"lg"})),r.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.openConfirmDeletionPanel(a)}},r.a.createElement(P.a,{icon:"trash-alt",size:"lg"})),r.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.ping(a.id)}},r.a.createElement(P.a,{icon:"plug",size:"lg"})))))},p=0;p<l.length;p++)m(p);return r.a.createElement("div",null,r.a.createElement("input",{type:"text",name:"searchValue",value:this.state.searchValue,onChange:this.handleInputChange,placeholder:"Search...",style:{width:"200px"}}),r.a.createElement("button",{className:"button",onClick:this.clearSearch},"Clear"),r.a.createElement("button",{className:"button",onClick:function(){return e.openEditPanel(null)}},r.a.createElement(P.a,{icon:"plus"})," New datasource"),r.a.createElement("div",{className:"table-panel"},h),r.a.createElement(I,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"small-modal-panel",title:d},r.a.createElement("div",null,r.a.createElement("label",null,"Name ",r.a.createElement("span",{className:"required"},"*")),r.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),r.a.createElement("label",null,"Connection Url"),r.a.createElement("textarea",{rows:"4",type:"text",name:"connectionUrl",value:this.state.connectionUrl,onChange:this.handleInputChange}),r.a.createElement("label",null,"Driver class name"),r.a.createElement("input",{type:"text",name:"driverClassName",value:this.state.driverClassName,onChange:this.handleInputChange}),r.a.createElement("label",null,"Username"),r.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange}),"Edit"===d?r.a.createElement("div",{style:{margin:"3px 0px 8px 0px"}},r.a.createElement("button",{className:"button",onClick:this.toggleUpdatePassword},"Update password")):null,"New"===d||a?r.a.createElement("div",null,r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange})):null,r.a.createElement("label",{className:"mt-3"},"Ping"),r.a.createElement("input",{type:"text",name:"ping",value:this.state.ping,onChange:this.handleInputChange}),r.a.createElement("button",{className:"button mt-3",onClick:this.save},"Save"))),r.a.createElement(I,{show:n,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},r.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",u.name,"?"),r.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}},{key:"initialState",get:function(){return{showUpdatePassword:!1,id:null,name:"",connectionUrl:"",driverClassName:"",username:"",password:"",ping:""}}}]),t}(n.Component)),R=a(182),V=a(23),G=(a(350),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).toggle=function(){var e=a.props,t=e.name,n=e.checked;a.props.onChange(t,!n)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a={backgroundColor:e.checked?"#000000":"#FFFFFF"};return r.a.createElement("div",{className:"checkbox-container",onClick:this.toggle},r.a.createElement("div",{className:"checkbox-checkmark"},r.a.createElement("div",{className:"checkbox-checkmark-box",style:a})),r.a.createElement("div",{className:"checkbox-label"},t))}}]),t}(r.a.Component)),F=(a(351),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={isSelectAll:!1,searchValue:""},a.toggleSelectAll=function(){for(var e=!a.state.isSelectAll,t=Object(V.a)(a.props.checkBoxes),n=0;n<t.length;n++)t[n].isChecked=e;a.props.onChange(a.props.filterId,t),a.setState(function(e){return{isSelectAll:!e.isSelectAll}})},a.handleSearchValueChange=function(e){var t=e.target.value;if(t)for(var n=[],r=a.props.checkBoxes,o=0;o<r.length;o++)-1!==r[o].value.indexOf(t)&&n.push(r[o]);a.setState({searchValue:t})},a.handleCheckBoxChange=function(e,t){var n=Object(V.a)(a.props.checkBoxes),r=n.findIndex(function(t){return t.value===e});n[r].isChecked=t,a.props.onChange(a.props.filterId,n)},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.checkBoxes,a=(void 0===t?[]:t).map(function(t,a){return r.a.createElement(G,{key:a,name:t.value,value:t.value,checked:t.isChecked,onChange:e.handleCheckBoxChange})});return r.a.createElement("div",null,r.a.createElement("button",{className:"button",onClick:this.toggleSelectAll},"Toggle Select All ",this.state.isSelectAll),r.a.createElement("input",{type:"text",name:"name",value:this.state.searchValue,onChange:this.handleSearchValueChange}),r.a.createElement("div",{className:"slicer-body"},a))}}]),t}(r.a.Component)),q=(r.a.Component,function(e){return!Array.isArray(e)||!e.length}),A="slicer",L="single",B=[A,L],Q="pie",z="table",K=[z,Q],H=200,_=600,X=(a(352),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchFilters=function(e){null!==e&&(a.setState({dashboardId:e}),E.a.get("/ws/filter/dashboard/"+e).then(function(e){var t=e.data;a.setState({filters:t},a.queryFilters)}))},a.queryFilters=function(){for(var e=a.state.filters,t=0;t<e.length;t++){var n=e[t];if(n.type===A){var r=n.data;E.a.post("/ws/jdbcquery/filter/"+n.id,r).then(function(t){var n=t.data,r=JSON.parse(n.data),o=e.findIndex(function(e){return e.id===n.id}),s=Object(V.a)(a.state.filters);s[o].queryResult=r;var i=s[o].type;if(i===A){var l=[];if(!q(r))for(var c=0;c<r.length;c++)for(var u=Object.values(r[c]),d=0;d<u.length;d++){var h=u[d];l.push({value:h,isChecked:!1})}s[o].checkBoxes=l}else if(i===L){for(var m="",p=Object.values(r),f=0;f<p.length;f++){m=p[f];break}s[o].value=m}a.setState({filters:s})})}}},a.renderFilterPanel=function(){for(var e=[],t=a.state.filters,n=function(n){var o=t[n],s=r.a.createElement("div",null,"NONE");if(o.type===A){var i=o.checkBoxes;s=r.a.createElement(F,{key:n,filterId:o.id,checkBoxes:i,onChange:a.onSlicerChange})}else o.type===L&&(s=r.a.createElement("input",{type:"text",value:o.value,onChange:function(e){return a.onSingleValueChange(o.id,e)}}));e.push(r.a.createElement("div",{className:"filter-card"},r.a.createElement("div",{className:"filter-card-title"},o.name,a.props.isEditMode?r.a.createElement("div",{className:"icon-button-group"},r.a.createElement("div",{className:"inline-block",onClick:function(){return a.edit(o.id)}},r.a.createElement(P.a,{icon:"edit",fixedWidth:!0})),r.a.createElement("div",{className:"inline-block",onClick:function(){return a.remove(o.id)}},r.a.createElement(P.a,{icon:"trash-alt",fixedWidth:!0}))):null),r.a.createElement("div",null,s)))},o=0;o<t.length;o++)n(o);return e},a.edit=function(e){a.props.onEdit(e)},a.remove=function(e){E.a.delete("/ws/filter/"+e).then(function(t){var n=a.state.filters.findIndex(function(t){return t.id===e}),r=Object(V.a)(a.state.filters);r.splice(n,1),a.setState({filters:r})})},a.onSlicerChange=function(e,t){var n=a.state.filters.findIndex(function(t){return t.id===e}),r=Object(V.a)(a.state.filters);r[n].checkBoxes=Object(V.a)(t),a.setState({filters:r})},a.onSingleValueChange=function(e,t){var n=a.state.filters,r=t.target.value,o=n.findIndex(function(t){return t.id===e}),s=Object(V.a)(n);s[o].value=r,a.setState({filters:s})},a.applyFilters=function(){for(var e=a.state.filters,t=[],n=0;n<e.length;n++){var r=e[n],o={};if(r.type===A){for(var s=r.checkBoxes,i=[],l=0;l<s.length;l++){var c=s[l];c.isChecked&&i.push(c.value)}o.value=i,i.length===s.length&&(o.remark="select all")}else r.type===L&&(o.value=r.value);o.param=r.data.param,o.type=r.type,t.push(o)}a.props.onApplyFilters(t)},a.state={dashboardId:null,filters:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.show,t={};return t.width=e?H+"px":"0px",r.a.createElement("div",{className:"dashboard-content-filter-panel",style:t},r.a.createElement("div",null,"Filters"),r.a.createElement("button",{className:"button",onClick:this.applyFilters},"Run"),r.a.createElement("div",{className:"filterViewPanel"},this.renderFilterPanel()))}}]),t}(n.Component)),J=a(62),Y=(a(83),a(313)),$=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleClick=function(){a.setState(function(e){return{showPalette:!e.showPalette}})},a.handleClose=function(){a.setState({showPalette:!1})},a.handleChange=function(e){var t=e.rgb,n="rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")");a.props.onChange(n)},a.state={showPalette:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={width:"36px",height:"14px",borderRadius:"2px",background:this.props.value};return r.a.createElement("div",null,r.a.createElement("div",{style:{padding:"5px",background:"#fff",borderRadius:"1px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:this.handleClick},r.a.createElement("div",{style:e})),this.state.showPalette?r.a.createElement("div",{style:{position:"absolute",zIndex:"2"}},r.a.createElement("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:this.handleClose}),r.a.createElement(Y.ChromePicker,{color:this.props.value,onChange:this.handleChange})):null)}}]),t}(r.a.Component),Z=2,ee=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){e.preventDefault();for(var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).parentNode,n=e.clientX-t.offsetLeft,r=e.clientY-t.offsetTop,o=document.getElementsByClassName("grid-box"),i=0;i<o.length;i++)o[i].style.zIndex=20;t.style.zIndex=30;var l=t.ownerDocument;l.addEventListener("mouseup",a.onMouseUp),l.addEventListener("mousemove",a.onMouseMove),a.setState({xOffset:n,yOffset:r}),a.props.onMouseDown("drag")},a.onMouseUp=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a)));if(t){var n=t.ownerDocument;n.removeEventListener("mousedown",a.onMouseDown),n.removeEventListener("mouseup",a.onMouseUp),n.removeEventListener("mousemove",a.onMouseMove)}a.props.onMouseUp()},a.onMouseMove=function(e){if(e.preventDefault(),"drag"===a.props.mode){var t=1;a.props.snapToGrid&&(t=4);var n=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).parentNode,r=e.clientX-a.state.xOffset,o=e.clientY-a.state.yOffset,i=n.parentNode,l=i.clientWidth,c=i.clientHeight,u=parseInt(n.style.width,10)+2*Z,d=parseInt(n.style.height,10)+2*Z;r<0&&(r=0),o<0&&(o=0),r+u>l&&(r=l-u),o+d>c&&(o=c-d),r=Math.floor(r/t)*t,o=Math.floor(o/t)*t,n.style.left=r+"px",n.style.top=o+"px"}},a.state={xOffset:0,yOffset:0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){return r.a.createElement("div",{className:"grid-draggable",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},r.a.createElement(P.a,{icon:"expand-arrows-alt",fixedWidth:!0}))}}]),t}(r.a.Component),te=30,ae=30,ne=2,re=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))),n=e.clientX,r=e.clientY,o=t.ownerDocument;o.addEventListener("mouseup",a.onMouseUp),o.addEventListener("mousemove",a.onMouseMove),a.setState({currentX:n,currentY:r}),a.props.onMouseDown("resize")},a.onMouseUp=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a)));if(t){var n=t.ownerDocument;n.removeEventListener("mousedown",a.onMouseDown),n.removeEventListener("mouseup",a.onMouseUp),n.removeEventListener("mousemove",a.onMouseMove)}a.props.onMouseUp()},a.onMouseMove=function(e){if(e.preventDefault(),"resize"===a.props.mode){var t=e.clientX-a.state.currentX,n=e.clientY-a.state.currentY,r=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).parentNode,o=parseInt(r.style.width,10),i=parseInt(r.style.height,10),l=r.parentNode,c=l.clientWidth,u=l.clientHeight,d=Math.floor(o+t),h=Math.floor(i+n);d<te&&(d=te),h<ae&&(h=ae);var m=r.offsetLeft+2*ne,p=r.offsetTop+2*ne;d+m>c&&(d=c-m),h+p>u&&(h=u-p),r.style.width=d+"px",r.style.height=h+"px",a.setState({currentX:e.clientX,currentY:e.clientY})}},a.state={currentX:0,currentY:0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){return r.a.createElement("div",{className:"grid-resizable",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},r.a.createElement(P.a,{icon:"compress",fixedWidth:!0}))}}]),t}(r.a.Component),oe=a(138),se=a.n(oe),ie=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],le=function(e,t,a){for(var n=[],r=[],o=0;o<e.length;o++){var s=e[o];n.push(s[t]),r.push({name:s[t],value:s[a]})}return function(e,t){return{color:ie,tooltip:{},legend:{type:"scroll",orient:"vertical",data:e,right:10,top:10,bottom:10},series:[{type:"pie",center:["40%","50%"],radius:"50%",data:t}]}}(n,r)},ce=function(e){var t=[];if(!q(e))for(var a=e[0],n=Object.keys(a),r=0;r<n.length;r++){var o=n[r];t.push({Header:o,accessor:o})}return t},ue=(a(823),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=void 0===t?[]:t,n=e.drillThrough,o=void 0===n?[]:n,s=[];if(a.length>0)for(var i=a[0],l=Object.keys(i),c=function(){var e=l[u],t={Header:e,accessor:e};if(o.length>0){var a=o.findIndex(function(t){return t.columnName===e});if(-1!==a){var n=o[a].dashboardId;t.Cell=function(t){return r.a.createElement("a",{href:"/poli/workspace/dashboard/".concat(n,"?").concat(e,"=").concat(t.value)},t.value)}}}s.push(t)},u=0;u<l.length;u++)c();return r.a.createElement(J.a,{data:a,columns:s,defaultPageSize:10,previousText:"Prev",nextText:"Next"})}}]),t}(r.a.Component)),de=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){console.log("GridItem onMouseDown",e),a.setState({mode:e})},a.onMouseUp=function(){console.log("GridItem onMouseUp"),a.setState({mode:""});var e=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))),t=e.offsetLeft,n=e.offsetTop,r=parseInt(e.style.width,10),o=parseInt(e.style.height,10),i={id:a.props.id,x:t,y:n,width:r,height:o};a.props.onWidgetMove(i)},a.onMouseMove=function(e,t,a){e.preventDefault()},a.editWidget=function(e){a.props.onWidgetEdit(e)},a.exportCsv=function(e){},a.exportJson=function(e){},a.removeWidget=function(e){a.props.onWidgetRemove(e)},a.onTableTdPropsChange=function(e,t,n,r){return{onClick:function(e,o){console.log("A Td Element was clicked!"),console.log("it produced this event:",e),console.log("It was in this column:",n),console.log("It was in this row:",t),console.log("It was in this table instance:",r);var s=n.Header,i=t.row[s],l=r.props.widgetDrillThrough;if(console.log("onTableTdPropsChange",s,i,l),!q(l)){var c=l.findIndex(function(e){return e.columnName===s});if(-1!==c){var u=l[c].dashboardId;a.props.history.push("/workspace/dashboard/".concat(u,"?").concat(s,"=").concat(i))}}}}},a.onChartClick=function(e,t){console.log("onChartClick",e,t)},a.onChartLegendselectchanged=function(e,t){console.log("onChartLegendselectchanged",e,t)},a.renderWidgetContent=function(){var e={click:a.onChartClick,legendselectchanged:a.onChartLegendselectchanged},t=a.props,n=t.chartType,o=t.queryResultData,s=t.drillThrough,i=r.a.createElement("div",null);if(n===z){ce(o);i=r.a.createElement(ue,{data:o,drillThrough:s})}else if(n===Q){var l=a.props.data,c=l.pieKey,u=l.pieValue;if(!q(o)){var d=le(o,c,u);i=r.a.createElement(se.a,{option:d,className:"echarts",onEvents:e})}}return i},a.state={mode:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){var e=this,t={left:this.props.x+"px",top:this.props.y+"px",width:this.props.width+"px",height:this.props.height+"px",zIndex:1};return r.a.createElement("div",{className:"grid-box",style:t},r.a.createElement("div",{className:"grid-box-title"},this.props.name,this.props.isEditMode?r.a.createElement("div",{className:"float-right",style:{marginRight:"20px"}},r.a.createElement("div",{className:"inline-block",onClick:function(){return e.editWidget(e.props.id)}},r.a.createElement(P.a,{icon:"edit",fixedWidth:!0})),r.a.createElement("div",{className:"inline-block",onClick:function(){return e.removeWidget(e.props.id)}},r.a.createElement(P.a,{icon:"trash-alt",fixedWidth:!0}))):r.a.createElement("div",{className:"grid-box-file-button-group"},r.a.createElement("div",{className:"inline-block",onClick:function(){return e.exportJson(e.props.id)}},r.a.createElement(P.a,{icon:"file-export",fixedWidth:!0})),r.a.createElement("div",{className:"inline-block",onClick:function(){return e.exportCsv(e.props.id)}},r.a.createElement(P.a,{icon:"file-csv",fixedWidth:!0})))),r.a.createElement("div",{className:"grid-box-content"},this.renderWidgetContent()),this.props.isEditMode?r.a.createElement(ee,{onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,mode:this.state.mode,snapToGrid:this.props.snapToGrid}):null,this.props.isEditMode?r.a.createElement(re,{onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,mode:this.state.mode}):null)}}]),t}(r.a.Component),he=Object(g.a)(de),me=(a(824),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.width,n=t.height,o=t.backgroundColor,s=t.widgets,i=void 0===s?[]:s,l={width:a+"px",height:n+"px",backgroundColor:o};t.showGridlines&&(l.backgroundSize="15px 15px",l.backgroundImage="radial-gradient(rgb(63, 93, 131) 10%, transparent 10%)");var c=i.map(function(t,a){return r.a.createElement(he,Object.assign({key:a,snapToGrid:e.props.snapToGrid,isEditMode:e.props.isEditMode},t,{onWidgetMove:e.props.onWidgetMove,onWidgetEdit:e.props.onWidgetEdit,onWidgetRemove:e.props.onWidgetRemove}))});return r.a.createElement("div",{className:"grid-layout",style:l},c)}}]),t}(r.a.Component)),pe=1200,fe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).resizeGrid=function(e,t){var n=a.state.gridWidth,r=a.state.widgets,o=Object(V.a)(r);t&&a.resizeWidgetsToBase(o,n);var s=e-10;a.resizeWidgetsToActual(o,s),a.setState({widgets:o,gridWidth:s})},a.resizeWidgetsToBase=function(e,t){for(var n=0;n<e.length;n++){var r=a.scaleToBase(e[n].x,t),o=a.scaleToBase(e[n].width,t);e[n].x=r,e[n].width=o}},a.resizeWidgetsToActual=function(e,t){for(var n=0;n<e.length;n++){var r=a.scaleToActual(e[n].x,t),o=a.scaleToActual(e[n].width,t);e[n].x=r,e[n].width=o}},a.scaleToActual=function(e,t){return Math.round(e*t/pe)},a.scaleToBase=function(e,t){return Math.round(e*pe/t)},a.fetchWidgets=function(e,t,n){null!==e&&E.a.get("/ws/widget/dashboard/"+e).then(function(e){var r=e.data;a.setState({widgets:r},function(){a.resizeGrid(t,!1),a.queryWidgets(n)})})},a.queryWidgets=function(e){for(var t=null===e?[]:e,n=a.state.widgets,r=0;r<n.length;r++){var o=n[r];E.a.post("/ws/jdbcquery/widget/"+o.id,t).then(function(e){var t=e.data,r=n.findIndex(function(e){return e.id===t.id}),o=Object(V.a)(n);o[r].queryResultData=JSON.parse(t.data),a.setState({widgets:o})})}},a.handleCheckBoxChange=function(e,t){a.setState(Object(v.a)({},e,t))},a.handleHeightChange=function(e){a.props.onHeightChange(e.target.value)},a.onBackgroundColorChange=function(e){a.props.onBackgroundColorChange(e)},a.saveWidgets=function(){var e=JSON.parse(JSON.stringify(a.state.widgets)),t=a.state.gridWidth;a.resizeWidgetsToBase(e,t),E.a.post("/ws/widget/position",e).then(function(e){})},a.onWidgetMove=function(e){var t=a.state.widgets,n=t.findIndex(function(t){return t.id===e.id}),r=Object(V.a)(t);r[n].x=e.x,r[n].y=e.y,r[n].width=e.width,r[n].height=e.height,a.setState({widgets:r})},a.onWidgetRemove=function(e){E.a.delete("/ws/widget/"+e).then(function(t){var n=a.state.widgets,r=n.findIndex(function(t){return t.id===e}),o=Object(V.a)(n);o.splice(r,1),a.setState({widgets:o})})},a.state={widgets:[],gridWidth:1200,snapToGrid:!1,showGridlines:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e={width:this.props.widgetViewWidth+"px"};return r.a.createElement("div",{className:"dashboard-content-widget-panel",style:e},this.props.isEditMode?r.a.createElement("div",{className:"dashboard-attribute-edit-panel"},r.a.createElement("div",{className:"inline-block"},"Height:"),r.a.createElement("input",{type:"text",name:"height",value:this.props.height,onChange:this.handleHeightChange,className:"inline-block",style:{width:"200px"}}),r.a.createElement("div",{className:"inline-block"},"Background Color"),r.a.createElement($,{value:this.props.backgroundColor,onChange:this.onBackgroundColorChange}),r.a.createElement(G,{name:"snapToGrid",value:"Snap to grid",checked:this.state.snapToGrid,onChange:this.handleCheckBoxChange}),r.a.createElement(G,{name:"showGridlines",value:"Show gridlines",checked:this.state.showGridlines,onChange:this.handleCheckBoxChange})):null,r.a.createElement(me,{width:this.state.gridWidth,height:this.props.height,backgroundColor:this.props.backgroundColor,snapToGrid:this.state.snapToGrid,showGridlines:this.state.showGridlines,widgets:this.state.widgets,isEditMode:this.props.isEditMode,onWidgetMove:this.onWidgetMove,onWidgetEdit:this.props.onWidgetEdit,onWidgetRemove:this.onWidgetRemove}))}}]),t}(r.a.Component),ve=a(139),ge=a.n(ve),be=(a(309),a(310),a(830),a(831),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleTabClick=function(e){a.setState({activeTab:e})},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.activeTab;this.setState({activeTab:e})}},{key:"render",value:function(){for(var e=this,t=this.props.children,a=void 0===t?[]:t,n=this.state.activeTab,o=[],s=null,i=function(t){var i=a[t].props.title,l="";i===n&&(l="tab-header-active",s=a[t].props.children),o.push(r.a.createElement("li",{className:"tab-header-item ".concat(l),key:t,onClick:function(){return e.handleTabClick(i)}},i))},l=0;l<a.length;l++)i(l);return r.a.createElement("div",{className:"tab-container"},r.a.createElement("ul",{className:"tab-header"},o),r.a.createElement("div",{className:"tab-content"},s))}}]),t}(r.a.Component)),Ee=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchWidget=function(){var e=Object(S.a)(j.a.mark(function e(t,n){var r,o;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState(a.initialState),e.next=3,D();case 3:return r=e.sent,a.setState({jdbcDataSources:r}),e.next=7,N(n);case 7:o=e.sent,a.setState({filters:o}),E.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({drillDashboards:t})}),null===t?(0!==r.length&&a.setState({jdbcDataSourceId:r[0].id}),0!==o.length&&a.setState({filterId:o[0].id}),a.setState({widgetId:null})):(a.setState({widgetId:t}),E.a.get("/ws/widget/"+t).then(function(e){var n=e.data;if(n.chartType===Q){var r=n.data,o=r.pieKey,s=r.pieValue;a.setState({pieKey:o,pieValue:s})}a.setState({widgetId:t,name:n.name,x:n.x,y:n.y,width:n.width,height:n.height,sqlQuery:n.sqlQuery,chartType:n.chartType,jdbcDataSourceId:n.jdbcDataSourceId,drills:n.drillThrough},function(){a.runQuery()})}));case 11:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleInputChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleAceEditorChange=function(e){a.setState({sqlQuery:e})},a.handleDataSourceChange=function(e){var t=parseInt(e.target.value,10);a.setState({jdbcDataSourceId:t})},a.handleChartTypeChange=function(e){a.setState({chartType:e.target.value})},a.handleColumnChange=function(e,t){var n=t.target.value;a.setState(Object(v.a)({},e,n))},a.handleDrillColumnChange=function(e){a.setState({drillColumnName:e.target.value})},a.handleDrillDashboardChange=function(e){var t=parseInt(e.target.value,10);a.setState({drillDashboardId:t})},a.save=function(){var e=a.state,t=e.widgetId,n=e.name,r=e.jdbcDataSourceId,o=e.sqlQuery,s=e.chartType,i=e.drills;if(n){var l={name:n,dashboardId:a.props.dashboardId,chartType:s,jdbcDataSourceId:r,sqlQuery:o,drillThrough:i};if(s===z);else if(s===Q){var c=a.state,u=c.pieKey,d=c.pieValue;l.data={pieKey:u,pieValue:d}}null===t?E.a.post("/ws/widget",l).then(function(e){a.props.onSave()}):(l.id=t,E.a.put("/ws/widget",l).then(function(e){a.props.onSave()}))}},a.runQuery=function(){var e={jdbcDataSourceId:a.state.jdbcDataSourceId,sqlQuery:a.state.sqlQuery};E.a.post("/ws/jdbcquery/query",e).then(function(e){var t=e.data,n=t.columns,r=JSON.parse(t.data);a.setState({queryResultData:r,columns:n})})},a.addDrillThrough=function(){var e=a.state,t=e.drills,n=e.drillColumnName,r=e.drillDashboardId;a.state.filterId;if(-1===t.findIndex(function(e){return e.columnName===n})){var o=Object(V.a)(t);o.push({columnName:n,dashboardId:r}),a.setState({drills:o})}},a.removeDrillThrough=function(e){var t=a.state.drills,n=t.findIndex(function(t){return t.columnName===e.columnName&&t.dashboardId===e.dashboardId});if(-1!==n){var r=Object(V.a)(t);r.splice(n,1),a.setState({drills:r})}},a.generateChart=function(){if(a.state.chartType===Q){var e=a.state,t=e.pieKey,n=e.pieValue,r=e.queryResultData;if(!q(r)){var o=le(r,t,n);a.setState({chartOption:o})}}},a.renderChartPreview=function(){var e=a.state,t=e.chartType,n=e.columns,o=(void 0===n?[]:n).map(function(e){return r.a.createElement("option",{value:e.name,key:e.name},e.name)}),s=r.a.createElement("div",null,"NOT SUPPORTED");return t===z||t===Q&&(s=r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement("i",{class:"fas fa-chart-pie"})," Pie Chart"),r.a.createElement("div",null,'Count "value" by "key"'),r.a.createElement("label",null,"Aggr Key (string)"),r.a.createElement("select",{value:a.state.pieKey,onChange:function(e){return a.handleColumnChange("pieKey",e)}},o),r.a.createElement("label",null,"By Aggr Value (number)"),r.a.createElement("select",{value:a.state.pieValue,onChange:function(e){return a.handleColumnChange("pieValue",e)}},o),r.a.createElement("button",{onClick:a.generateChart},"Generete Chart"),r.a.createElement(se.a,{option:a.state.chartOption,style:{height:"350px",width:"100%"},className:"react_for_echarts"}))),s},a.state=a.initialState,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.columns,o=a.queryResultData,s=a.jdbcDataSources,i=a.drills,l=a.drillDashboards,c=(s||[]).map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}),u=(n||[]).map(function(e){return r.a.createElement("option",{value:e.name,key:e.name},e.name)}),d=K.map(function(e){return r.a.createElement("option",{value:e,key:e},e)}),h=(l||[]).map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}),m=(i||[]).map(function(e){return r.a.createElement("div",{key:e.columnName},r.a.createElement("div",null,"Column: ",e.columnName),r.a.createElement("div",null,"Dashboard: ",e.dashboardId),r.a.createElement("button",{onClick:function(){return t.removeDrillThrough(e)}},"delete"))}),p=[];if(q(o))e=r.a.createElement("div",null,o);else{for(var f=o[0],v=Object.keys(f),g=0;g<v.length;g++){var b=v[g];p.push({Header:b,accessor:b})}e=r.a.createElement(J.a,{data:o,columns:p,minRows:0,showPagination:!1})}var E=(n||[]).map(function(e){return r.a.createElement("div",{key:e.name},e.name," ",e.dataType)});return r.a.createElement("div",null,r.a.createElement("button",{className:"button",onClick:this.save},"Save"),r.a.createElement("div",{className:"form-panel"},r.a.createElement(be,{activeTab:"basic"},r.a.createElement("div",{title:"basic"},r.a.createElement("label",null,"Name"),r.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange})),r.a.createElement("div",{title:"Query"},r.a.createElement("label",null,"DataSource"),r.a.createElement("select",{value:this.state.jdbcDataSourceId,onChange:this.handleDataSourceChange},c),r.a.createElement("label",null,"SQL Query"),r.a.createElement(ge.a,{style:{marginTop:"8px"},value:this.state.sqlQuery,mode:"mysql",theme:"xcode",name:"blah2",onChange:this.handleAceEditorChange,height:"300px",width:"100%",fontSize:15,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!0,setOptions:{showLineNumbers:!0,tabSize:2}}),r.a.createElement("button",{className:"button",onClick:this.runQuery},"Run Query"),r.a.createElement("label",null,"Result"),e,r.a.createElement("label",null,"Columns Mapping"),r.a.createElement("div",null,E)),r.a.createElement("div",{title:"Chart"},r.a.createElement("label",null,"Chart Options"),r.a.createElement("select",{value:this.state.chartType,onChange:this.handleChartTypeChange},d),r.a.createElement("label",null,"Preview"),this.renderChartPreview()),r.a.createElement("div",{title:"Drill through"},r.a.createElement("label",null,"Drill through"),r.a.createElement("label",null,"Column"),r.a.createElement("select",{value:this.state.drillColumnName,onChange:this.handleDrillColumnChange},u),r.a.createElement("label",null,"Dashboard"),r.a.createElement("select",{value:this.state.drillDashboardId,onChange:this.handleDrillDashboardChange},h),r.a.createElement("div",null,m),r.a.createElement("button",{className:"button",onClick:this.addDrillThrough},"Add")))))}},{key:"initialState",get:function(){return{jdbcDataSources:[],widgetId:null,name:"",sqlQuery:"",jdbcDataSourceId:"",columns:[],queryResultData:[],chartType:z,pieKey:"",pieValue:"",chartOption:{},drills:[],drillDashboards:[],drillColumnName:"",drillDashboardId:""}}}]),t}(r.a.Component),we=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchFilter=function(){var e=Object(S.a)(j.a.mark(function e(t){var n;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState(a.initialState),e.next=3,D();case 3:n=e.sent,a.setState({jdbcDataSources:n}),null===t?(0!==n.length&&a.setState({jdbcDataSourceId:n[0].id}),a.setState({filterId:null})):E.a.get("/ws/filter/"+t).then(function(e){var n=e.data,r=n.data,o=n.type;a.setState({filterId:t,name:n.name,type:n.type,data:r}),o===A?a.setState({sqlQuery:r.sqlQuery,jdbcDataSourceId:r.jdbcDataSourceId,param:r.param}):o===L&&a.setState({sqlQuery:r.sqlQuery,jdbcDataSourceId:r.jdbcDataSourceId,param:r.param})});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleInputChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleAceEditorChange=function(e){a.setState({sqlQuery:e})},a.handleDataSourceChange=function(e){a.setState({jdbcDataSourceId:e.target.value})},a.handleTypeChange=function(e){a.setState({type:e.target.value})},a.save=function(e){e.preventDefault();var t=a.state,n=t.filterId,r=t.name,o=t.type,s=t.jdbcDataSourceId,i=t.sqlQuery,l=t.param,c={name:r,type:o,dashboardId:a.props.dashboardId};o===A?c.data={jdbcDataSourceId:s,sqlQuery:i,param:l}:o===L&&(c.data={useQuery:!1,jdbcDataSourceId:s,sqlQuery:i,param:l}),null===n?E.a.post("/ws/filter",c).then(function(e){a.props.onSave()}):(c.id=n,E.a.put("/ws/filter",c).then(function(e){a.props.onSave()}))},a.runQuery=function(e){e.preventDefault();var t={jdbcDataSourceId:a.state.jdbcDataSourceId,sqlQuery:a.state.sqlQuery};E.a.post("/ws/jdbcquery/query",t).then(function(e){var t=e.data;a.setState({queryResult:t})})},a.state=a.initialState,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=this.state,a=t.queryResult,n=void 0===a?[]:a,o=t.jdbcDataSources,s=(void 0===o?[]:o).map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}),i=B.map(function(e){return r.a.createElement("option",{value:e,key:e},e)}),l=[];if(q(n))e=r.a.createElement("div",null,n);else{console.log("queryResult",n);for(var c=n[0],u=Object.keys(c),d=0;d<u.length;d++){var h=u[d];l.push({Header:h,accessor:h})}e=r.a.createElement(J.a,{data:this.state.queryResult,columns:l,minRows:0,showPagination:!1})}return r.a.createElement("div",null,r.a.createElement("button",{className:"button",onClick:this.save},"Save"),r.a.createElement("button",{className:"button",onClick:this.runQuery},"Run"),r.a.createElement("div",{className:"form-panel"},r.a.createElement("label",null,"Name"),r.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),r.a.createElement("label",null,"Type"),r.a.createElement("select",{value:this.state.type,onChange:this.handleTypeChange},i),r.a.createElement("label",null,"DataSource"),r.a.createElement("select",{value:this.state.jdbcDataSourceId,onChange:this.handleDataSourceChange},s),r.a.createElement("label",null,"SQL Query"),r.a.createElement(ge.a,{style:{marginTop:"8px"},value:this.state.sqlQuery,mode:"mysql",theme:"xcode",name:"blah2",onChange:this.handleAceEditorChange,height:"300px",width:"100%",fontSize:15,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!0,setOptions:{showLineNumbers:!0,tabSize:2}}),r.a.createElement("label",null,"Result"),e,r.a.createElement("label",null,"Param"),r.a.createElement("input",{type:"text",name:"param",value:this.state.param,onChange:this.handleInputChange})))}},{key:"initialState",get:function(){return{jdbcDataSources:[],filterId:null,name:"",type:A,data:{},sqlQuery:"",jdbcDataSourceId:"",queryResult:[],param:""}}}]),t}(r.a.Component),ye=(a(311),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).loadViewByDashboardName=function(){var e=a.props.location.search,t=new URLSearchParams(e),n=t.get("name"),r="true"==t.get("showFilter"),o=a.getPageWidth(),s=r?o-H:o;a.setState({pageWidth:o,widgetViewWidth:s,isReadOnly:!0,name:n,showFilterViewPanel:r},function(){E.a.get("/ws/dashboard/name/".concat(n)).then(function(e){var t=e.data;a.setState({dashboardId:t.id,name:t.name,style:t.style},function(){a.refresh()})})})},a.getPageWidth=function(){return s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).clientWidth-40},a.handleInputChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.toggleAutoRefresh=function(){var e=a.state.autoRefreshTimerId;if(e)clearInterval(e),a.setState({autoRefreshTimerId:""});else{var t=setInterval(function(){a.refreshWidgetView()},1e3);a.setState({autoRefreshTimerId:t})}},a.refresh=function(){console.log("refresh"),a.refreshWidgetView(),a.refreshFilterView()},a.refreshFilterView=function(){var e=a.state.dashboardId;a.filterViewPanel.current.fetchFilters(e)},a.refreshWidgetView=function(){var e=a.state,t=e.dashboardId,n=e.widgetViewWidth;a.widgetViewPanel.current.fetchWidgets(t,n,null);var r=(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1");a.setState({lastRefreshed:r})},a.save=function(){console.log("save");var e=a.state,t=e.dashboardId,n={id:t,name:e.name,style:e.style};E.a.put("/ws/dashboard/",n).then(function(e){}),a.widgetViewPanel.current.saveWidgets(),a.props.onSaveDashboard(t),a.setState({isEditMode:!1})},a.edit=function(){a.setState({isEditMode:!0})},a.cancelEdit=function(){a.setState({isEditMode:!1})},a.delete=function(){var e=a.state.dashboardId;console.log("delete",e),E.a.delete("/ws/dashboard/".concat(e)).then(function(e){})},a.onSaveWidget=function(){a.setState({showWidgetEditPanel:!1}),a.refreshWidgetView()},a.onSaveFilter=function(){a.setState({showFilterEditPanel:!1}),a.refreshFilterView()},a.toggleFilterViewPanel=function(){var e=a.state.showFilterViewPanel;a.resizePageLayout(!e)},a.resizePageLayout=function(e){var t=a.getPageWidth(),n=e?t-H:t;a.widgetViewPanel.current.resizeGrid(n,!0),a.setState({showFilterViewPanel:e,widgetViewWidth:n})},a.openFilterEditPanel=function(e){a.filterEditPanel.current.fetchFilter(e),a.setState({showFilterEditPanel:!0})},a.openWidgetEditPanel=function(e){var t=a.state.dashboardId;a.widgetEditPanel.current.fetchWidget(e,t),a.setState({showWidgetEditPanel:!0})},a.applyFilters=function(e){a.widgetViewPanel.current.queryWidgets(e)},a.fullScreen=function(){var e=a.state.name,t="/workspace/dashboard/view?name=".concat(e);window.open(t,"_blank")},a.onTableCellClick=function(){a.props.history.push("/workspace/dashboard/drill?name=&")},a.onHeightChange=function(e){var t=Object(R.a)({},a.state.style);t.height=e,a.setState({style:t})},a.onBackgroundColorChange=function(e){var t=Object(R.a)({},a.state.style);t.backgroundColor=e,a.setState({style:t})},a.state={showWidgetEditPanel:!1,showFilterEditPanel:!1,showFilterViewPanel:!0,isEditMode:!1,isReadOnly:!1,autoRefreshTimerId:"",lastRefreshed:"",jdbcDataSourceOptions:[],dashboardId:0,name:"",style:{},widgetViewWidth:1e3},a.filterViewPanel=r.a.createRef(),a.filterEditPanel=r.a.createRef(),a.widgetViewPanel=r.a.createRef(),a.widgetEditPanel=r.a.createRef(),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id,a=void 0!==t?t:null;console.log("DashboardEditView",a);var n=this.props.location.search;console.log("url",n);var r=new URLSearchParams(n);console.log("params",r);var o=!0,s=!1,i=void 0;try{for(var l,c=r.entries()[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;console.log(u[0]+", "+u[1])}}catch(m){s=!0,i=m}finally{try{o||null==c.return||c.return()}finally{if(s)throw i}}var d=this.getPageWidth(),h=this.state.showFilterViewPanel?d-H:d;console.log("componentDidMount",d,h),this.setState({pageWidth:d,widgetViewWidth:h},function(){null===a?e.setState({dashboardId:null}):E.a.get("/ws/dashboard/".concat(a)).then(function(t){var a=t.data;e.setState({dashboardId:a.id,name:a.name,style:a.style},function(){e.refresh()})})})}},{key:"componentWillUnmount",value:function(){var e=this.state.autoRefreshTimerId;e&&clearInterval(e)}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.autoRefreshTimerId,o=a.lastRefreshed,s=a.isEditMode,i=a.isReadOnly,l=""===n?"OFF":"ON",c=null,u=r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"mr-3"},"Last refreshed: ",o),r.a.createElement("button",{className:"button square-button mr-3",onClick:this.toggleAutoRefresh},"ON"===l?r.a.createElement(P.a,{icon:"stop-circle",size:"lg",fixedWidth:!0}):r.a.createElement(P.a,{icon:"play-circle",size:"lg",fixedWidth:!0})),r.a.createElement("button",{className:"button square-button mr-3",onClick:this.refresh},r.a.createElement(P.a,{icon:"redo-alt",size:"lg",fixedWidth:!0})),r.a.createElement("button",{className:"button mr-3",onClick:this.toggleFilterViewPanel},"Show Filters"));return i?c=u:e=s?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"button mr-3",onClick:this.cancelEdit},"Cancel"),r.a.createElement("button",{className:"button mr-3",onClick:this.save},"Save"),r.a.createElement("button",{className:"button mr-3",onClick:this.delete},"Delete"),r.a.createElement("button",{className:"button mr-3",onClick:function(){return t.openFilterEditPanel(null)}},"Add Filter"),r.a.createElement("button",{className:"button",onClick:function(){return t.openWidgetEditPanel(null)}},"Add Widget")):r.a.createElement(r.a.Fragment,null,u,r.a.createElement("button",{className:"button square-button mr-3",onClick:this.fullScreen},r.a.createElement(P.a,{icon:"tv",size:"lg",fixedWidth:!0})),r.a.createElement("button",{className:"button",onClick:this.edit},"Edit")),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"dashboard-menu-panel row"},r.a.createElement("div",{className:"float-left"},i||!s?r.a.createElement("div",{className:"dashboard-name"},this.state.name):r.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange,className:"dashboard-name"})),r.a.createElement("div",{className:"float-right"},c,e)),r.a.createElement(fe,Object.assign({ref:this.widgetViewPanel,isEditMode:this.state.isEditMode,widgetViewWidth:this.state.widgetViewWidth,onWidgetEdit:this.openWidgetEditPanel,onHeightChange:this.onHeightChange,onBackgroundColorChange:this.onBackgroundColorChange},this.state.style)),r.a.createElement(X,{ref:this.filterViewPanel,onEdit:this.openFilterEditPanel,onApplyFilters:this.applyFilters,isEditMode:this.state.isEditMode,show:this.state.showFilterViewPanel}),r.a.createElement(I,{show:this.state.showWidgetEditPanel,onClose:function(){return t.setState({showWidgetEditPanel:!1})},modalClass:"dashboard-edit-widget-dialog",title:"Widget Edit"},r.a.createElement(Ee,{ref:this.widgetEditPanel,jdbcDataSourceOptions:this.state.jdbcDataSourceOptions,dashboardId:this.state.dashboardId,onSave:this.onSaveWidget})),r.a.createElement(I,{show:this.state.showFilterEditPanel,onClose:function(){return t.setState({showFilterEditPanel:!1})},modalClass:"dashboard-edit-filter-dialog",title:"Filter Edit"},r.a.createElement(we,{ref:this.filterEditPanel,jdbcDataSourceOptions:this.state.jdbcDataSourceOptions,dashboardId:this.state.dashboardId,onSave:this.onSaveFilter})))}}]),t}(r.a.Component)),Ce=Object(g.a)(ye),ke=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchBoards=function(){E.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({dashboards:t})})},a.handleInputChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.closeEditPanel=function(){a.setState({showEditPanel:!1,name:""})},a.save=function(){var e={name:a.state.name,style:{height:_,backgroundColor:"rgba(233, 235, 238, 1)"}};E.a.post("/ws/dashboard",e).then(function(e){var t=e.data;a.closeEditPanel(),a.fetchBoards(),a.props.history.push("/workspace/dashboard/".concat(t))}).catch(function(e){console.log(e)})},a.view=function(e){a.props.history.push("/workspace/dashboard/".concat(e))},a.onSaveDashboard=function(e){a.fetchBoards()},a.state={searchValue:"",dashboards:[],showEditPanel:!1,name:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchBoards()}},{key:"render",value:function(){var e=this,t=this.state.dashboards,a=(void 0===t?[]:t).map(function(t,a){return r.a.createElement("div",{key:a,className:"dashboard-menu-item ellipsis",onClick:function(){return e.view(t.id)}},t.name)});return r.a.createElement("div",null,r.a.createElement("div",{className:"dashboard-sidebar"},r.a.createElement("div",{style:{margin:"5px"}},r.a.createElement("button",{className:"button icon-button dashboard-add-button",onClick:function(){return e.setState({showEditPanel:!0})}},r.a.createElement(P.a,{icon:"plus"})," New dashboard"),r.a.createElement("input",{type:"text",name:"searchValue",value:this.state.searchValue,placeholder:"Search...",onChange:this.handleInputChange})),r.a.createElement("div",null,a)),r.a.createElement("div",{className:"dashboard-content"},r.a.createElement(p.a,{path:"/workspace/dashboard/:id",render:function(t){return r.a.createElement(Ce,{key:t.match.params.id,onSaveDashboard:e.onSaveDashboard})}})),r.a.createElement(I,{show:this.state.showEditPanel,onClose:function(){return e.setState({showEditPanel:!1})},modalClass:"small-modal-panel",title:"New"},r.a.createElement("div",null,r.a.createElement("label",null,"Name"),r.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),r.a.createElement("button",{className:"button",onClick:this.save},"Save"))))}}]),t}(n.Component),Oe=Object(g.a)(ke),je=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.dashboardEditView.loadViewByDashboardName()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"full-screen-view"},r.a.createElement(Ce,{wrappedComponentRef:function(t){return e.dashboardEditView=t}}))}}]),t}(r.a.Component),Se=["developer","viewer"],De=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleOptionChange=function(e,t){a.setState(Object(v.a)({},e,t.target.value))},a.fetchUsers=function(){E.a.get("/ws/user").then(function(e){var t=e.data;a.setState({users:t})})},a.fetchGroups=function(){E.a.get("/ws/group").then(function(e){var t=e.data;a.setState({groups:t})})},a.openEditPanel=function(e){null!==e?a.setState({id:e.id,username:e.username,name:e.name,tempPassword:"",sysRole:e.sysRole,userGroups:e.userGroups}):a.clearEditPanel(),a.setState({showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.clearEditPanel=function(){a.setState(a.initialEditPanelState)},a.search=function(){a.state.searchValue},a.save=function(e){e.preventDefault();var t=a.state,n=t.id,r=t.username,o=t.name,s=t.tempPassword,i={username:r,name:o,sysRole:t.sysRole,userGroups:t.userGroups};null!==n?(i.id=n,E.a.put("/ws/user",i).then(function(e){a.clearEditPanel(),a.fetchUsers()})):(i.tempPassword=s,E.a.post("/ws/user",i).then(function(e){a.clearEditPanel(),a.fetchUsers()}))},a.delete=function(e){E.a.delete("/ws/user/"+e).then(function(e){a.fetchUsers()})},a.addUserGroup=function(e){e.preventDefault();var t=a.state,n=t.userGroupId,r=t.userGroups,o=void 0===r?[]:r;if(-1===o.findIndex(function(e){return e===n})){var s=Object(V.a)(o);s.push(n),a.setState({userGroups:s})}},a.removeUserGroup=function(e,t){t.preventDefault();var n=a.state.userGroups,r=void 0===n?[]:n,o=r.findIndex(function(t){return t===e});if(-1!==o){var s=Object(V.a)(r);s.splice(o,1),a.setState({userGroups:s})}},a.state={users:[],groups:[],searchValue:"",showEditPanel:!1,id:null,username:"",name:"",tempPassword:"",sysRole:"",userGroupId:"",userGroups:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchUsers(),this.fetchGroups()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.users,n=void 0===a?[]:a,o=t.groups,s=void 0===o?[]:o,i=t.userGroups,l=void 0===i?[]:i,c=n.map(function(t){return r.a.createElement("div",{key:t.id,className:"user-card"},r.a.createElement("p",null,t.username,t.name,t.sysRole,r.a.createElement("button",{onClick:function(){return e.openEditPanel(t)}},"update"),r.a.createElement("button",{onClick:function(){return e.delete(t.id)}},"delete")))}),u=s.map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}),d=Se.map(function(e){return r.a.createElement("option",{value:e,key:e},e)}),h=[],m=function(t){for(var a=l[t],n=0;n<s;n++)if(a===s[n].id){h.push(r.a.createElement("div",{key:a},r.a.createElement("div",null,"Group: ",s[n].name),r.a.createElement("button",{onClick:function(t){return e.removeUserGroup(a,t)}},"delete")));break}},p=0;p<l;p++)m(p);return r.a.createElement("div",null,r.a.createElement("div",null,"User"),r.a.createElement("input",{type:"text",name:"",placeholder:"By Username..."}),r.a.createElement("input",{type:"text",name:"",placeholder:"By Group..."}),r.a.createElement("button",{onClick:this.search},"Search"),r.a.createElement("div",{className:"row"},c),r.a.createElement("button",{onClick:function(){return e.openEditPanel(null)}},"Add"),r.a.createElement(I,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"lg-modal-panel",title:"User"},r.a.createElement("div",null,r.a.createElement("h3",null,"User"),r.a.createElement("form",null,r.a.createElement("label",null,"Username"),r.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange}),r.a.createElement("label",null,"Name"),r.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),r.a.createElement("label",null,"Temp password"),r.a.createElement("input",{type:"password",name:"tempPassword",value:this.state.tempPassword,onChange:this.handleInputChange}),r.a.createElement("label",null,"System Role"),r.a.createElement("select",{value:this.state.sysRole,onChange:function(t){return e.handleOptionChange("sysRole",t)}},d),r.a.createElement("br",null),r.a.createElement("label",null,"Groups"),r.a.createElement("select",{value:this.state.userGroupId,onChange:function(t){return e.handleOptionChange("userGroupId",t)}},u),r.a.createElement("button",{onClick:this.addUserGroup},"Add"),r.a.createElement("div",null,h)),r.a.createElement("div",null,r.a.createElement("button",{onClick:this.save},"Save")))))}},{key:"initialEditPanelState",get:function(){return{id:null,username:"",name:"",tempPassword:"",sysRole:"",userGroupId:"",userGroups:[]}}}]),t}(r.a.Component),Ne=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleOptionChange=function(e,t){a.setState(Object(v.a)({},e,t.target.value))},a.fetchGroups=function(){E.a.get("/ws/group").then(function(e){var t=e.data;a.setState({groups:t})})},a.fetchDashboards=function(){E.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({dashboards:t})})},a.openEditPanel=function(e){null!==e?a.setState({id:e.id,name:e.name,groupDashboards:e.groupDashboards}):a.clearEditPanel(),a.setState({showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.clearEditPanel=function(){a.setState(a.initialEditPanelState)},a.save=function(e){e.preventDefault();var t=a.state,n=t.id,r={name:t.name,groupDashboards:t.groupDashboards};null!==n?(r.id=n,E.a.put("/ws/group",r).then(function(e){a.clearEditPanel(),a.fetchGroups()})):E.a.post("/ws/group",r).then(function(e){a.clearEditPanel(),a.fetchGroups()})},a.delete=function(e){E.a.delete("/ws/group/"+e).then(function(e){a.fetchGroups()})},a.addGroupDashboard=function(e){e.preventDefault();var t=a.state,n=t.groupDashboardId,r=t.groupDashboards,o=void 0===r?[]:r;if(-1===o.findIndex(function(e){return e===n})){var s=Object(V.a)(o);s.push(n),a.setState({groupDashboards:s})}},a.removeGroupDashboard=function(e,t){t.preventDefault();var n=a.state.groupDashboards,r=void 0===n?[]:n,o=r.findIndex(function(t){return t===e});if(-1!==o){var s=Object(V.a)(r);s.splice(o,1),a.setState({groupDashboards:s})}},a.state={groups:[],dashboards:[],showEditPanel:!1,id:null,name:"",groupDashboardId:"",groupDashboards:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchGroups(),this.fetchDashboards()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.groups,n=void 0===a?[]:a,o=t.dashboards,s=void 0===o?[]:o,i=t.groupDashboards,l=void 0===i?[]:i,c=s.map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}),u=n.map(function(t){return r.a.createElement("div",{key:t.id,className:"group-card"},r.a.createElement("p",null,t.name,r.a.createElement("button",{onClick:function(){return e.openEditPanel(t)}},"update"),r.a.createElement("button",{onClick:function(){return e.delete(t.id)}},"delete")))}),d=[],h=function(t){for(var a=l[t],n=0;n<s;n++)if(a===s[n].id){d.push(r.a.createElement("div",{key:a},r.a.createElement("div",null,"Name: ",s[n].name),r.a.createElement("button",{onClick:function(t){return e.removeGroupDashboard(a,t)}},"delete")));break}},m=0;m<l;m++)h(m);return r.a.createElement("div",null,r.a.createElement("h1",null,"Group"),r.a.createElement("input",{type:"text",name:"",placeholder:"By Group..."}),r.a.createElement("button",{onClick:this.search},"Search"),r.a.createElement("div",{className:"row"},u),r.a.createElement("button",{onClick:function(){return e.openEditPanel(null)}},"Add"),r.a.createElement(I,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"lg-modal-panel",title:"Group"},r.a.createElement("div",null,r.a.createElement("h3",null,"Group"),r.a.createElement("form",null,r.a.createElement("label",null,"Name"),r.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),r.a.createElement("label",null,"Dashboards"),r.a.createElement("select",{value:this.state.groupDashboardId,onChange:function(t){return e.handleOptionChange("groupDashboardId",t)}},c),r.a.createElement("button",{onClick:this.addGroupDashboard},"Add"),r.a.createElement("div",null,d)),r.a.createElement("div",null,r.a.createElement("button",{onClick:this.save},"Save")))))}},{key:"initialEditPanelState",get:function(){return{id:null,name:"",groupDashboards:[]}}}]),t}(r.a.Component),xe=(a(832),[{link:"/workspace/user-management/user",value:"User",icon:"fa-users"},{link:"/workspace/user-management/group",value:"Group",icon:"fa-user-cog"}]),Pe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleMenuClick=function(e){a.setState({currentMenuLink:e})},a.state={currentMenuLink:"group"},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=this,t=[],a=function(a){var n=xe[a],o=e.state.currentMenuLink===n.link?"active":"";t.push(r.a.createElement("li",{className:o,key:a},r.a.createElement(k.a,{to:n.link,onClick:function(){return e.handleMenuClick(n.link)}},r.a.createElement("i",{className:"fas ".concat(n.icon," fa-fw")}),r.a.createElement("span",{className:"app-nav-menu-text"},n.value))))},n=0;n<xe.length;n++)a(n);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("ul",{className:"nav-menu"},t)),r.a.createElement("div",null,r.a.createElement(m.a,null,r.a.createElement(p.a,{path:"/workspace/user-management/user",component:De}),r.a.createElement(p.a,{path:"/workspace/user-management/group",component:Ne}))))}}]),t}(r.a.Component),Ie=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.fetchUser=function(){E.a.get("/ws/user/account").then(function(e){e.data})},a.generateApiKey=function(){},a.save=function(e){e.preventDefault();var t=a.state,n=t.showUpdatePassword,r=t.name,o=t.password,s=t.confirmedPassword,i={name:r};if(n){if(o!==s)return void alert("confirm password");i.password=o}},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.state={showUpdatePassword:!1,id:null,username:"",name:"",sysRole:"",apiKey:"",password:"",confirmedPassword:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchUser()}},{key:"render",value:function(){var e=this.state,t=e.showUpdatePassword,a=e.username,n=e.sysRole,o=e.apiKey;return r.a.createElement("div",null,r.a.createElement("div",null,"Account"),r.a.createElement("div",{className:"form-panel"},r.a.createElement("label",null,"Username"),r.a.createElement("div",null,a),r.a.createElement("label",null,"Name"),r.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),r.a.createElement("label",null,"System Role"),r.a.createElement("div",null,n),r.a.createElement("label",null,"API Key"),r.a.createElement("div",null,o),r.a.createElement("button",{className:"button",onClick:this.generateApiKey},"Generate new API Key"),r.a.createElement("br",null),r.a.createElement("button",{className:"button",onClick:this.toggleUpdatePassword},"Update password"),t?r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange}),r.a.createElement("label",null,"Confirm Password"),r.a.createElement("input",{type:"password",name:"confirmedPassword",value:this.state.confirmedPassword,onChange:this.handleInputChange})):null,r.a.createElement("br",null),r.a.createElement("button",{className:"button",onClick:this.save},"Save")))}}]),t}(r.a.Component),Me=(a(833),[{link:"/workspace/dashboard",value:"Dashboard",icon:"chalkboard"},{link:"/workspace/datasource",value:"Data source",icon:"database"},{link:"/workspace/user-management",value:"User Management",icon:"users-cog"}]),We=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleMenuClick=function(e){a.setState({currentMenuLink:e})},a.state={currentMenuLink:"/workspace/dashboard",username:"",sysRole:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){console.log("Workspace - componentDidMount");var e=this.props.location.pathname;if(this.setState({currentMenuLink:e}),w.isAuthenticated){var t=w.sysRole;this.setState({sysRole:t})}}},{key:"render",value:function(){var e=this,t=this.state,a=t.currentMenuLink,n=t.sysRole,o=[],s=[];s="viewer"===n?Me.filter(function(e){return"dashboard"===e.name||"account"===e.name}):Me;for(var i=function(t){var n=s[t],i=a===n.link?"menu-item-active":"";o.push(r.a.createElement("li",{key:n.link,className:i},r.a.createElement(k.a,{to:n.link,onClick:function(){return e.handleMenuClick(n.link)}},r.a.createElement(P.a,{icon:n.icon,fixedWidth:!0}),r.a.createElement("span",{className:"workspace-nav-menu-text"},n.value))))},l=0;l<s.length;l++)i(l);var c="/workspace/account"===a?"menu-item-active":"";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"workspace-nav"},r.a.createElement("div",{className:"workspace-name"},"Poli"),r.a.createElement("ul",{className:"workspace-nav-menu"},o),r.a.createElement("div",{className:"workspace-account-menu"},r.a.createElement("div",{className:"workspace-account-button inline-block ".concat(c)},r.a.createElement(k.a,{to:"/workspace/account",onClick:function(){return e.handleMenuClick("/workspace/account")}},r.a.createElement(P.a,{icon:"user",fixedWidth:!0}),r.a.createElement("span",{className:"workspace-nav-menu-text"},"Account"))),r.a.createElement("div",{className:"workspace-logout-button inline-block"},r.a.createElement(k.a,{to:"/login"},r.a.createElement(P.a,{icon:"sign-out-alt",fixedWidth:!0}))))),r.a.createElement("div",{className:"workspace-content"},r.a.createElement(m.a,null,r.a.createElement(p.a,{exact:!0,path:"/workspace/datasource",component:U}),r.a.createElement(p.a,{exact:!0,path:"/workspace/dashboard/view",component:je}),r.a.createElement(p.a,{exact:!0,path:"/workspace/account",component:Ie}),r.a.createElement(p.a,{path:"/workspace/dashboard",component:Oe}),r.a.createElement(p.a,{path:"/workspace/user-management",component:Pe}))),r.a.createElement(T,null))}}]),t}(r.a.Component),Te=Object(g.a)(We),Ue=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"PageNotFound"),r.a.createElement(k.a,{to:"/login"},"Login"))}}]),t}(r.a.Component),Re=a(103),Ve=a(28);function Ge(e){var t=e.component,a=e.authenticated,n=Object(i.a)(e,["component","authenticated"]);return r.a.createElement(p.a,Object.assign({},n,{render:function(e){return!0===a?r.a.createElement(t,e):r.a.createElement(f.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}Re.b.add(Ve.a,Ve.c,Ve.r,Ve.j,Ve.n,Ve.d,Ve.o,Ve.h,Ve.m,Ve.k,Ve.p,Ve.i,Ve.q,Ve.l,Ve.b,Ve.e,Ve.g,Ve.f);var Fe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){console.log("App - componentDidMount",w.isAuthenticated)}},{key:"render",value:function(){return console.log("App - render",w.isAuthenticated),r.a.createElement("div",{className:"app"},r.a.createElement(m.a,null,r.a.createElement(p.a,{exact:!0,path:"/",component:C}),r.a.createElement(p.a,{path:"/login",component:C}),r.a.createElement(Ge,{authenticated:w.isAuthenticated,path:"/workspace",component:Te}),r.a.createElement(p.a,{component:Ue})))}}]),t}(r.a.Component),qe=a(838);s.a.render(r.a.createElement(qe.a,{basename:"/poli"},r.a.createElement(Fe,null)),document.getElementById("root"))}},[[315,1,2]]]);
//# sourceMappingURL=main.84784b46.chunk.js.map