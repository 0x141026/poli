(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e,t,a){},188:function(e,t,a){},313:function(e,t,a){e.exports=a(833)},340:function(e,t,a){},344:function(e,t,a){},345:function(e,t,a){},346:function(e,t,a){},347:function(e,t,a){},510:function(e,t,a){},820:function(e,t,a){},821:function(e,t,a){},822:function(e,t,a){},830:function(e,t,a){},831:function(e,t,a){},832:function(e,t,a){},833:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(32),s=a.n(r),i=a(312),l=a(5),c=a(6),u=a(8),d=a(7),h=a(9),m=a(839),p=a(834),f=a(836),v=a(838),g=a(10),b=a.n(g),E=a(101),w=a(22),C=a(12),y=(a(340),a(16)),k=(a(187),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleKeyPress=function(e){13===e.keyCode&&a.login()},a.login=function(){var e=a.state,t=e.username,n=e.password,o={username:t,password:n};t?n?b.a.post("/auth/login/user",o).then(function(e){var t=e.data;t.error?a.setState({errorMsg:t.error}):a.props.onLoginSuccess(t)}):a.setState({errorMsg:"Enter password."}):a.setState({errorMsg:"Enter username."})},a.state={errorMsg:"",username:"",password:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=!1;this.props.sysRole&&(t=!0),t||b.a.post("/auth/login/cookie").then(function(t){var a=t.data;a.error||e.props.onLoginSuccess(a)})}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"login-panel"},o.a.createElement("div",{className:"login-app-title"},"Poli"),o.a.createElement("div",{className:"login-error-msg"},this.state.errorMsg),o.a.createElement("div",{className:"login-panel-body"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Username"),o.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange,onKeyDown:this.handleKeyPress}),o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange,onKeyDown:this.handleKeyPress}),o.a.createElement("button",{className:"button login-button",onClick:this.login},"Login")))))}}]),t}(o.a.Component)),O=Object(v.a)(k),D=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.changePassword=function(){var e=a.state,t=e.password,n=e.confirmedPassword;if(t&&n&&t===n){if(t.length<8)return void a.setState({errorMsg:"Use 8 or more characters."});var o={password:t};b.a.post("/auth/login/change-password",o).then(function(e){var t=e.data||{};t.error?a.setState({errorMsg:t.error}):a.props.history.push("/workspace/dashboard")})}else a.setState({errorMsg:"Those passwords didn't match."})},a.state={errorMsg:"",password:"",confirmedPassword:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"login-panel"},o.a.createElement("div",{style:{fontSize:"22px",textAlign:"center",fontWeight:"bold",marginBottom:"15px"}},"Change password"),o.a.createElement("div",{className:"login-error-msg"},this.state.errorMsg),o.a.createElement("div",{className:"login-panel-body"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("div",{style:{fontWeight:"bold",marginBottom:"5px",fontSize:"15px"}},"* Use 8 or more characters"),o.a.createElement("label",null,"New password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.username,onChange:this.handleInputChange}),o.a.createElement("label",null,"Confirm password"),o.a.createElement("input",{type:"password",name:"confirmedPassword",value:this.state.confirmedPassword,onChange:this.handleInputChange}),o.a.createElement("button",{className:"button login-button",onClick:this.changePassword},"Confirm")))))}}]),t}(o.a.Component),j=Object(v.a)(D),N=a(835),S=a(35),P=a.n(S),x=a(56),I=(a(344),function(){var e=Object(x.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("/ws/jdbcdatasource");case 3:return t=e.sent,e.abrupt("return",t.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}()),T=(a(345),function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.show,n=t.modalClass,r=void 0===n?"":n,s=t.title,i=t.children,l=a?"display-block":"display-none";return o.a.createElement("div",{className:"modal-overlay ".concat(l)},o.a.createElement("div",{className:"modal-panel ".concat(r)},o.a.createElement("div",{className:"model-header row"},o.a.createElement("div",{className:"model-title"},s),o.a.createElement("button",{className:"model-close-button icon-button",onClick:function(){return e.props.onClose()}},o.a.createElement(C.a,{icon:"times",size:"lg"}))),o.a.createElement("hr",null),o.a.createElement("div",{className:"modal-body"},i)))}}]),t}(o.a.Component)),M=a(21),W=(a(346),"#FF5630"),U=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).show=function(e,t){var n=a.state.timeoutId;n&&clearTimeout(n),a.setState({showToast:!0,message:e,backgroundColor:t,timeoutId:""},function(){var e=setTimeout(function(){a.hide()},3e3);a.setState({timeoutId:e})})},a.hide=function(){a.setState({showToast:!1,message:""})},a.state={showToast:!1,message:"",backgroundColor:W,timeoutId:""},t._toastRef=Object(M.a)(Object(M.a)(a)),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=this.state.timeoutId;e&&clearInterval(e)}},{key:"render",value:function(){var e=this.state,t=e.showToast,a=e.message,n=t?"display-block":"display-none",r={backgroundColor:e.backgroundColor};return o.a.createElement("div",{className:"toast-container ".concat(n),style:r},a)}}]),t}(o.a.Component);U.showSuccess=function(e){U._toastRef.show(e,"#36B37E")},U.showError=function(e){U._toastRef.show(e,W)};var V=U,R=(a(347),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){var t=a.props.name,n=e.target.value;a.props.onChange(t,n)},a.reset=function(){var e=a.props.name;a.props.onChange(e,"")},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.value,n=e.inputWidth,r={};return n&&(r.width=n+"px"),o.a.createElement("div",{className:"search-input-container"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"search-input-icon float-left"},o.a.createElement(C.a,{icon:"search",style:{margin:"10px"}})),o.a.createElement("div",{className:"float-left"},o.a.createElement("input",{type:"text",name:t,value:a,placeholder:"Search...",onChange:this.handleInputChange,className:"search-input-input",style:r})),o.a.createElement("button",{className:"button search-input-reset-button float-left",onClick:this.reset},o.a.createElement(C.a,{icon:"times",size:"lg"}))))}}]),t}(o.a.Component)),G=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleNameInputChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.save=function(){var e=a.state,t=e.showUpdatePassword,n=e.id,o=e.connectionUrl,r=e.driverClassName,s=e.username,i=e.password,l=e.name,c=e.ping;if(l){var u={connectionUrl:o,driverClassName:r,username:s,name:l,ping:c};null!==n?(u.id=n,t&&i&&(u.password=i),b.a.put("/ws/jdbcdatasource",u).then(function(e){a.closeEditPanel(),a.fetchDataSources()}).catch(function(e){V.showError("The name exists. Try another.")})):(u.password=i,b.a.post("/ws/jdbcdatasource",u).then(function(e){a.closeEditPanel(),a.fetchDataSources()}).catch(function(e){V.showError("The name exists. Try another.")}))}else V.showError("Enter a name.")},a.ping=function(e){b.a.get("/ws/jdbcdatasource/ping/".concat(e)).then(function(e){var t=e.data;"success"===t?V.showSuccess("Ping Succeeded"):V.showError(t)})},a.clearEditPanel=function(){a.setState(a.initialState)},a.openEditPanel=function(e){null!==e?a.setState({showUpdatePassword:!1,id:e.id,connectionUrl:e.connectionUrl,driverClassName:e.driverClassName,username:e.username,name:e.name,ping:e.ping}):a.clearEditPanel(),a.setState({showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.confirmDelete=function(){var e=a.state.objectToDelete,t=void 0===e?{}:e;b.a.delete("/ws/jdbcdatasource/"+t.id).then(function(e){a.fetchDataSources(),a.closeConfirmDeletionPanel()})},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.state={jdbcDataSources:[],showEditPanel:!1,showConfirmDeletionPanel:!1,objectToDelete:{},showUpdatePassword:!1,searchValue:"",id:null,name:"",connectionUrl:"",driverClassName:"",username:"",password:"",ping:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchDataSources()}},{key:"fetchDataSources",value:function(){var e=Object(x.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:t=e.sent,this.setState({jdbcDataSources:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){for(var e=this,t=this.state,a=t.showUpdatePassword,n=t.id,r=t.jdbcDataSources,s=void 0===r?[]:r,i=t.searchValue,l=t.showConfirmDeletionPanel,c=t.objectToDelete,u=void 0===c?{}:c,d=null===n?"New":"Edit",h=[],m=function(t){var a=s[t],n=a.name;(!i||i&&n.includes(i))&&h.push(o.a.createElement("div",{key:t,className:"datasource-card row"},o.a.createElement("div",{className:"float-left ellipsis datasource-row-name"},n),o.a.createElement("div",{className:"float-right"},o.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.openEditPanel(a)}},o.a.createElement(C.a,{icon:"edit",size:"lg"})),o.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.openConfirmDeletionPanel(a)}},o.a.createElement(C.a,{icon:"trash-alt",size:"lg"})),o.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.ping(a.id)}},o.a.createElement(C.a,{icon:"plug",size:"lg"})))))},p=0;p<s.length;p++)m(p);return o.a.createElement("div",{className:"full-page-content"},o.a.createElement("div",{class:"row"},o.a.createElement("div",{className:"float-left",style:{marginRight:"5px"}},o.a.createElement(R,{name:"searchValue",value:this.state.searchValue,onChange:this.handleNameInputChange,inputWidth:200})),o.a.createElement("button",{className:"button float-left",onClick:function(){return e.openEditPanel(null)}},o.a.createElement(C.a,{icon:"plus"})," New")),o.a.createElement("div",{className:"row mt-10"},h),o.a.createElement(T,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"small-modal-panel",title:d},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Name ",o.a.createElement("span",{className:"required"},"*")),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),o.a.createElement("label",null,"Connection Url"),o.a.createElement("textarea",{rows:"4",type:"text",name:"connectionUrl",value:this.state.connectionUrl,onChange:this.handleInputChange}),o.a.createElement("label",null,"Driver Class Name"),o.a.createElement("input",{type:"text",name:"driverClassName",value:this.state.driverClassName,onChange:this.handleInputChange}),o.a.createElement("label",null,"Username"),o.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange}),"Edit"===d&&o.a.createElement("div",{style:{margin:"3px 0px 8px 0px"}},o.a.createElement("button",{className:"button",onClick:this.toggleUpdatePassword},"Update password")),("New"===d||a)&&o.a.createElement("div",null,o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange})),o.a.createElement("label",null,"Ping"),o.a.createElement("input",{type:"text",name:"ping",value:this.state.ping,onChange:this.handleInputChange}),o.a.createElement("button",{className:"button mt-3",onClick:this.save},"Save"))),o.a.createElement(T,{show:l,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",u.name,"?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}},{key:"initialState",get:function(){return{showUpdatePassword:!1,id:null,name:"",connectionUrl:"",driverClassName:"",username:"",password:"",ping:""}}}]),t}(n.Component),L=(a(188),"chart"),q="filter",z=[L,q],F="slicer",B="single",A=[F,B],K="pie",Q="table",X=[Q,K],Y="admin",J="viewer",_=600,H=a(136),Z=a(26),$=a(309),ee=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleClick=function(){a.setState(function(e){return{showPalette:!e.showPalette}})},a.handleClose=function(){a.setState({showPalette:!1})},a.handleChange=function(e){var t=a.props.name,n=e.rgb,o="rgba(".concat(n.r,", ").concat(n.g,", ").concat(n.b,", ").concat(n.a,")");a.props.onChange(t,o)},a.state={showPalette:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={width:"36px",height:"14px",borderRadius:"2px",background:this.props.value};return o.a.createElement("div",null,o.a.createElement("div",{style:{padding:"5px",background:"#fff",borderRadius:"1px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:this.handleClick},o.a.createElement("div",{style:e})),this.state.showPalette&&o.a.createElement("div",{style:{position:"absolute",zIndex:2}},o.a.createElement("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:this.handleClose}),o.a.createElement($.ChromePicker,{color:this.props.value,onChange:this.handleChange})))}}]),t}(o.a.Component),te=(a(510),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).toggle=function(){var e=a.props,t=e.name,n=e.checked;a.props.onChange(t,!n)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a={backgroundColor:e.checked?"#000000":"#FFFFFF"};return o.a.createElement("div",{className:"checkbox-container",onClick:this.toggle},o.a.createElement("div",{className:"checkbox-checkmark"},o.a.createElement("div",{className:"checkbox-checkmark-box",style:a})),o.a.createElement("div",{className:"checkbox-label"},t))}}]),t}(o.a.Component)),ae=a(137),ne=a.n(ae),oe=function(e){var t;try{t=JSON.parse(e)}catch(a){t=[]}return t},re=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],se=function(e,t,a){for(var n=[],o=[],r=0;r<e.length;r++){var s=e[r];n.push(s[t]),o.push({name:s[t],value:s[a]})}return function(e,t){return{color:re,tooltip:{},legend:{type:"scroll",orient:"vertical",data:e,right:10,top:10,bottom:10},series:[{type:"pie",center:["40%","50%"],radius:"50%",data:t}]}}(n,o)},ie=2,le=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).parentNode,n=e.clientX-t.offsetLeft,o=e.clientY-t.offsetTop,r=t.ownerDocument;r.addEventListener("mouseup",a.onMouseUp),r.addEventListener("mousemove",a.onMouseMove),a.setState({xOffset:n,yOffset:o}),a.props.onMouseDown("drag")},a.onMouseUp=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a)));if(t){var n=t.ownerDocument;n.removeEventListener("mousedown",a.onMouseDown),n.removeEventListener("mouseup",a.onMouseUp),n.removeEventListener("mousemove",a.onMouseMove)}a.props.onMouseUp()},a.onMouseMove=function(e){if(e.preventDefault(),"drag"===a.props.mode){var t=1;a.props.snapToGrid&&(t=4);var n=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).parentNode,o=e.clientX-a.state.xOffset,r=e.clientY-a.state.yOffset,i=n.parentNode,l=i.clientWidth,c=i.clientHeight,u=parseInt(n.style.width,10)+2*ie,d=parseInt(n.style.height,10)+2*ie;o<0&&(o=0),r<0&&(r=0),o+u>l&&(o=l-u),r+d>c&&(r=c-d),o=Math.floor(o/t)*t,r=Math.floor(r/t)*t,n.style.left=o+"px",n.style.top=r+"px"}},a.state={xOffset:0,yOffset:0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){return o.a.createElement("div",{className:"grid-draggable",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},o.a.createElement(C.a,{icon:"expand-arrows-alt",fixedWidth:!0}))}}]),t}(o.a.Component),ce=30,ue=30,de=2,he=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))),n=e.clientX,o=e.clientY,r=t.ownerDocument;r.addEventListener("mouseup",a.onMouseUp),r.addEventListener("mousemove",a.onMouseMove),a.setState({currentX:n,currentY:o}),a.props.onMouseDown("resize")},a.onMouseUp=function(e){e.preventDefault();var t=s.a.findDOMNode(Object(M.a)(Object(M.a)(a)));if(t){var n=t.ownerDocument;n.removeEventListener("mousedown",a.onMouseDown),n.removeEventListener("mouseup",a.onMouseUp),n.removeEventListener("mousemove",a.onMouseMove)}a.props.onMouseUp()},a.onMouseMove=function(e){if(e.preventDefault(),"resize"===a.props.mode){var t=e.clientX-a.state.currentX,n=e.clientY-a.state.currentY,o=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).parentNode,r=parseInt(o.style.width,10),i=parseInt(o.style.height,10),l=o.parentNode,c=l.clientWidth,u=l.clientHeight,d=Math.floor(r+t),h=Math.floor(i+n);d<ce&&(d=ce),h<ue&&(h=ue);var m=o.offsetLeft+2*de,p=o.offsetTop+2*de;d+m>c&&(d=c-m),h+p>u&&(h=u-p),o.style.width=d+"px",o.style.height=h+"px",a.setState({currentX:e.clientX,currentY:e.clientY})}},a.state={currentX:0,currentY:0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){return o.a.createElement("div",{className:"grid-resizable",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},o.a.createElement(C.a,{icon:"compress",fixedWidth:!0}))}}]),t}(o.a.Component),me=a(311),pe=(a(819),a(820),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleTdClick=function(e,t,n){a.props.onTableTdClick(e,t,n)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=void 0===a?[]:a,r=t.columns,s=void 0===r?[]:r,i=t.drillThrough,l=void 0===i?[]:i,c=t.error,u=[];return s.forEach(function(t){var a=t.name,n={Header:a,accessor:a};if(l.length>0){var r=l.findIndex(function(e){return e.columnName===a});if(-1!==r){var s=l[r].dashboardId;n.Cell=function(t){return o.a.createElement("span",{className:"link-label",onClick:function(){return e.handleTdClick(s,a,t.value)}},t.value)}}}u.push(n)}),c?o.a.createElement("div",null,c):0===n.length||0===s.length?o.a.createElement("div",null,"No data"):o.a.createElement(me.a,{data:n,columns:u,defaultPageSize:10,previousText:"Prev",nextText:"Next"})}}]),t}(o.a.Component)),fe=(a(821),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).toggleSelectAll=function(){for(var e=!a.state.isSelectAll,t=Object(Z.a)(a.props.checkBoxes),n=0;n<t.length;n++)t[n].isChecked=e;a.setState(function(e){return{isSelectAll:!e.isSelectAll}}),a.props.onChange(a.props.id,t)},a.handleSearchValueChange=function(e){var t=e.target.value;a.setState({searchValue:t})},a.handleCheckBoxChange=function(e,t){var n=Object(Z.a)(a.props.checkBoxes),o=n.findIndex(function(t){return t.value===e});n[o].isChecked=t,a.props.onChange(a.props.id,n)},a.state={isSelectAll:!1,searchValue:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=this.props.checkBoxes,t=void 0===e?[]:e,a=this.state,n=a.searchValue,r=a.isSelectAll,s=[],i=0;i<t.length;i++){var l=t[i],c=l.value;(!n||n&&c.includes(n))&&s.push(o.a.createElement(te,{key:i,name:l.value,value:l.value,checked:l.isChecked,onChange:this.handleCheckBoxChange}))}var u=r?"Deselect All":"Select All";return o.a.createElement("div",null,o.a.createElement("button",{className:"button",style:{marginBottom:"5px"},onClick:this.toggleSelectAll},u),o.a.createElement("input",{type:"text",name:"name",value:this.state.searchValue,onChange:this.handleSearchValueChange,placeholder:"Search..."}),o.a.createElement("div",{className:"slicer-body"},s))}}]),t}(o.a.Component)),ve=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){a.setState({mode:e})},a.onMouseUp=function(){a.setState({mode:""});var e=s.a.findDOMNode(Object(M.a)(Object(M.a)(a))),t=e.offsetLeft,n=e.offsetTop,o=parseInt(e.style.width,10),r=parseInt(e.style.height,10),i={id:a.props.id,x:t,y:n,width:o,height:r};a.props.onWidgetMove(i)},a.onMouseMove=function(e,t,a){e.preventDefault()},a.editWidget=function(e){a.props.onWidgetEdit(e)},a.exportCsv=function(e){},a.exportJson=function(e){},a.removeWidget=function(e){a.props.onWidgetRemove(e)},a.onTableTdPropsChange=function(e,t,a,n){return{onClick:function(e,o){console.log("A Td Element was clicked!"),console.log("it produced this event:",e),console.log("It was in this column:",a),console.log("It was in this row:",t),console.log("It was in this table instance:",n);var r=a.Header,s=t.row[r],i=n.props.widgetDrillThrough||[];console.log("onTableTdPropsChange",r,s,i);var l=i.findIndex(function(e){return e.columnName===r});if(-1!==l)i[l].dashboardId}}},a.onChartClick=function(e,t){console.log("onChartClick",e,t)},a.onChartLegendselectchanged=function(e,t){console.log("onChartLegendselectchanged",e,t)},a.onTableTdClick=function(e,t,n){var o={type:"tableTdClick",data:{dashboardId:e,columnName:t,columnValue:n}};a.props.onWidgetContentClick(o)},a.onSlicerChange=function(e,t){var n={checkBoxes:t};a.props.onWidgetFilterInputChange(e,n)},a.onSingleValueChange=function(e,t){var n={value:t.target.value};a.props.onWidgetFilterInputChange(e,n)},a.renderWidgetContent=function(){var e={click:a.onChartClick,legendselectchanged:a.onChartLegendselectchanged},t=a.props,n=t.id,r=t.type,s=t.chartType,i=t.filterType,l=t.queryResult,c=void 0===l?{}:l,u=t.drillThrough,d=t.data,h=void 0===d?{}:d,m=t.checkBoxes,p=t.value,f=oe(c.data),v=c.columns||[],g=c.error,b=o.a.createElement("div",null);if(r===L){if(s===Q)b=o.a.createElement(pe,{data:f,columns:v,error:g,drillThrough:u,onTableTdClick:a.onTableTdClick});else if(s===K){var E=h.pieKey,w=h.pieValue,C=se(f,E,w);b=o.a.createElement(ne.a,{option:C,className:"echarts",onEvents:e})}}else r===q&&(i===F?b=o.a.createElement("div",{className:"grid-box-content-panel"},o.a.createElement(fe,{id:n,checkBoxes:m,onChange:a.onSlicerChange})):i===B&&(b=o.a.createElement("div",{className:"grid-box-content-panel"},o.a.createElement("input",{type:"text",value:p,onChange:function(e){return a.onSingleValueChange(n,e)}}))));return b},a.state={mode:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove)}}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.id,r=a.title,s=a.isEditMode,i=a.style,l=void 0===i?{}:i,c=a.drillThrough,u=l.showBorder,d=void 0!==u&&u,h=(l.showTitle,l.borderColor),m=(l.backgroundColor,l.zIndex),p=d?"2px solid ".concat(h):"2px solid transparent",f={left:this.props.x+"px",top:this.props.y+"px",width:this.props.width+"px",height:this.props.height+"px",zIndex:m,border:p};e=c,!Array.isArray(e)||e.length;return o.a.createElement("div",{className:"grid-box",style:f},o.a.createElement("div",{className:"grid-box-title"},o.a.createElement("div",{className:"grid-box-title-value float-left ellipsis"},r),s&&o.a.createElement("div",{className:"float-right",style:{marginRight:"20px"}},o.a.createElement("div",{className:"grid-box-icon inline-block",onClick:function(){return t.editWidget(n)}},o.a.createElement(C.a,{icon:"edit",fixedWidth:!0})),o.a.createElement("div",{className:"grid-box-icon inline-block",onClick:function(){return t.removeWidget(n)}},o.a.createElement(C.a,{icon:"trash-alt",fixedWidth:!0})))),o.a.createElement("div",{className:"grid-box-content"},this.renderWidgetContent()),s&&o.a.createElement(le,{onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,mode:this.state.mode,snapToGrid:this.props.snapToGrid}),s&&o.a.createElement(he,{onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,mode:this.state.mode}))}}]),t}(o.a.Component),ge=(a(822),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.width,n=t.height,r=t.backgroundColor,s=t.widgets,i=void 0===s?[]:s,l={width:a+"px",height:n+"px",backgroundColor:r};t.showGridlines&&(l.backgroundSize="15px 15px",l.backgroundImage="radial-gradient(rgb(63, 93, 131) 10%, transparent 10%)");var c=i.map(function(t,a){return o.a.createElement(ve,Object.assign({key:a,snapToGrid:e.props.snapToGrid,isEditMode:e.props.isEditMode},t,{onWidgetMove:e.props.onWidgetMove,onWidgetEdit:e.props.onWidgetEdit,onWidgetRemove:e.props.onWidgetRemove,onWidgetFilterInputChange:e.props.onWidgetFilterInputChange,onWidgetContentClick:e.props.onWidgetContentClick}))});return o.a.createElement("div",{className:"grid-layout",style:l},c)}}]),t}(o.a.Component)),be=1200,Ee=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).resizeGrid=function(e){var t=a.state.widgets,n=Object(Z.a)(t),o=e-10;a.resizeWidgetsToActual(n,o),a.setState({widgets:n,gridWidth:o})},a.resizeWidgetsToBase=function(e,t){for(var n=0;n<e.length;n++){var o=a.scaleToBase(e[n].x,t),r=a.scaleToBase(e[n].width,t);e[n].x=o,e[n].width=r}},a.resizeWidgetsToActual=function(e,t){for(var n=0;n<e.length;n++){var o=a.scaleToActual(e[n].x,t),r=a.scaleToActual(e[n].width,t);e[n].x=o,e[n].width=r}},a.scaleToActual=function(e,t){return Math.round(e*t/be)},a.scaleToBase=function(e,t){return Math.round(e*be/t)},a.fetchWidgets=function(e,t){null!==e&&b.a.get("/ws/widget/dashboard/".concat(e)).then(function(e){var n=e.data;a.setState({widgets:n},function(){a.resizeGrid(t),a.queryFilters(),a.queryCharts()})})},a.handleCheckBoxChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.saveWidgets=function(){var e=JSON.parse(JSON.stringify(a.state.widgets)),t=a.state.gridWidth;a.resizeWidgetsToBase(e,t),b.a.post("/ws/widget/position",e).then(function(e){})},a.onWidgetMove=function(e){var t=a.state.widgets,n=t.findIndex(function(t){return t.id===e.id}),o=Object(Z.a)(t);o[n].x=e.x,o[n].y=e.y,o[n].width=e.width,o[n].height=e.height,a.setState({widgets:o},function(){a.saveWidgets()})},a.confirmDelete=function(){var e=a.state.objectToDelete;b.a.delete("/ws/widget/".concat(e)).then(function(t){var n=a.state.widgets,o=n.findIndex(function(t){return t.id===e}),r=Object(Z.a)(n);r.splice(o,1),a.setState({widgets:r}),a.closeConfirmDeletionPanel()})},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.onWidgetFilterInputChange=function(e,t){var n=a.state.widgets,o=void 0===n?[]:n,r=o.findIndex(function(t){return t.id===e}),s=Object(Z.a)(o),i=o[r];if(i.filterType===F){var l=t.checkBoxes;s[r].checkBoxes=l}else if(i.filterType===B){var c=t.value;s[r].value=c}a.setState({widgets:s})},a.getFilterParams=function(){for(var e=a.state.widgets,t=void 0===e?[]:e,n=[],o=0;o<t.length;o++){var r=t[o];if(r.type===q){var s=r.filterType,i={};if(s===F){for(var l=r.checkBoxes,c=void 0===l?[]:l,u=[],d=0;d<c.length;d++){var h=c[d];h.isChecked&&u.push(h.value)}i.value=u,u.length===c.length&&(i.remark="select all")}else s===B&&(i.value=r.value);i.param=r.data.queryParameter,i.type=r.filterType,n.push(i)}}return n},a.state={widgets:[],gridWidth:1200,snapToGrid:!1,showGridlines:!1,showConfirmDeletionPanel:!1,objectToDelete:{}},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){console.log("WidgetViewPanel componentDidMount")}},{key:"queryCharts",value:function(){for(var e=this.getFilterParams(),t=this.state.widgets,a=0;a<t.length;a++){var n=t[a],o=n.id;n.type===L&&this.queryChart(o,e)}}},{key:"queryFilters",value:function(){for(var e=this.state.widgets,t=0;t<e.length;t++){var a=e[t],n=a.id,o=a.type,r=a.filterType;o===q&&this.queryFilter(n,r)}}},{key:"queryChart",value:function(e,t){var a=this,n=null===t?[]:t,o=this.state.widgets;b.a.post("/ws/jdbcquery/widget/".concat(e),n).then(function(e){var t=e.data,n=o.findIndex(function(e){return e.id===t.id}),r=Object(Z.a)(o);r[n].queryResult=t,a.setState({widgets:r})})}},{key:"queryFilter",value:function(e,t){var a=this,n=this.state.widgets;if(t===F)b.a.post("/ws/jdbcquery/widget/".concat(e),[]).then(function(e){for(var t=e.data,o=oe(t.data),r=[],s=0;s<o.length;s++)for(var i=Object.values(o[s]),l=0;l<i.length;l++){var c=i[l];r.push({value:c,isChecked:!1})}var u=n.findIndex(function(e){return e.id===t.id}),d=Object(Z.a)(n);d[u].queryResult=t,d[u].checkBoxes=r,a.setState({widgets:d})});else if(t===B){var o=n.findIndex(function(t){return t.id===e}),r=Object(Z.a)(n);r[o].value="",this.setState({widgets:r})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.widgetViewWidth,n=t.isEditMode,r={width:a+"px"};return o.a.createElement("div",{className:"dashboard-content-widget-panel",style:r},n&&o.a.createElement("div",{className:"dashboard-attribute-edit-panel"},o.a.createElement("div",{className:"inline-block"},"Height:"),o.a.createElement("input",{type:"text",name:"height",value:this.props.height,onChange:function(t){return e.props.onStyleValueChange("height",t.target.value)},className:"inline-block",style:{width:"200px"}}),o.a.createElement("div",null,"Background Color",o.a.createElement(ee,{name:"backgroundColor",value:this.props.backgroundColor,onChange:this.props.onStyleValueChange})),o.a.createElement(te,{name:"snapToGrid",value:"Snap to grid",checked:this.state.snapToGrid,onChange:this.handleCheckBoxChange}),o.a.createElement(te,{name:"showGridlines",value:"Show gridlines",checked:this.state.showGridlines,onChange:this.handleCheckBoxChange})),o.a.createElement(ge,{width:this.state.gridWidth,height:this.props.height,backgroundColor:this.props.backgroundColor,snapToGrid:this.state.snapToGrid,showGridlines:this.state.showGridlines,widgets:this.state.widgets,isEditMode:this.props.isEditMode,onWidgetMove:this.onWidgetMove,onWidgetEdit:this.props.onWidgetEdit,onWidgetRemove:this.openConfirmDeletionPanel,onWidgetFilterInputChange:this.onWidgetFilterInputChange,onWidgetContentClick:this.props.onWidgetContentClick}),o.a.createElement(T,{show:this.state.showConfirmDeletionPanel,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete this widget?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}}]),t}(o.a.Component),we=a(310),Ce=a.n(we),ye=(a(828),a(829),a(830),a(831),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleTabClick=function(e){a.setState({activeTab:e})},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.activeTab;this.setState({activeTab:e})}},{key:"render",value:function(){for(var e=this,t=this.props.children,a=this.state.activeTab,n=[],r=null,s=0;s<t.length;s++)t[s]&&function(){var i=t[s].props.title,l="";i===a&&(l="tab-header-active",r=t[s].props.children),n.push(o.a.createElement("li",{className:"tab-header-item ".concat(l),key:s,onClick:function(){return e.handleTabClick(i)}},i))}();return o.a.createElement("div",{className:"tab-container"},o.a.createElement("ul",{className:"tab-header"},n),o.a.createElement("div",{className:"tab-content"},r))}}]),t}(o.a.Component)),ke=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleOptionChange=function(e){var t=a.props.name,n=e.target.value;a.props.onChange(t,n)},a.state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.options,n=void 0===a?[]:a,r=e.optionValue,s=e.optionDisplay,i=e.preloadOneEmpty,l=[];return(void 0===i||i)&&l.push(o.a.createElement("option",{value:"",key:""})),n.forEach(function(e,t){var a,n;r&&s?(a=e[r],n=e[s]):(a=e,n=e),l.push(o.a.createElement("option",{value:a,key:t},n))}),o.a.createElement("select",{value:t,onChange:this.handleOptionChange},l)}}]),t}(o.a.Component),Oe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchWidget=function(){var e=Object(x.a)(P.a.mark(function e(t){var n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState(a.initialState),e.next=3,I();case 3:n=e.sent,a.setState({jdbcDataSources:n}),b.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({drillDashboards:t})}),null===t?a.setState({widgetId:null}):(a.setState({widgetId:t}),b.a.get("/ws/widget/"+t).then(function(e){var n=e.data,o=n.type,r=n.chartType,s=n.filterType,i=n.drillThrough;if(o===L){if(a.setState({chartType:r,drillThrough:i}),r===K){var l=n.data,c=l.pieKey,u=l.pieValue;a.setState({pieKey:c,pieValue:u})}}else if(o===q){var d=n.data.queryParameter;a.setState({filterType:s,queryParameter:d})}a.setState({widgetId:t,title:n.title,x:n.x,y:n.y,width:n.width,height:n.height,sqlQuery:n.sqlQuery,type:o,jdbcDataSourceId:n.jdbcDataSourceId,style:n.style},function(){a.runQuery()})}));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.onStyleValueChange=function(e,t){var n=Object(H.a)({},a.state.style);n[[e]]=t,a.setState({style:n})},a.handleAceEditorChange=function(e){a.setState({sqlQuery:e})},a.handleIntegerOptionChange=function(e,t){var n=parseInt(t,10)||0;a.setState(Object(y.a)({},e,n))},a.handleOptionChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.save=function(){var e=a.state,t=e.widgetId,n=e.title,o=e.jdbcDataSourceId,r=e.sqlQuery,s=e.type,i=e.style,l={title:n,dashboardId:a.props.dashboardId,type:s,jdbcDataSourceId:o,sqlQuery:r,style:i};if(s===L){var c=a.state,u=c.chartType,d=c.drillThrough;if(l.drillThrough=d,l.chartType=u,u===Q);else if(u===K){var h=a.state,m=h.pieKey,p=h.pieValue;l.data={pieKey:m,pieValue:p}}}else if(s===q){var f=a.state,v=f.filterType,g=f.queryParameter;l.filterType=v,l.data={queryParameter:g}}null===t?(l.style={showBorder:!1,borderColor:"rgba(9, 30, 66, 1)",showTitle:!0,backgroundColor:"rgba(255, 255, 255, 1)",zIndex:50},b.a.post("/ws/widget",l).then(function(e){a.props.onSave()})):(l.id=t,b.a.put("/ws/widget",l).then(function(e){a.props.onSave()}))},a.runQuery=function(){var e={jdbcDataSourceId:a.state.jdbcDataSourceId,sqlQuery:a.state.sqlQuery};b.a.post("/ws/jdbcquery/query",e).then(function(e){var t=e.data;a.setState({queryResult:t})})},a.addDrillThrough=function(){var e=a.state,t=e.drillThrough,n=e.drillColumnName,o=e.drillDashboardId;if(-1===t.findIndex(function(e){return e.columnName===n})){var r=Object(Z.a)(t);r.push({columnName:n,dashboardId:o}),a.setState({drillThrough:r})}},a.removeDrillThrough=function(e){var t=a.state.drillThrough,n=t.findIndex(function(t){return t.columnName===e.columnName&&t.dashboardId===e.dashboardId});if(-1!==n){var o=Object(Z.a)(t);o.splice(n,1),a.setState({drillThrough:o})}},a.generateChart=function(){if(a.state.chartType===K){var e=a.state,t=e.pieKey,n=e.pieValue,o=e.queryResult,r=oe((void 0===o?{}:o).data),s=se(r,t,n);a.setState({chartOption:s})}},a.renderChartPreview=function(){var e=a.state,t=e.chartType,n=e.queryResult,r=(void 0===n?{}:n).columns||[],s=o.a.createElement("div",null,"NOT SUPPORTED");if(t===Q);else if(t===K){var i=a.state,l=i.chartOption,c=i.pieKey,u=i.pieValue;s=o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("i",{class:"fas fa-chart-pie"})," Pie Chart"),o.a.createElement("div",null,'Count "value" by "key"'),o.a.createElement("label",null,"Aggr Key (string)"),o.a.createElement(ke,{name:"pieKey",value:c,onChange:a.handleOptionChange,options:r,optionDisplay:"name",optionValue:"name"}),o.a.createElement("label",null,"By Aggr Value (number)"),o.a.createElement(ke,{name:"pieValue",value:u,onChange:a.handleOptionChange,options:r,optionDisplay:"name",optionValue:"name"}),o.a.createElement("button",{onClick:a.generateChart},"Generete Chart"),o.a.createElement(ne.a,{option:l,style:{height:"350px",width:"100%"},className:"react_for_echarts"}))}return s},a.state=a.initialState,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.type,n=t.queryResult,r=t.jdbcDataSources,s=void 0===r?[]:r,i=t.drillThrough,l=void 0===i?[]:i,c=t.drillDashboards,u=void 0===c?[]:c,d=oe(n.data),h=n.columns||[],m=n.error,p=l.map(function(t){return o.a.createElement("div",{key:t.columnName,className:"row table-row"},o.a.createElement("div",{className:"float-left ellipsis"},"Column: ",t.columnName,", Dashboard: ",t.dashboardId),o.a.createElement("button",{className:"button table-row-button float-right",onClick:function(){return e.removeDrillThrough(t)}},o.a.createElement(C.a,{icon:"trash-alt"})))}),f=h.map(function(e){return o.a.createElement("div",{className:"row",key:e.name},o.a.createElement("div",{className:"float-left"},e.name),o.a.createElement("div",{className:"float-right"},e.dataType))}),v=a===L||a===q&&this.state.filterType===F;return o.a.createElement("div",null,o.a.createElement("button",{className:"button",onClick:this.save},"Save"),o.a.createElement("div",{className:"row mt-10"},o.a.createElement("div",{className:"float-left"},"Type:"),o.a.createElement("div",{className:"float-left"},o.a.createElement(ke,{name:"type",value:a,onChange:this.handleOptionChange,options:z,preloadOneEmpty:!1}))),o.a.createElement("div",{className:"mt-10"},o.a.createElement(ye,{activeTab:"Basic"},o.a.createElement("div",{title:"Basic"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Title"),o.a.createElement("input",{type:"text",name:"title",value:this.state.title,onChange:this.handleInputChange}),o.a.createElement(te,{name:"showBorder",value:"Show border",checked:this.state.style.showBorder,onChange:this.onStyleValueChange}),o.a.createElement(te,{name:"showTitle",value:"Show title",checked:this.state.style.showTitle,onChange:this.onStyleValueChange}),o.a.createElement("label",null,"Z Index"),o.a.createElement("input",{type:"number",name:"zIndex",value:this.state.style.zIndex,onChange:function(t){return e.onStyleValueChange("zIndex",t.target.value)}}),o.a.createElement("div",null,"Border Color",o.a.createElement(ee,{name:"borderColor",value:this.state.style.borderColor,onChange:this.onStyleValueChange})),o.a.createElement("div",null,"Background Color",o.a.createElement(ee,{name:"backgroundColor",value:this.state.style.backgroundColor,onChange:this.onStyleValueChange})))),a===q&&o.a.createElement("div",{title:"Filter"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Filter Options"),o.a.createElement(ke,{name:"filterType",value:this.state.filterType,onChange:this.handleOptionChange,options:A,preloadOneEmpty:!1}))),v&&o.a.createElement("div",{title:"Query"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"DataSource"),o.a.createElement(ke,{name:"jdbcDataSourceId",value:this.state.jdbcDataSourceId,onChange:this.handleIntegerOptionChange,options:s,optionDisplay:"name",optionValue:"id"}),o.a.createElement("label",null,"SQL Query"),o.a.createElement(Ce.a,{value:this.state.sqlQuery,mode:"mysql",theme:"xcode",name:"blah2",onChange:this.handleAceEditorChange,height:"300px",width:"100%",fontSize:15,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!0,setOptions:{showLineNumbers:!0,tabSize:2}}),o.a.createElement("div",{style:{margin:"5px 0px 5px 0px"}},o.a.createElement("button",{className:"button",onClick:this.runQuery},"Run Query")),o.a.createElement("label",null,"Result"),o.a.createElement(pe,{data:d,columns:h,error:m}),o.a.createElement("label",{style:{marginTop:"5px"}},"Columns Mapping"),o.a.createElement("div",null,f))),a===L&&o.a.createElement("div",{title:"Chart"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Chart Type"),o.a.createElement(ke,{name:"chartType",value:this.state.chartType,onChange:this.handleOptionChange,options:X,preloadOneEmpty:!1}),o.a.createElement("label",null,"Preview"),this.renderChartPreview())),a===L&&o.a.createElement("div",{title:"Drill Through"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Column"),o.a.createElement(ke,{name:"drillColumnName",value:this.state.drillColumnName,options:h,onChange:this.handleOptionChange,optionDisplay:"name",optionValue:"name"}),o.a.createElement("label",null,"Dashboard"),o.a.createElement(ke,{name:"drillDashboardId",value:this.state.drillDashboardId,options:u,onChange:this.handleIntegerOptionChange,optionDisplay:"name",optionValue:"id"}),o.a.createElement("button",{className:"button",onClick:this.addDrillThrough},"Add"),o.a.createElement("div",{class:"mt-3"},p))),a===q&&o.a.createElement("div",{title:"Query parameter"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Parameter"),o.a.createElement("input",{type:"text",name:"queryParameter",value:this.state.queryParameter,onChange:this.handleInputChange}))))))}},{key:"initialState",get:function(){return{jdbcDataSources:[],widgetId:null,title:"",sqlQuery:"",jdbcDataSourceId:"",queryResult:{},type:L,filterType:B,chartType:Q,style:{showBorder:!1,borderColor:"rgba(9, 30, 66, 1)",showTitle:!0,backgroundColor:"rgba(255, 255, 255, 1)",zIndex:50},queryParameter:"",drillThrough:[],drillDashboards:[],drillColumnName:"",drillDashboardId:"",pieKey:"",pieValue:"",chartOption:{}}}}]),t}(o.a.Component),De=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).loadViewByDashboardName=function(){var e=a.props.location.search,t=new URLSearchParams(e),n=t.get("name"),o=(t.get("showControl"),t.get("fromDashboard")),r=a.getPageWidth();a.setState({isFullScreenView:!0,name:n,widgetViewWidth:r,fromDashboard:o},function(){b.a.get("/ws/dashboard/name/".concat(n)).then(function(e){var t=e.data;a.setState({dashboardId:t.id,name:t.name,style:t.style},function(){a.refresh()})})})},a.handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.getPageWidth=function(){return s.a.findDOMNode(Object(M.a)(Object(M.a)(a))).clientWidth-40},a.toggleAutoRefresh=function(){var e=a.state.autoRefreshTimerId;if(e)clearInterval(e),a.setState({autoRefreshTimerId:""});else{var t=a.state.refreshInterval,n=parseInt(t,10)||15;n=n<1?1:n;var o=setInterval(function(){a.queryWidgets(),a.updateLastRefreshed()},1e3*n);a.setState({autoRefreshTimerId:o})}},a.refresh=function(){a.refreshWidgetView(),a.updateLastRefreshed()},a.refreshWidgetView=function(){var e=a.state,t=e.dashboardId,n=e.widgetViewWidth;a.widgetViewPanel.current.fetchWidgets(t,n,null)},a.queryWidgets=function(){a.widgetViewPanel.current.queryCharts()},a.updateLastRefreshed=function(){var e=(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1");a.setState({lastRefreshed:e})},a.save=function(){var e=a.state,t=e.dashboardId,n={id:t,name:e.name,style:e.style};b.a.put("/ws/dashboard/",n).then(function(e){}),a.props.onDashboardSave(t),a.setState({isEditMode:!1})},a.edit=function(){a.setState({isEditMode:!0})},a.cancelEdit=function(){a.setState({isEditMode:!1})},a.onSaveWidget=function(){a.setState({showWidgetEditPanel:!1}),a.refreshWidgetView()},a.openWidgetEditPanel=function(e){a.widgetEditPanel.current.fetchWidget(e),a.setState({showWidgetEditPanel:!0})},a.applyFilters=function(e){a.widgetViewPanel.current.queryWidgets(e)},a.fullScreen=function(){var e=a.state.name,t="/workspace/dashboard/view?name=".concat(e);window.open(t,"_blank")},a.onStyleValueChange=function(e,t){var n=Object(H.a)({},a.state.style);n[[e]]=t,a.setState({style:n})},a.onWidgetContentClick=function(e){var t=a.state,n=t.name,o=t.isFullScreenView,r=e.type,s=e.data;if("tableTdClick"===r){var i=s.dashboardId,l=s.columnName,c=s.columnValue;if(o)b.a.get("/ws/dashboard").then(function(e){var t=e.data.findIndex(function(e){return e.id===i});if(void 0!==t){var o=t.name,r="/workspace/dashboard/view?name=".concat(o,"&fromDashboard=").concat(n,"&").concat(l,"=").concat(c);a.props.history.push(r)}});else{var u="/workspace/dashboard/".concat(i,"?fromDashboard=").concat(n,"&").concat(l,"=").concat(c);a.props.history.push(u)}}},a.goBackToFromDashboard=function(){a.props.history.goBack()},a.confirmDelete=function(){var e=a.state.objectToDelete,t=(void 0===e?{}:e).id;b.a.delete("/ws/dashboard/".concat(t)).then(function(e){a.props.onDashboardDelete(t),a.closeConfirmDeletionPanel()})},a.deleteDashboard=function(){var e=a.state,t={id:e.dashboardId,name:e.name};a.openConfirmDeletionPanel(t)},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.state={showWidgetEditPanel:!1,showConfirmDeletionPanel:!1,objectToDelete:{},isEditMode:!1,isFullScreenView:!1,autoRefreshTimerId:"",lastRefreshed:"",refreshInterval:15,lastRefreshLabelTimerId:"",jdbcDataSourceOptions:[],fromDashboard:"",dashboardId:0,name:"",style:{},widgetViewWidth:1e3},a.widgetViewPanel=o.a.createRef(),a.widgetEditPanel=o.a.createRef(),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id,a=void 0!==t?t:null;console.log("DashboardEditView - componentDidMount",a);var n=this.props.location.search,o=new URLSearchParams(n),r=o.get("fromDashboard"),s=!0,i=!1,l=void 0;try{for(var c,u=o.entries()[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var d=c.value;console.log(d[0]+", "+d[1])}}catch(p){i=!0,l=p}finally{try{s||null==u.return||u.return()}finally{if(i)throw l}}var h=this.getPageWidth();this.setState({widgetViewWidth:h,fromDashboard:r},function(){null===a?e.setState({dashboardId:null}):b.a.get("/ws/dashboard/".concat(a)).then(function(t){var a=t.data;e.setState({dashboardId:a.id,name:a.name,style:a.style},function(){e.refresh()})})});var m=setInterval(function(){e.state.lastRefreshed},1e4);this.setState({lastRefreshLabelTimerId:m})}},{key:"componentWillUnmount",value:function(){var e=this.state,t=e.autoRefreshTimerId,a=e.lastRefreshLabelTimerId;t&&clearInterval(t),a&&clearInterval(a)}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.autoRefreshTimerId,r=a.lastRefreshed,s=a.isEditMode,i=a.isFullScreenView,l=a.fromDashboard,c=""===n?"OFF":"ON",u=null,d=o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"inline-block"},o.a.createElement("div",{className:"inline-block mr-3"},"Last refreshed: ",r),"OFF"===c&&o.a.createElement("input",{type:"text",name:"refreshInterval",value:this.state.refreshInterval,onChange:this.handleInputChange,className:"inline-block",style:{width:"50px"}})),o.a.createElement("button",{className:"button square-button mr-3",onClick:this.toggleAutoRefresh},"ON"===c?o.a.createElement(C.a,{icon:"stop-circle",size:"lg",fixedWidth:!0}):o.a.createElement(C.a,{icon:"play-circle",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button square-button mr-3",onClick:this.refresh},o.a.createElement(C.a,{icon:"redo-alt",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button mr-3",onClick:this.queryWidgets},o.a.createElement(C.a,{icon:"filter",size:"lg",fixedWidth:!0})," Apply Filters"));return i?u=d:e=s?o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{className:"button mr-3",onClick:this.cancelEdit},o.a.createElement(C.a,{icon:"times",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button mr-3",onClick:this.save},o.a.createElement(C.a,{icon:"save",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button mr-3",onClick:this.deleteDashboard},o.a.createElement(C.a,{icon:"trash-alt",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button",onClick:function(){return t.openWidgetEditPanel(null)}},o.a.createElement(C.a,{icon:"calendar-plus",size:"lg",fixedWidth:!0})," New Widget")):o.a.createElement(o.a.Fragment,null,d,o.a.createElement("button",{className:"button square-button mr-3",onClick:this.fullScreen},o.a.createElement(C.a,{icon:"tv",size:"lg",fixedWidth:!0})),o.a.createElement("button",{className:"button",onClick:this.edit},o.a.createElement(C.a,{icon:"edit",size:"lg",fixedWidth:!0}))),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"dashboard-menu-panel row"},o.a.createElement("div",{className:"float-left"},l&&o.a.createElement("div",{className:"dashboard-drillthrough-name",onClick:this.goBackToFromDashboard},o.a.createElement("span",{className:"link-label"},l)," >")),o.a.createElement("div",{className:"float-left"},i||!s?o.a.createElement("div",{className:"dashboard-name"},this.state.name):o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange,className:"dashboard-name-input"})),o.a.createElement("div",{className:"float-right"},u,e)),o.a.createElement(Ee,Object.assign({ref:this.widgetViewPanel,isEditMode:this.state.isEditMode,widgetViewWidth:this.state.widgetViewWidth,onWidgetEdit:this.openWidgetEditPanel,onStyleValueChange:this.onStyleValueChange,onWidgetContentClick:this.onWidgetContentClick},this.state.style)),o.a.createElement(T,{show:this.state.showWidgetEditPanel,onClose:function(){return t.setState({showWidgetEditPanel:!1})},modalClass:"dashboard-edit-widget-dialog",title:"Widget Edit"},o.a.createElement(Oe,{ref:this.widgetEditPanel,jdbcDataSourceOptions:this.state.jdbcDataSourceOptions,dashboardId:this.state.dashboardId,onSave:this.onSaveWidget})),o.a.createElement(T,{show:this.state.showConfirmDeletionPanel,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",this.state.objectToDelete.name,"?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}}]),t}(o.a.Component),je=Object(v.a)(De),Ne=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchBoards=function(){b.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({dashboards:t})})},a.handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleNameInputChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.closeEditPanel=function(){a.setState({showEditPanel:!1,name:""})},a.save=function(){var e=a.state.name;if(e){var t={name:e,style:{height:_,backgroundColor:"rgba(233, 235, 238, 1)"}};b.a.post("/ws/dashboard",t).then(function(e){var t=e.data;a.closeEditPanel(),a.fetchBoards(),a.props.history.push("/workspace/dashboard/".concat(t))}).catch(function(e){V.showError("The name exists. Try another.")})}else V.showError("Enter a name.")},a.view=function(e){a.setState({activeDashboardId:e},function(){a.props.history.push("/workspace/dashboard/".concat(e))})},a.onDashboardSave=function(e){a.fetchBoards()},a.onDashboardDelete=function(e){a.fetchBoards(),a.setState({activeDashboardId:0},function(){a.props.history.push("/workspace/dashboard")})},a.state={searchValue:"",dashboards:[],showEditPanel:!1,activeDashboardId:0,name:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.location.pathname,t=e.indexOf("/workspace/dashboard/");if(-1!==t){var a=Number(e.substring(t+"/workspace/dashboard/".length));this.setState({activeDashboardId:a})}this.fetchBoards()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.dashboards,n=void 0===a?[]:a,r=t.activeDashboardId,s=t.searchValue,i=this.props.sysRole!==J,l=[],c=function(t){var a=n[t],i=a.name,c=r===a.id?"dashboard-menu-item-active":"";(!s||s&&i.includes(s))&&l.push(o.a.createElement("div",{key:t,className:"dashboard-menu-item ellipsis ".concat(c),onClick:function(){return e.view(a.id)}},i))},u=0;u<n.length;u++)c(u);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"dashboard-sidebar"},o.a.createElement("div",{style:{margin:"5px"}},i&&o.a.createElement("button",{className:"button icon-button dashboard-add-button",onClick:function(){return e.setState({showEditPanel:!0})}},o.a.createElement(C.a,{icon:"plus"})," New"),o.a.createElement("div",{style:{marginTop:"5px"}},o.a.createElement(R,{name:"searchValue",value:this.state.searchValue,onChange:this.handleNameInputChange,inputWidth:117}))),o.a.createElement("div",null,l)),o.a.createElement("div",{className:"dashboard-content"},o.a.createElement(p.a,{path:"/workspace/dashboard/:id",render:function(t){return o.a.createElement(je,{key:t.match.params.id,onDashboardSave:e.onDashboardSave,onDashboardDelete:e.onDashboardDelete})}})),o.a.createElement(T,{show:this.state.showEditPanel,onClose:function(){return e.setState({showEditPanel:!1})},modalClass:"small-modal-panel",title:"New"},o.a.createElement("div",{className:"form-panel"},o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),o.a.createElement("button",{className:"button",onClick:this.save},"Save"))))}}]),t}(n.Component),Se=Object(v.a)(Ne),Pe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleNameInputChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.handleIntegerOptionChange=function(e,t){var n=parseInt(t,10)||0;a.setState(Object(y.a)({},e,n))},a.fetchUsers=function(){b.a.get("/ws/user").then(function(e){var t=e.data;a.setState({users:t})})},a.fetchGroups=function(){b.a.get("/ws/group").then(function(e){var t=e.data;a.setState({groups:t})})},a.openEditPanel=function(e){null!==e?a.setState({id:e.id,username:e.username,name:e.name,tempPassword:"",sysRole:e.sysRole,userGroups:e.userGroups}):a.clearEditPanel(),a.setState({userGroupId:"",showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.clearEditPanel=function(){a.setState(a.initialEditPanelState)},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.save=function(){var e=a.state,t=e.showUpdatePassword,n=e.id,o=e.username,r=e.name,s=e.tempPassword,i=e.sysRole,l=e.userGroups;if(o){var c=J;if(Y===a.props.sysRole){if(!i)return void V.showError("Select a role.");c=i}var u={username:o,name:r,sysRole:c,userGroups:l};if(null!==n){if(u.id=n,t){if(!s||s.length<8)return void V.showError("Use 8 or more characters for password.");u.tempPassword=s}b.a.put("/ws/user",u).then(function(e){a.clearEditPanel(),a.closeEditPanel(),a.fetchUsers()})}else{if(!s||s.length<8)return void V.showError("Use 8 or more characters for password.");u.tempPassword=s,b.a.post("/ws/user",u).then(function(e){a.clearEditPanel(),a.closeEditPanel(),a.fetchUsers()})}}else V.showError("Enter a username.")},a.addUserGroup=function(){var e=a.state,t=e.userGroupId,n=e.userGroups,o=void 0===n?[]:n;if(-1===o.findIndex(function(e){return e===t})){var r=Object(Z.a)(o);r.push(t),a.setState({userGroups:r})}},a.removeUserGroup=function(e){var t=a.state.userGroups,n=void 0===t?[]:t,o=n.findIndex(function(t){return t===e});if(-1!==o){var r=Object(Z.a)(n);r.splice(o,1),a.setState({userGroups:r})}},a.confirmDelete=function(){var e=a.state.objectToDelete,t=void 0===e?{}:e;b.a.delete("/ws/user/"+t.id).then(function(e){a.fetchUsers(),a.closeConfirmDeletionPanel()})},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.state={users:[],groups:[],showConfirmDeletionPanel:!1,objectToDelete:{},searchValue:"",showUpdatePassword:!1,showEditPanel:!1,id:null,username:"",name:"",tempPassword:"",sysRole:J,userGroupId:"",userGroups:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchUsers(),this.fetchGroups()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.id,n=t.showUpdatePassword,r=t.users,s=void 0===r?[]:r,i=t.groups,l=void 0===i?[]:i,c=t.userGroups,u=void 0===c?[]:c,d=t.searchValue,h=t.showConfirmDeletionPanel,m=t.objectToDelete,p=void 0===m?{}:m,f=this.props.sysRole,v=null===a?"New":"Edit",g=[],b=function(t){var a=s[t],n=a.name,r=a.username;(!d||d&&(r.includes(d)||n.includes(d)))&&g.push(o.a.createElement("div",{key:t,className:"datasource-card row"},o.a.createElement("div",{className:"float-left ellipsis datasource-row-name"},a.username,",",a.name,",",a.sysRole),o.a.createElement("div",{className:"float-right"},o.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.openEditPanel(a)}},o.a.createElement(C.a,{icon:"edit",size:"lg"})),o.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.openConfirmDeletionPanel(a)}},o.a.createElement(C.a,{icon:"trash-alt",size:"lg"})))))},E=0;E<s.length;E++)b(E);var w=[],y=function(t){for(var a=u[t],n=0;n<l.length;n++)if(a===l[n].id){w.push(o.a.createElement("div",{key:a,className:"row table-row"},o.a.createElement("div",{className:"float-left ellipsis "},l[n].name),o.a.createElement("button",{className:"button table-row-button float-right",onClick:function(){return e.removeUserGroup(a)}},o.a.createElement(C.a,{icon:"trash-alt"}))));break}};for(E=0;E<u.length;E++)y(E);return o.a.createElement("div",null,o.a.createElement("div",{class:"row"},o.a.createElement("div",{className:"float-left",style:{marginRight:"5px"}},o.a.createElement(R,{name:"searchValue",value:this.state.searchValue,onChange:this.handleNameInputChange,inputWidth:200})),o.a.createElement("button",{className:"button float-left",onClick:function(){return e.openEditPanel(null)}},o.a.createElement(C.a,{icon:"plus"})," New")),o.a.createElement("div",{className:"row mt-10"},g),o.a.createElement(T,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"mid-modal-panel",title:v},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"form-panel float-left",style:{width:"240px"}},o.a.createElement("label",null,"Username ",o.a.createElement("span",{className:"required"},"*")),o.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInputChange}),o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),"Edit"===v&&o.a.createElement("div",{style:{margin:"3px 0px 8px 0px"}},o.a.createElement("button",{className:"button",onClick:this.toggleUpdatePassword},"Update password")),("New"===v||n)&&o.a.createElement("div",null,o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"tempPassword",value:this.state.tempPassword,onChange:this.handleInputChange})),o.a.createElement("label",null,"System Role"),Y===f&&o.a.createElement(ke,{name:"sysRole",value:this.state.sysRole,onChange:this.handleNameInputChange,options:[J,"developer"]}),"developer"===f&&o.a.createElement("div",null,J)),o.a.createElement("div",{className:"form-panel float-right",style:{width:"240px"}},o.a.createElement("label",null,"Groups"),o.a.createElement(ke,{name:"userGroupId",value:this.state.userGroupId,onChange:this.handleIntegerOptionChange,options:l,optionDisplay:"name",optionValue:"id"}),o.a.createElement("button",{className:"button",onClick:this.addUserGroup},"Add"),o.a.createElement("div",{className:"mt-3"},w))),o.a.createElement("button",{className:"button mt-3",onClick:this.save},"Save")),o.a.createElement(T,{show:h,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",p.name,"?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}},{key:"initialEditPanelState",get:function(){return{id:null,username:"",name:"",tempPassword:"",sysRole:"",userGroupId:"",userGroups:[]}}}]),t}(o.a.Component),xe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.handleNameInputChange=function(e,t){a.setState(Object(y.a)({},e,t))},a.handleIntegerOptionChange=function(e,t){var n=parseInt(t,10)||0;a.setState(Object(y.a)({},e,n))},a.fetchGroups=function(){b.a.get("/ws/group").then(function(e){var t=e.data;a.setState({groups:t})})},a.fetchDashboards=function(){b.a.get("/ws/dashboard").then(function(e){var t=e.data;a.setState({dashboards:t})})},a.openEditPanel=function(e){null!==e?a.setState({id:e.id,name:e.name,groupDashboards:e.groupDashboards}):a.clearEditPanel(),a.setState({groupDashboardId:"",showEditPanel:!0})},a.closeEditPanel=function(){a.setState({showEditPanel:!1})},a.clearEditPanel=function(){a.setState(a.initialEditPanelState)},a.save=function(){var e=a.state,t=e.id,n={name:e.name,groupDashboards:e.groupDashboards};null!==t?(n.id=t,b.a.put("/ws/group",n).then(function(e){a.clearEditPanel(),a.fetchGroups(),a.closeEditPanel()})):b.a.post("/ws/group",n).then(function(e){a.clearEditPanel(),a.fetchGroups(),a.closeEditPanel()})},a.addGroupDashboard=function(){var e=a.state,t=e.groupDashboardId,n=e.groupDashboards,o=void 0===n?[]:n;if(t&&-1===o.findIndex(function(e){return e===t})){var r=Object(Z.a)(o);r.push(t),a.setState({groupDashboards:r})}},a.removeGroupDashboard=function(e){var t=a.state.groupDashboards,n=void 0===t?[]:t,o=n.findIndex(function(t){return t===e});if(-1!==o){var r=Object(Z.a)(n);r.splice(o,1),a.setState({groupDashboards:r})}},a.confirmDelete=function(){var e=a.state.objectToDelete,t=void 0===e?{}:e;b.a.delete("/ws/group/"+t.id).then(function(e){a.fetchGroups(),a.closeConfirmDeletionPanel()})},a.openConfirmDeletionPanel=function(e){a.setState({objectToDelete:e,showConfirmDeletionPanel:!0})},a.closeConfirmDeletionPanel=function(){a.setState({objectToDelete:{},showConfirmDeletionPanel:!1})},a.state={groups:[],dashboards:[],showConfirmDeletionPanel:!1,objectToDelete:{},showEditPanel:!1,searchValue:"",id:null,name:"",groupDashboardId:"",groupDashboards:[]},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchGroups(),this.fetchDashboards()}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.id,n=t.groups,r=void 0===n?[]:n,s=t.dashboards,i=void 0===s?[]:s,l=t.groupDashboards,c=void 0===l?[]:l,u=t.searchValue,d=t.showConfirmDeletionPanel,h=t.objectToDelete,m=void 0===h?{}:h,p=null===a?"New":"Edit",f=[],v=function(t){var a=r[t],n=a.name;(!u||u&&n.includes(u))&&f.push(o.a.createElement("div",{key:t,className:"datasource-card row"},o.a.createElement("div",{className:"float-left ellipsis datasource-row-name"},n),o.a.createElement("div",{className:"float-right"},o.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.openEditPanel(a)}},o.a.createElement(C.a,{icon:"edit",size:"lg"})),o.a.createElement("button",{className:"icon-button datasource-icon-button",onClick:function(){return e.openConfirmDeletionPanel(a)}},o.a.createElement(C.a,{icon:"trash-alt",size:"lg"})))))},g=0;g<r.length;g++)v(g);var b=[],E=function(t){for(var a=c[t],n=0;n<i.length;n++)if(a===i[n].id){b.push(o.a.createElement("div",{key:a,className:"row table-row"},o.a.createElement("div",{className:"float-left ellipsis"},i[n].name),o.a.createElement("button",{className:"button table-row-button float-right",onClick:function(){return e.removeGroupDashboard(a)}},o.a.createElement(C.a,{icon:"trash-alt"}))));break}};for(g=0;g<c.length;g++)E(g);return o.a.createElement("div",null,o.a.createElement("div",{class:"row"},o.a.createElement("div",{className:"float-left",style:{marginRight:"5px"}},o.a.createElement(R,{name:"searchValue",value:this.state.searchValue,onChange:this.handleNameInputChange,inputWidth:200})),o.a.createElement("button",{className:"button float-left",onClick:function(){return e.openEditPanel(null)}},o.a.createElement(C.a,{icon:"plus"})," New")),o.a.createElement("div",{className:"row mt-10"},f),o.a.createElement(T,{show:this.state.showEditPanel,onClose:this.closeEditPanel,modalClass:"mid-modal-panel",title:p},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"form-panel float-left",style:{width:"240px"}},o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange})),o.a.createElement("div",{className:"form-panel float-right",style:{width:"240px"}},o.a.createElement("label",null,"Dashboards"),o.a.createElement(ke,{name:"groupDashboardId",value:this.state.groupDashboardId,onChange:this.handleIntegerOptionChange,options:i,optionDisplay:"name",optionValue:"id"}),o.a.createElement("button",{className:"button",onClick:this.addGroupDashboard},"Add"),o.a.createElement("div",{className:"mt-3"},b))),o.a.createElement("button",{className:"button mt-3",onClick:this.save},"Save")),o.a.createElement(T,{show:d,onClose:this.closeConfirmDeletionPanel,modalClass:"small-modal-panel",title:"Confirm Deletion"},o.a.createElement("div",{className:"confirm-deletion-panel"},"Are you sure you want to delete ",m.name,"?"),o.a.createElement("button",{className:"button",onClick:this.confirmDelete},"Delete")))}},{key:"initialEditPanelState",get:function(){return{id:null,name:"",groupDashboardId:"",groupDashboards:[]}}}]),t}(o.a.Component),Ie=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"full-page-content"},o.a.createElement(ye,{activeTab:"Group"},o.a.createElement("div",{title:"Group"},o.a.createElement(xe,null)),o.a.createElement("div",{title:"User"},o.a.createElement(Pe,this.props))))}}]),t}(o.a.Component),Te=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.fetchUser=function(){b.a.get("/ws/user/account").then(function(e){var t=e.data;a.setState({id:t.id,username:t.username,name:t.name,sysRole:t.sysRole,apiKey:t.apiKey})})},a.generateApiKey=function(){b.a.get("/auth/generate-apikey").then(function(e){var t=e.data;a.setState({apiKey:t})})},a.save=function(){var e=a.state,t=e.showUpdatePassword,n=e.name,o=e.password,r=e.confirmedPassword,s={name:n};if(t){if(o!==r)return void V.showError("Those passwords didn't match.");if(o.length<8)return void V.showError("Use 8 or more characters for password.");s.password=o}b.a.put("/ws/user/account",s).then(function(e){V.showSuccess("Saved.")})},a.toggleUpdatePassword=function(){a.setState(function(e){return{showUpdatePassword:!e.showUpdatePassword}})},a.state={showUpdatePassword:!1,id:null,username:"",name:"",sysRole:"",apiKey:"",password:"",confirmedPassword:""},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchUser()}},{key:"render",value:function(){var e=this.state,t=e.showUpdatePassword,a=e.username,n=e.sysRole,r=e.apiKey;return o.a.createElement("div",{className:"full-page-content"},o.a.createElement("div",{className:"form-panel",style:{width:"500px"}},o.a.createElement("label",null,"Username"),o.a.createElement("div",null,a),o.a.createElement("label",null,"Name"),o.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChange}),o.a.createElement("label",null,"System Role"),o.a.createElement("div",null,n),o.a.createElement("label",null,"API Key"),o.a.createElement("div",null,r),o.a.createElement("button",{className:"button mt-10",onClick:this.generateApiKey},"Generate new API Key"),o.a.createElement("br",null),o.a.createElement("button",{className:"button mt-3",onClick:this.toggleUpdatePassword},"Update password"),t&&o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInputChange}),o.a.createElement("label",null,"Confirm Password"),o.a.createElement("input",{type:"password",name:"confirmedPassword",value:this.state.confirmedPassword,onChange:this.handleInputChange})),o.a.createElement("br",null),o.a.createElement("button",{className:"button mt-10",onClick:this.save},"Save")))}}]),t}(o.a.Component),Me=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){console.log("DashboardFullScreenView","componentDidMount"),this.dashboardEditView.loadViewByDashboardName()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"full-screen-view"},o.a.createElement(je,{wrappedComponentRef:function(t){return e.dashboardEditView=t}}))}}]),t}(o.a.Component),We=(a(832),[{link:"/workspace/dashboard",value:"Dashboard",icon:"chalkboard"},{link:"/workspace/datasource",value:"Data Source",icon:"database"},{link:"/workspace/usermanagement",value:"User Management",icon:"users-cog"}]),Ue=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleMenuClick=function(e){a.setState({currentMenuLink:e})},a.logout=function(){b.a.get("/auth/logout").then(function(e){a.props.onLogout()})},a.state={currentMenuLink:"/workspace/dashboard"},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t=this.props.location.pathname;t.startsWith("/workspace/account")?e="/workspace/account":e=We.find(function(e){return t.startsWith(e.link)}).link;this.setState({currentMenuLink:e})}},{key:"render",value:function(){var e=this,t=this.state.currentMenuLink;console.log("Workspace - render");var a=this.props,n=a.username,r=a.sysRole,s=[],i=[];i=r===J?We.filter(function(e){return"/workspace/dashboard"===e.link}):We;for(var l=function(a){var n=i[a],r=t===n.link?"menu-item-active":"";s.push(o.a.createElement("li",{key:n.link,className:r},o.a.createElement(N.a,{to:n.link,onClick:function(){return e.handleMenuClick(n.link)}},o.a.createElement(C.a,{icon:n.icon,fixedWidth:!0}),o.a.createElement("span",{className:"workspace-nav-menu-text"},n.value))))},c=0;c<i.length;c++)l(c);var u="/workspace/account"===t?"menu-item-active":"";return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"workspace-nav"},o.a.createElement("div",{className:"workspace-name"},"Poli"),o.a.createElement("ul",{className:"workspace-nav-menu"},s),o.a.createElement("div",{className:"workspace-account-menu"},o.a.createElement("div",{className:"workspace-account-button inline-block ".concat(u)},o.a.createElement(N.a,{to:"/workspace/account",onClick:function(){return e.handleMenuClick("/workspace/account")}},o.a.createElement(C.a,{icon:"user",fixedWidth:!0}),o.a.createElement("span",{className:"workspace-nav-menu-text"},n))),o.a.createElement("div",{className:"workspace-logout-button inline-block",onClick:this.logout},o.a.createElement(C.a,{icon:"sign-out-alt",fixedWidth:!0})))),o.a.createElement("div",{className:"workspace-content"},o.a.createElement(m.a,null,o.a.createElement(p.a,{exact:!0,path:"/workspace/datasource",component:G}),o.a.createElement(p.a,{exact:!0,path:"/workspace/account",component:Te}),o.a.createElement(p.a,{exact:!0,path:"/workspace/dashboard/view",component:Me}),o.a.createElement(p.a,{exact:!0,path:"/workspace/usermanagement",render:function(){return o.a.createElement(Ie,e.props)}}),o.a.createElement(p.a,{path:"/workspace/dashboard",render:function(){return o.a.createElement(Se,e.props)}}))),o.a.createElement(V,null))}}]),t}(o.a.Component),Ve=Object(v.a)(Ue),Re=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("h1",null,"PageNotFound"),o.a.createElement(N.a,{to:"/login"},"Login"))}}]),t}(o.a.Component);E.b.add(w.b,w.e,w.x,w.n,w.t,w.f,w.u,w.l,w.s,w.o,w.v,w.m,w.w,w.r,w.d,w.g,w.j,w.i,w.c,w.q,w.p,w.a,w.k,w.h);var Ge=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).onLoginSuccess=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.tempPassword?a.props.history.push("/changepassword"):a.setState({username:e.username,sysRole:e.sysRole,isAuthorizing:!1},function(){var e="/workspace/dashboard";t&&(e=t),a.props.history.push(e)})},a.onLogout=function(){a.setState({username:"",sysRole:"",isAuthorizing:!1},function(){a.props.history.push("/login")})},a.state={username:"",sysRole:"",isAuthorizing:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.pathname,a=this.props.location.search,n=(new URLSearchParams(a).get("apiKey"),t+a),o=!1;this.state.sysRole&&(o=!0),o||this.setState({isAuthorizing:!0},function(){b.a.post("/auth/login/cookie").then(function(t){var a=t.data;a.error?e.setState({sysRole:"",isAuthorizing:!1},function(){e.props.history.push("/login")}):e.onLoginSuccess(a,n)})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.sysRole,r=t.isAuthorizing,s=!1;return n&&(s=!0),r?o.a.createElement("div",{className:"authenticating-panel"},o.a.createElement("div",{className:"authenticating-panel-title"},"Authenticating..."),o.a.createElement(C.a,{icon:"circle-notch",spin:!0,size:"2x"})):o.a.createElement("div",{className:"app"},o.a.createElement(m.a,null,o.a.createElement(p.a,{exact:!0,path:"/",render:function(){return o.a.createElement(O,{sysRole:n,onLoginSuccess:e.onLoginSuccess})}}),o.a.createElement(p.a,{path:"/login",render:function(){return o.a.createElement(O,{sysRole:n,onLoginSuccess:e.onLoginSuccess})}}),o.a.createElement(p.a,{path:"/changepassword",component:j}),o.a.createElement(Le,{authenticated:s,path:"/workspace",component:Ve,username:a,sysRole:n,onLogout:this.onLogout}),o.a.createElement(p.a,{component:Re})))}}]),t}(o.a.Component);function Le(e){var t=e.component,a=e.authenticated,n=Object(i.a)(e,["component","authenticated"]);return o.a.createElement(p.a,Object.assign({},n,{render:function(e){return!0===a?o.a.createElement(t,Object.assign({},e,n)):o.a.createElement(f.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var qe=Object(v.a)(Ge),ze=a(837);s.a.render(o.a.createElement(ze.a,{basename:"/poli"},o.a.createElement(qe,null)),document.getElementById("root"))}},[[313,1,2]]]);
//# sourceMappingURL=main.fbaa22fd.chunk.js.map